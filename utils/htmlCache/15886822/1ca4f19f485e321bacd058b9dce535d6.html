<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8"/>
    <title>API Pollution in Swift Modules - NSHipster</title>
    <meta name="description" content="When you import a module into Swift code, you expect the result to be entirely additive. But as we'll see, this isn't always the case."/>
    <link rel="canonical" href="https://nshipster.com/swift-api-pollution/"/>
    <meta name="revisit-after" content="7 days"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
    <meta name="format-detection" content="telephone=no"/>
    <link rel="alternate" type="application/atom+xml" title="NSHipster Atom Feed" href="/feed.xml"/>
    <link rel="preload" as="font" href="/assets/nshipster-e474c0004ccdeca4e27e7ae1320e0e04a943b0ea5348b336356b7ac223497fda.woff2" type="font/woff2" crossorigin="anonymous" />
    <style rel="stylesheet" type="text/css" integrity="sha256-GB6zv4eY5LHAXnwka4XIuiynYq1dPsuvZJezWwfWZdQ=" crossorigin="anonymous">
      Ôªøhtml{border-top:3px #ff8000 solid}html body{background-color:#fefefe;color:#282a36}#logo #ns{fill:#ff8000}a,a:visited{color:#ff8000}a:hover,a:visited:hover{text-decoration:none}@keyframes twirl{0%{transform:scale(1) rotate(0)}10%,20%{transform:scale(0.9) rotate(-3deg)}30%,50%,70%,90%{transform:scale(1.1) rotate(3deg)}40%,60%,80%{transform:scale(1.1) rotate(-3deg)}100%{transform:scale(1) rotate(0)}}@font-face{font-family:"Merriweather";src:local("Merriweather Regular"),local("Merriweather-Regular"),url(/assets/Merriweather-Regular-e50fe78e902ad7649d2a9ec69a67c9a941657604540b0b077b720a0562072915.woff2) format("woff2"),url(/assets/Merriweather-Regular-4549033d084e479d2c53500851ca2e5fd43fd83ac4ae26445e0974ae73cd3d05.woff) format("woff");font-weight:normal;font-style:normal;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Light"),local("Merriweather-Light"),url(/assets/Merriweather-Light-c2ef5188a3d41db369bfec98586cacc22c1aefa23a02333101c05b6c7e35ed59.woff2) format("woff2"),url(/assets/Merriweather-Light-5d5f2b4aac0254b3ef80c3e04bcbbd021ab468e6205dade23a9943277ed2f15b.woff) format("woff");font-weight:300;font-style:normal;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Black"),local("Merriweather-Black"),url(/assets/Merriweather-Black-fd0c4da3e1b331a0f3c05ca30ef2f73d3248c19377f0e347bbd27f5ca3ace049.woff2) format("woff2"),url(/assets/Merriweather-Black-0abb3a596dcef7e60a0ce4000352ae834fa7e6f49f48f1f568dd1b16db037faa.woff) format("woff");font-weight:900;font-style:normal;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Bold"),local("Merriweather-Bold"),url(/assets/Merriweather-Bold-66b60fab0c23051945cad3a206665130e9a8742ad25afc03675df8e30f9bd1f1.woff2) format("woff2"),url(/assets/Merriweather-Bold-91e91f3c9d8e79d7f50076508c711118d17335ad0d8adaaed9e82e7e0c88f2a3.woff) format("woff");font-weight:bold;font-style:normal;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Black Italic"),local("Merriweather-BlackItalic"),url(/assets/Merriweather-BlackItalic-78fadd58be94cb66b7b96e9368a431cb7ba39853c24dfbac96af11b2566cc80a.woff2) format("woff2"),url(/assets/Merriweather-BlackItalic-25d34bcb442b873300a27a1fda06b53db76b343b21b1d2967ebf8d50fc98820c.woff) format("woff");font-weight:900;font-style:italic;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Italic"),local("Merriweather-Italic"),url(/assets/Merriweather-Italic-c8cb2c6ad2cb79fd515ac3eef6b70c481f0641f344e3e7154324eab0d9b442e7.woff2) format("woff2"),url(/assets/Merriweather-Italic-2ff5301c0bc5e6bb36aa90461a2778925615296b30cb68de03adfbe30f3ba034.woff) format("woff");font-weight:normal;font-style:italic;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Bold Italic"),local("Merriweather-BoldItalic"),url(/assets/Merriweather-BoldItalic-6555d0e597bb610c9885788f6ea9fcc1bdc2cdb1a27d6fa789b26286f0236d96.woff2) format("woff2"),url(/assets/Merriweather-BoldItalic-c5af58f9b3ca849796e320463efb479012c8da669fade00fb76169e37ec6b408.woff) format("woff");font-weight:bold;font-style:italic;font-display:optional}@font-face{font-family:"Merriweather";src:local("Merriweather Light Italic"),local("Merriweather-LightItalic"),url(/assets/Merriweather-LightItalic-83b26b2f59b0bbd312f3f4b8551f5295a64cbc9645711d6b006faaa79c7753d3.woff2) format("woff2"),url(/assets/Merriweather-LightItalic-1f79f78c181a7a35d38ed8a5bee789c2680726e3b74ddaebc3486af3af749235.woff) format("woff");font-weight:300;font-style:italic;font-display:optional}@font-face{font-family:'Batang';src:url(/assets/Batang-bbbbbe277f4e2bd33819a38b51e599824aed97db7b51b0aa6bf683bf40b171ce.woff2) format("woff2"),url(/assets/Batang-d1c9b135751404713e2fdc6fcd9f6d9d534d2a8bfc11e57fe05a7aa13e883838.woff) format("woff");font-weight:normal;font-style:normal;font-display:auto;unicode-range:U+AC00-D7A3, U+1100-11FF, U+3130-318F, U+A960-A97F, U+D7B0-D7FF}html,body{font-family:"Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size:15pt;line-height:1.5;font-weight:300;font-kerning:normal;-webkit-font-kerning:normal;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}html[lang="ko-KR"] body{font-family:"Batang", "Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-weight:lighter}html[lang="ko-KR"] a.readmore,html[lang="ko-KR"] section>h1,html[lang="ko-KR"] article p em,html[lang="ko-KR"] article p dfn,html[lang="ko-KR"] cite,html[lang="zh-Hans"] a.readmore,html[lang="zh-Hans"] section>h1,html[lang="zh-Hans"] article p em,html[lang="zh-Hans"] article p dfn,html[lang="zh-Hans"] cite{font-style:normal;font-weight:bold}html[lang="ko-KR"] [role="article"] header .byline,html[lang="zh-Hans"] [role="article"] header .byline{font-style:normal}html[lang="ko-KR"] .archive ol li time,html[lang="ko-KR"] .archive ul li time,html[lang="zh-Hans"] .archive ol li time,html[lang="zh-Hans"] .archive ul li time{font-style:normal;font-weight:bold}html[lang="ko-KR"] #promotion h4,html[lang="zh-Hans"] #promotion h4{font-style:normal;font-weight:bold}html[lang="ko-KR"] .highlight span,html[lang="zh-Hans"] .highlight span{font-style:normal !important}h1,h2,h3,h4,h5,h6{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";line-height:1.1em;margin:0 0 1rem 0}h1{font-size:2.5em}h2{font-size:2em}h3{font-size:1.5em}h4{font-size:1.25em}h5{font-size:1.125em}h6{font-size:1em}p{margin:0 0 1rem 0}a{-webkit-transition:color 0.1s linear;-moz-transition:color 0.1s linear;transition:color 0.1s linear;text-decoration:none}a:hover{text-decoration:underline}a:active,a:focus{outline:none}a code{white-space:nowrap}p>small{font-size:inherit;font-variant:small-caps;text-transform:lowercase}:not(pre)>code{user-select:all}a code,p code,li code,dd code,td code{background:#f8f8f2;padding:.25em;font-size:smaller;border-radius:3px}p code,li code,dd code,td code{color:#49178f}ol li,ul li{margin-bottom:0.5em}pre{font-family:"Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"}code,samp{font-family:"SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace}pre code,samp{font-size:smaller;line-height:1.1em}samp{white-space:pre;overflow:scroll;-webkit-overflow-scrolling:touch;display:block;padding:0.5em 0}section>h1{font-family:"Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-weight:300;font-size:1.5em;text-align:center;margin-bottom:2rem;margin-top:2rem}article.excerpt h1{font-size:1.5em}a.readmore{font-style:italic}a:hover{text-decoration:underline}kbd{color:#282a36;background-color:#f8f8f2;border-radius:3px;border:1px solid #747683;box-shadow:0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-variant:small-caps;margin:0 .1em;padding:.1em .6em;text-transform:lowercase}.placeholder{background:#f8f8f2;display:inline-block;padding:0 0.25em;border:1px #282a36 solid;border-radius:5px;font-style:normal}.highlight .placeholder{background:transparent;border-color:#f8f8f2}h1:hover .anchor::before,h2:hover .anchor::before,h3:hover .anchor::before,h4:hover .anchor::before,h5:hover .anchor::before,h6:hover .anchor::before{opacity:1}.title{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-weight:700}.anchor::before{content:"#";opacity:0;transition:300ms opacity;position:absolute;float:left;margin-left:-1.5em;padding:0 0.5em;color:#747683 !important;text-decoration:none}.anchor::before :focus{outline:none}.tagline{font-size:1.5em}#latest small,#announcement small{font-style:italic}[role="article"] header h1{font-size:3.5em;line-height:1;margin-bottom:0.5rem;padding:0.5rem 0}#archive dd{font-size:smaller;display:list-item;list-style:circle}.admonition{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";border-left-width:4px;border-left-style:solid;padding:5px 40px;margin:1.5em 0;display:block;clear:both;overflow:visible}.admonition p{margin:0.5em 0;font-size:smaller}.admonition pre code{font-size:small}.admonition.info{background:#edf5fa;border-color:#4DAAFC}.admonition.info a{color:#0088ff}.admonition.info:before{content:" ";background-image:url(/assets/info-f73d3a68c0c3bfa07e64909be26a8d512c2d50bf2729bf30f76d8b63250d0671.svg);background-size:24px 24px;width:24px;height:24px;position:absolute;display:block;margin-left:-54px;margin-top:10px;z-index:100}.admonition.warning{background:#fcfaf6;border-color:#F9D780}.admonition.warning a{color:#f0b112}.admonition.warning:before{content:" ";background-image:url(/assets/warning-47e47a5723ab3badf6c9352852c0acbe46a94b493175685797a01b7a2c832fc4.svg);background-size:24px 24px;width:24px;height:24px;position:absolute;display:block;margin-left:-54px;margin-top:10px;z-index:100}.admonition.error{background:#fcf2f6;border-color:#f5569d}.admonition.error a{color:#e62279}.admonition.error:before{content:" ";background-image:url(/assets/error-0950677a2585decd810c2737096155b036dee719e35feb1c0c6ade04202daafc.svg);background-size:24px 24px;width:24px;height:24px;position:absolute;display:block;margin-left:-54px;margin-top:10px;z-index:100}@font-face{font-family:"NSHipster Icons";font-style:normal;font-weight:700;font-display:block;src:url(/assets/nshipster-e474c0004ccdeca4e27e7ae1320e0e04a943b0ea5348b336356b7ac223497fda.woff2) format("woff2"),url(/assets/nshipster-743868430209628f9d7933ea65c7e31cdf597e9a27d01d372c33fc501f4c6722.woff) format("woff")}[class^="icon-"],[class*=" icon-"]{font-family:"NSHipster Icons" !important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-warning:before{content:"\e900"}.icon-error:before{content:"\e901"}.icon-info:before{content:"\e902"}.icon-podcasts:before{content:"\e903"}.icon-wechat:before{content:"\e904"}.icon-sinaweibo:before{content:"\e905"}.icon-feed:before{content:"\e906"}.icon-youtube:before{content:"\e908"}.icon-apple:before{content:"\f8ff"}.icon-facebook:before{content:"\e90a"}.icon-github:before{content:"\e90b"}.icon-twitter:before{content:"\e90c"}.icon-googleplus:before{content:"\e90d"}.icon-swift:before{content:"\e90e"}.icon-nc:before{content:"\e90f"}.icon-cc:before{content:"\e907"}.icon-by:before{content:"\e911"}.icon-command:before{content:"\2318"}.icon-shift:before{content:"\21e7"}.icon-ctrl:before{content:"\2303"}.icon-opt:before{content:"\2325"}html,body{margin:0}body{padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);border-top:3px #ff8000 solid}hr{border:none;margin:1em 0;padding:1em 0;display:block}img{margin:0;max-width:100%}video{margin:0 auto;max-width:100%;display:block}blockquote{border-left:2px solid #ddd;color:#595959;margin:1.5em 0;padding-left:0.75em}cite{color:#737373;font-style:italic}cite:before{content:"‚Äî¬†"}table{border-collapse:collapse;margin:0.75em 0;table-layout:fixed;width:100%}th{border-bottom:1px solid #b7b7b7;font-weight:bold;padding:0.75em 0;text-align:left}td{border-bottom:1px solid #ddd;padding:0.75em 0}tr,td,th{vertical-align:middle}ul,ol{margin:0;padding:0;list-style-type:none}dl{margin-bottom:0.75em}dl dt{font-weight:bold;margin:1em 0}dl dd{margin:0 0 0.25rem 1em}.container{max-width:100%;margin-left:auto;margin-right:auto;max-width:960px;margin:0 auto;padding:2em}.container:after{content:"";display:table;clear:both}.container section{display:block;max-width:100%;margin-left:auto;margin-right:auto;margin-bottom:2em;padding-bottom:1em}.container section:after{content:"";display:table;clear:both;content:"";display:table;clear:both}html[lang="fr-FR"] [role="banner"] #logo{margin-right:5.5em}html[lang="fr-FR"] [role="banner"] .tagline{font-size:1.33em}html[lang="zh-Hans"] [role="banner"] #logo{margin-right:9.5em}html[lang="zh-Hans"] [role="banner"] .tagline{font-size:1.75em;padding-bottom:1em}html[lang="ko-KR"] [role="banner"] .tagline{font-size:1.4em}[role="banner"]{display:flex;margin-bottom:1.5em;padding-bottom:1.5em}[role="banner"] #logo{display:block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-size:1em;height:6em;margin:0.25em 6em 0 0}[role="banner"] #logo a{display:block}[role="banner"] #logo svg{width:146px;height:84px;overflow:visible;margin-left:-3px}[role="banner"] #logo svg #mustache{position:absolute;transform:rotate(0) scale(1);transform-origin:50% 70% 0;transition:transform 1s}[role="banner"] #logo svg:hover,[role="banner"] #logo svg.animated{position:relative;z-index:2}[role="banner"] #logo svg:hover #mustache,[role="banner"] #logo svg.animated #mustache{animation:twirl 1s ease-in-out}[role="banner"] .tagline{flex:1}#latest h1,#announcement h1{margin-bottom:0.5rem}#announcement{background-color:rgba(255,128,0,0.2);margin-left:-1em;margin-right:-1em;padding:1em}#recent ul{display:grid;grid-template-columns:repeat(3, 1fr);gap:1em 2em}#recent ul li{min-height:15em}#recent ul li .title{height:4em;font-size:1.75em;display:table-cell;line-height:1;vertical-align:bottom;padding-bottom:1em}#recent ul li p{font-size:smaller;display:-webkit-box;overflow:hidden;max-lines:5;-webkit-line-clamp:5;-webkit-box-orient:vertical;text-overflow:ellipsis}#merchandise{margin-top:-30px}#merchandise h1{margin-bottom:15px}#follow ul{float:left;display:block;margin-right:2.35765%;width:31.76157%}#follow ul:last-child{margin-right:0}#follow ul li{float:left;display:block;margin-right:7.42297%;width:19.43277%;font-size:2em}#follow ul li:last-child,#follow ul li:nth-of-type(4n){margin-right:0}#follow ul li a:hover{text-decoration:none}#follow form{float:left;display:block;margin-right:2.35765%;width:57.35098%;margin-left:8.5298%;margin-right:0}#follow form:last-child{margin-right:0}#follow form input[type="email"]{float:left;display:block;margin-right:3.57866%;width:61.158%}#follow form input[type="email"]:last-child{margin-right:0}#follow form input[type="submit"]{float:left;display:block;margin-right:3.57866%;width:35.26334%;border-radius:10px;background:#ff8000;font-size:0.75em;padding:15px 0}#follow form input[type="submit"]:last-child{margin-right:0}article.author,article.translator{padding-top:2em}article.author header,article.translator header{display:grid;grid-template:"avatar . title" "avatar . description";grid-template-columns:1fr 1em 3fr;grid-template-rows:1fr 2fr;gap:1em 1em;margin-bottom:1em;padding-bottom:1em}article.author header .avatar,article.translator header .avatar{grid-area:avatar}article.author header h1,article.translator header h1{grid-area:title}article.author header p,article.translator header p{grid-area:description}[role="article"]{margin-bottom:1em;overflow-x:hidden}[role="article"] table{overflow:scroll;-webkit-overflow-scrolling:touch;margin:2em 0}[role="article"] table caption{margin:2em 0 1em 0}[role="article"] header{display:block;text-align:center;margin-bottom:3em}[role="article"] header .byline{font-family:"Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-style:italic;font-weight:300;color:#a3a39e}[role="article"] header .byline a,[role="article"] header .byline span,[role="article"] header .byline time{white-space:nowrap}[role="article"] header .byline .authors:after,[role="article"] header .byline .translators:after{content:" ‚Äî "}[role="article"] .content{margin-bottom:4em}[role="article"] .content h1,[role="article"] .content h2,[role="article"] .content h3,[role="article"] .content h4,[role="article"] .content h5{margin-top:2.5rem}[role="article"] .content object,[role="article"] .content embed,[role="article"] .content figure,[role="article"] .content svg{margin:1em auto;display:block;width:auto}[role="article"] .content img{margin:1em auto;display:block}[role="article"] .content ul,[role="article"] .content ol{margin:1.5em 0;padding:0 3em}[role="article"] .content ul ul,[role="article"] .content ul ol,[role="article"] .content ol ul,[role="article"] .content ol ol{margin-top:0.5em}[role="article"] .content ul li,[role="article"] .content ol li{list-style:disc}[role="article"] .content figure{text-align:center}[role="article"] .content ins{background-color:rgba(255,128,0,0.2);text-decoration:none}[role="article"] .content dl{padding:1em 0}[role="article"] .content blockquote{margin:2em;margin-right:4em;border-left:3px #ff8000 solid}[role="article"] .content blockquote cite{margin-top:1em;display:block}[role="article"] .content table thead th{text-align:center}[role="article"] .content table td{padding:1em}[role="article"] sup{font-size:50%;margin-right:-0.5em}[role="article"] footer .contributor{float:left;display:block;margin-right:2.35765%;width:48.82117%;padding:1em 0}[role="article"] footer .contributor:last-child,[role="article"] footer .contributor:nth-child(2n){margin-right:0}[role="article"] footer .contributor:nth-child(2n+1){clear:left}[role="article"] footer .contributor:only-child{width:100%}[role="article"] footer .contributor:only-child .avatar{padding:0 1em}[role="article"] footer .contributor .avatar{float:left;display:block;margin-right:4.82916%;width:30.11389%}[role="article"] footer .contributor .avatar:last-child{margin-right:0}[role="article"] footer .contributor .details{float:left;display:block;margin-right:4.82916%;width:65.05695%;margin-right:0;margin-top:1em}[role="article"] footer .contributor .details:last-child{margin-right:0}[role="article"] footer .contributor .details span{font-weight:700}[role="article"] footer .contributor .details p{font-size:0.75em;margin-top:1em}[role="article"] footer small{display:block;font-size:1em;font-weight:700;color:#777;text-transform:lowercase;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-variant:small-caps;margin-bottom:1em}[role="complementary"]{border-top:1px #ddd solid;padding-top:2em}[role="contentinfo"]{text-align:center;margin-top:2em;padding:1em}[role="contentinfo"] section{margin-bottom:0;padding-bottom:0}.avatar{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;max-width:200px;max-height:200px;border-radius:50%;pointer-events:none;user-select:none}#contributors ul{display:flex;justify-content:center;align-content:space-between;flex-flow:row wrap}#contributors ul li{flex:0;display:block;margin-bottom:1em;flex-basis:20%}#contributors ul li .avatar{display:block;margin:0 auto 1em auto;width:70%}#contributors ul li a{text-align:center;display:block}.archive dl{float:left;display:block;margin-right:2.5%;width:30%}.archive dl:last-child,.archive dl:nth-of-type(3),.archive dl:nth-of-type(4),.archive dl:nth-of-type(6){margin-right:0}.archive ol,.archive ul{list-style:none}.archive ol li,.archive ul li{margin:2em 0}.archive ol span,.archive ol time,.archive ul span,.archive ul time{display:block}.archive ol time,.archive ul time{white-space:nowrap;font-style:italic;font-weight:300;margin-bottom:1em}#sharing ul{display:block;float:right}#sharing ul:after{content:"";display:table;clear:both}#sharing li{font-size:1.5em;display:block;margin:0.5em;float:left}#sharing li a:hover{text-decoration:none;color:#4c3150 !important}#publications .books{display:flex}#publications .book{flex:1}#publications .book img{display:block;margin:0 auto;width:200px;border:4px transparent solid;transition:0.25s ease-in-out border-color;filter:none !important}#publications .book img:hover{padding:0;border:4px #ff8000 solid}.tagline{clear:both;font-weight:300}.highlight-group{margin-top:1em}[role="tablist"]{display:flex;flex-direction:row;justify-content:flex-end;padding-right:3px}[role="tablist"] button{cursor:pointer;flex:0;padding-left:0.5em;color:#282a36 !important;text-decoration:none;transition:opacity 0.5s;background:transparent !important;padding:0;margin:0 0 0 0.5em}[role="tablist"] button:not([aria-selected="true"]){opacity:0.25}[role="tablist"] button:not([aria-selected="true"]):hover{opacity:0.5}[role="tablist"] button.active{opacity:1}[role="tablist"] button:focus{outline:thin dotted;outline-offset:2px}[role="tabpanel"]{margin-top:0.25em}[role="tabpanel"]:focus{outline:0}#promotion .book img{margin:0}#promotion h3{font-family:"Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"}#promotion h4{font-family:"Merriweather", Georgia, serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-style:italic;font-weight:300;margin-bottom:1em}#promotion p{font-size:0.75em}#promotion a.buy{background:#ff8000;border-radius:10px;color:#fff !important;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-weight:700;margin-top:1em;padding:15px;text-align:center;display:inline-block}#promotion a.buy:hover{text-decoration:none !important}#promotion.home{margin-top:-15px;padding:35px 44px;background:#eee;border-radius:20px}#promotion.home p{font-size:1em}#promotion.home small{display:block;font-size:1.2em;font-weight:700;margin-left:5px;color:#777;text-transform:lowercase;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-variant:small-caps}table#status{table-layout:fixed;margin-top:2em}table#status caption{padding:1em 0;color:#777}table#status .version{text-align:center}table#status .version em{color:#777}table#customplaygrounddisplayconvertible-categories{table-layout:auto}table#customplaygrounddisplayconvertible-categories tbody th{padding-left:10px;text-align:center}table#customplaygrounddisplayconvertible-categories ul{padding:0 0 0 20px}table#customplaygrounddisplayconvertible-categories ul li{margin:0}table#customplaygrounddisplayconvertible-categories td img{margin:0}@media screen and (max-width: 600px){table#customplaygrounddisplayconvertible-categories thead tr th:last-child,table#customplaygrounddisplayconvertible-categories tbody tr td:last-child{display:none}}.conversation{margin:1em auto;max-width:650px}.conversation:after{content:" ";display:block;clear:both}.conversation ruby{ruby-align:start;ruby-position:over;display:block;clear:both;max-width:550px}.conversation ruby.boke{float:left;text-align:left;margin-bottom:0.5em}.conversation ruby.tsukkomi{float:right;color:#ff8000;text-align:right;margin-bottom:1.5em}.highlight{background:#282a36;border:1px transparent solid;border-radius:5px;overflow:auto;padding:0.5em 1em;margin-bottom:1em}.highlight code{color:#f8f8f2;background:transparent !important}.highlight ::selection{color:inherit}.highlight ::-moz-selection{color:inherit}.highlight .hll,.highlight .s,.highlight .sa,.highlight .sb,.highlight .sc,.highlight .dl,.highlight .sd,.highlight .s2,.highlight .se,.highlight .sh,.highlight .si,.highlight .sx,.highlight .sr,.highlight .s1,.highlight .ss{color:#f1fa8c}.highlight .go{color:#747683}.highlight .err,.highlight .g,.highlight .l,.highlight .n,.highlight .x,.highlight .p,.highlight .ge,.highlight .gr,.highlight .gh,.highlight .gi,.highlight .gp,.highlight .gs,.highlight .gu,.highlight .gt,.highlight .ld,.highlight .no,.highlight .nd,.highlight .ni,.highlight .ne,.highlight .nn,.highlight .nx,.highlight .py,.highlight .w,.highlight .bp{color:#f8f8f2}.highlight .gh,.highlight .gi,.highlight .gu{font-weight:bold}.highlight .ge{text-decoration:underline}.highlight .c,.highlight .ch,.highlight .cm,.highlight .cpf,.highlight .c1,.highlight .cs{color:#bfc6d8}.highlight .kd,.highlight .kt,.highlight .nb,.highlight .nl,.highlight .nv,.highlight .vc,.highlight .vg,.highlight .vi,.highlight .vm{color:#8be9fd}.highlight .na,.highlight .nc,.highlight .nf,.highlight .fm{color:#ff8000}.highlight .k,.highlight .o,.highlight .cp,.highlight .kc,.highlight .kn,.highlight .kp,.highlight .kr,.highlight .nt,.highlight .ow{color:#ff79c6}.highlight .m,.highlight .mb,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo,.highlight .il{color:#bd93f9}.highlight .gd{color:#ff5555}.highlight[data-lang="JWT"]{white-space:pre-wrap}button,input[type="submit"]{-moz-appearance:none;-ms-appearance:none;-o-appearance:none;-webkit-appearance:none;-webkit-font-smoothing:antialiased;appearance:none;background-color:#ff8000;border-radius:5px;border:none;color:white;cursor:pointer;display:inline-block;font-size:1em;font-weight:bold;line-height:1;padding:0.75em 1em;text-decoration:none;transition:background-color 0.25s;user-select:none;vertical-align:middle;white-space:nowrap}button:hover,input[type="submit"]:hover{background-color:#cc6600;color:white}@media screen and (max-width: 768px){[role="article"] header .byline .authors:after,[role="article"] header .byline .translators:after{content:" ";display:block}.container{padding:1em}#recent ul{display:block}#recent ul li{min-height:auto;margin-bottom:2em}#recent ul li .title{display:block;height:auto;padding-bottom:0.5rem}#follow ul{width:100%}#follow form{width:100%;margin-left:0;margin-top:2em}[role="article"]{font-size:smaller}[role="article"] .content{overflow:hidden}[role="article"] .content blockquote{margin:1em 0}[role="article"] footer .contributor{width:100%;margin-bottom:1em}[role="article"] footer .contributor:not(:first-child){border-top:none}[role="article"] footer .contributor .avatar{padding:0}[role="article"] footer .contributor .details{margin-top:0}[role="complementary"] #continue,[role="complementary"] #related{width:100%}[role="complementary"] #related{margin-top:1em}[role="complementary"] #related li{font-size:1em}#sharing ul{width:100%}#sharing li{display:none !important;margin:0;float:left;display:block;margin-right:2.35765%;width:23.23176%}#sharing li:last-child,#sharing li:nth-child(4){margin-right:0}#sharing li:nth-child(5){clear:left}#sharing li a,#sharing li i{display:block;margin:0 auto;font-size:1.25em}#promotion .book img{margin:0 auto}#contributors ul li{flex-basis:33%}#recent article{float:none;display:block;width:100%}#recent article:last-child,#recent article:nth-of-type(2n){margin-right:0}.archive dl{width:100%;margin:0;float:none}.archive dl dt{margin:2em 0 0.5em 0}}@media screen and (max-width: 960px){[role="banner"]{display:block;margin-bottom:0;padding-bottom:0}[role="banner"] #logo{margin:0 !important;height:auto;padding-bottom:0.5em}[role="banner"] #logo svg{width:25vw;display:block;margin:0 auto 1.5em auto}[role="banner"] .tagline{font-size:4.4vw;padding-bottom:2em}#recent ul{grid-template-columns:repeat(2, 1fr)}.anchor{font-size:smaller}#announcement{margin-left:0;margin-right:0}article.author header,article.translator header{display:block}article.author header .avatar,article.translator header .avatar{margin:0 auto 1em auto;display:block}article.author header h1,article.translator header h1{text-align:center}}@media (hover: none){#logo #mustache{animation-iteration-count:1}}@media (inverted-colors){*{text-shadow:none !important;box-shadow:none !important}img{filter:invert(100%)}}@media (monochrome) and (false), print and (false), (prefers-contrast: high), screen and (-ms-high-contrast: active){html{border-top-color:black}html body{background:white}html body #logo a:hover{background:transparent !important}html body #logo #ns{fill:white;stroke:black;stroke-width:10px}html body #logo #mustache{fill:black}html body a{transition:none}html body a,html body a:visited{text-decoration:underline;color:black !important}html body a:hover{text-decoration:none}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6,html body p,html body li,html body dt,html body dd,html body span{color:black !important}html body div.highlight{color:black;background:#fff !important;border:2px black solid}html body div.highlight code,html body div.highlight code span{color:black !important}html body div.highlight .c,html body div.highlight .ch,html body div.highlight .cm,html body div.highlight .cpf,html body div.highlight .c1,html body div.highlight .cs,html body div.highlight .ge,html body div.highlight .s,html body div.highlight .sa,html body div.highlight .sb,html body div.highlight .sc,html body div.highlight .dl,html body div.highlight .sd,html body div.highlight .s2,html body div.highlight .sh,html body div.highlight .sx,html body div.highlight .sr,html body div.highlight .s1,html body div.highlight .ss{font-style:italic}html body div.highlight .k,html body div.highlight .gh,html body div.highlight .gp,html body div.highlight .gs,html body div.highlight .gu,html body div.highlight .kc,html body div.highlight .kd,html body div.highlight .kn,html body div.highlight .kr,html body div.highlight .nc,html body div.highlight .ni,html body div.highlight .ne,html body div.highlight .nn,html body div.highlight .nt,html body div.highlight .ow{font-weight:bold}html body div.highlight .se,html body div.highlight .si{font-weight:bold;font-style:italic}html body .admonition{background:white !important;border:2px black solid !important;border-radius:5px}html body .admonition:before{visibility:hidden}html body blockquote{border-left-color:black !important;color:black}}@media (prefers-color-scheme: dark){body{background:#2c2a28 !important;color:#f8f8f2 !important}body blockquote{color:#f8f8f2 !important}body div.highlight{border:1px #f8f8f2 solid !important}body .language-toggle a{color:#f8f8f2 !important}body .info{background:#333c44 !important}body .warning{background:#484131 !important}body .error{background:#592e41 !important}article img[src$=".svg"],i img[src$=".svg"]{filter:invert(100%)}kbd{color:#f8f8f2;background-color:#282a36;box-shadow:0 1px 0 rgba(255,255,255,0.2),0 0 0 2px #222 inset}.placeholder{color:#f8f8f2;background-color:#282a36;border-color:#f8f8f2}a>code,p>code,li>code,dd>code,td>code{background:#282a36}p code,li code,dd code,td code{color:#bd93f9}}@media (prefers-contrast: high), screen and (-ms-high-contrast: active){a{transition:none}a,a:visited{text-decoration:underline;color:black !important}h1,h2,h3,h4,h5,h6,p,li,dt,dd,span{color:black !important}h1 a:hover,h2 a:hover,h3 a:hover,h4 a:hover,h5 a:hover,h6 a:hover,p a:hover,li a:hover,dt a:hover,dd a:hover,span a:hover{text-decoration:none;background:black;color:white !important}}@media (prefers-reduced-motion: reduce){#logo #mustache{animation:none !important}}@media print{@page{margin:0.5in}@page{@bottom-center{content:"Page " counter(page) " of " counter(pages);font-size:small}@footnote{border-top:1pt black solid;padding-top:1em;font-size:smaller;padding-left:1.5em}}html{border-top:none}html body{font-size:12pt !important}#logo{height:3em !important}#logo svg{transform:scale(0.5);transform-origin:top left}img,p,blockquote,aside,ul,ol,table,figure,.highlight-group{page-break-inside:avoid}.highlight-group{page-break-before:avoid}h1,h2,h3,h4,h5,h6{page-break-before:avoid;page-break-after:avoid}img{max-width:100% !important}p a{word-wrap:break-word}p a[href^="#"]:after{display:none}p a[href^="http://"]:after,p a[href^="https://"]:after{content:attr(href);float:footnote;color:#333;text-decoration:none;text-align:left;page-break-inside:avoid;page-break-before:avoid}article [title]::after{content:" (" attr(title) ") ";float:footnote}.highlight-group a{font-size:50%}div.highlight{border-radius:5px;border:2px black solid}[role="article"] .content{margin-bottom:1em !important}[role="complementary"]{display:none}[role="contentinfo"]{page-break-inside:avoid;font-size:small}.admonition{padding:0 0 0 1em}.admonition::before{visibility:hidden}}@media print and (color){*{-webkit-print-color-adjust:exact;print-color-adjust:exact}}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}::selection{background:rgba(76,49,80,0.5);color:#ffffff}::-moz-selection{background:rgba(76,49,80,0.5);color:#ffffff}#type-encodings tr>td:first-child,#method-encodings tr>td:first-child{width:12em;padding-left:3em}@media screen and (max-width: 480px){#gpuimage table{font-size:50%}}#gpuimage #gpuimage-benchmarks td{text-align:center}#gpuimage #gpuimage-benchmarks td:first-child{text-align:left}#gpuimage #gpuimage-benchmarks td:last-child{text-align:right}#gpuimage #gpuimage-filters td{vertical-align:top;font-size:75%}#gpuimage blockquote{font-size:75%}table.core-data-versus-nskeyedarchiver td{text-align:center}table.core-data-versus-nskeyedarchiver td:first-child{text-align:left;font-weight:bold}table#xcode-key-bindings-modifiers{width:100%}table#xcode-key-bindings-modifiers td,table#xcode-key-bindings-modifiers th{width:20%;text-align:center}#cfstringtransform table{display:block}#cfstringtransform table td:first-child{width:60%}#icloud header time{background-color:rgba(255,128,0,0.2)}
      /*# sourceMappingURL=/assets/source-maps/screen.scss.map */
      /*# sourceURL=assets/css/screen.scss */
    </style>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>
    <link rel="manifest" href="/site.webmanifest"/>
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#292724"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="NSHipster"/>
    <meta name="application-name" content="NSHipster"/>
    <meta name="msapplication-TileColor" content="#f8f7f5"/>
    <meta name="theme-color" content="#f8f7f5"/>
    <link rel="author" type="text/plain" href="/humans.txt"/>
    <link rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@NSHipster"/>
    <meta name="twitter:title" content="API Pollution in Swift Modules"/>
    <meta name="twitter:description" content="When you import a module into Swift code, you expect the result to be entirely additive. But as we‚Äôll see, this isn‚Äôt always the case.
"/>
    <meta name="twitter:label1" value="Category" />
    <meta name="twitter:data1" value="Swift" />
    <meta name="twitter:account_id" content="629523445"/>
    <meta property="og:site_name" content="NSHipster"/>
    <meta property="og:image" content="https://nshipster.com/logo.png"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="API Pollution in Swift Modules"/>
    <meta property="og:url" content="https://nshipster.com/swift-api-pollution/"/>
    <meta property="og:description" content="When you import a module into Swift code, you expect the result to be entirely additive. But as we‚Äôll see, this isn‚Äôt always the case.
"/>
    <meta property="article:published_time" content="2019-02-18T00:00:00-08:00"/>
    <meta property="article:modified_time" content="2019-04-02T08:39:53-07:00"/>
    <meta property="article:tag" content="Swift"/>
    <meta property="article:publisher" content="https://www.facebook.com/NSHipster">
    <link rel="next" href="https://nshipster.com/javascriptcore/" />
    <link rel="prev" href="https://nshipster.com/swift-regular-expressions/" />
  </head>
  <body>
    <div class="container">
      <header role="banner">
        <h1 id="logo">
          <a href="/" title="NSHipster">
            <?xml version="1.0"?>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 474.4 266.34">
                <g id="ns">
                  <path d="M16.05 5.37h68.38l88.78 157.52h.72V5.37h62.64V261H168.2L79.42 101.67h-.72V261H16.05z"/>
                  <path d="M294.78 175.06c1.43 30.07 20 39.73 48.33 39.73 20 0 40.81-7.16 40.81-26.13 0-22.55-36.52-26.85-73.39-37.23-36.52-10.38-74.82-26.85-74.82-73.75C235.71 21.84 291.91 0 339.88 0c50.84 0 102 24.7 102.39 82.34h-66.59c1.08-23.27-20.76-30.79-41.17-30.79-14.32 0-32.21 5-32.21 21.84 0 19.69 36.87 23.27 74.1 33.65 36.87 10.38 74.1 27.56 74.1 73.74 0 64.8-55.13 85.56-111.33 85.56-58.71 0-110.62-25.77-111-91.28z"/>
                </g>
                <g id="mustache">
                  <path d="M168.07 104.61c-59.6 3-113.84 79.27-168.07 12.52 0 90 141.25 181.77 237.2 97.14 95.36 84 237.2-7.75 237.2-97.14-74.5 91.78-149-85.83-237.2 26.81-23.84-31.58-47.08-40.52-69.13-39.33z"/>
                </g>
              </svg>
            </a>
          </h1>
        </header>
        <main>
          <article role="article" itemscope itemtype="https://schema.org/Article">
            <header role="heading">
              <h1 class="title" itemprop="name">
                <a href="/swift-api-pollution/">API Pollution in Swift Modules</a>
              </h1>
              <div class="byline">
                Written by
                <span class="authors">
                  <a class="author" href="/authors/mattt/">Mattt</a>
                </span>
                <time datetime="2019-02-18T00:00:00-08:00" itemprop="datePublished">February 18<sup>th</sup>, 2019</time>
                <time datetime="2019-02-18T00:00:00-08:00" itemprop="dateModified" hidden aria-hidden="true">February 18<sup>th</sup>, 2019</time>
              </div>
              <link itemprop="image" href="https://nshipster.com/logo.png"/>
              <meta itemprop="headline" content="API Pollution in Swift Modules"/>
              <div itemprop="publisher" itemscope itemtype="http://schema.org/Organization" hidden aria-hidden="true">
                <meta itemprop="name" content="NSHipster"/>
                <meta itemprop="logo" content="https://nshipster.com/logo.png"/>
              </div>
            </header>
            <div class="content" itemprop="articleBody">
              <p>When you import a module into Swift code,
                you expect the result to be entirely additive.
                That is to say:
                the potential for new functionality comes at no expense
                (other than, say, a modest increase in the size of your app bundle).</p>
              <p>Import the <code>Natural<wbr></wbr>Language</code> framework,
              and <em><strong>*boom*</strong></em> your app can
              <a href="https://nshipster.com/nllanguagerecognizer/">determine the language of text</a>;
              import <code>Core<wbr></wbr>Motion</code>,
            and <em><strong>*whoosh*</strong></em> your app can
            <a href="https://nshipster.com/cmdevicemotion/">respond to changes in device orientation</a>.
            But it‚Äôd be surprising if, say,
            the ability to distinguish between French and Japanese
            interfered with your app‚Äôs ability to tell which way was magnetic north.</p>
          <p>Although this particular example isn‚Äôt real
            (to the relief of Francophones in Hokkaido),
            there are situations in which a Swift dependency
            can change how your app behaves ‚Äî
            <em>even if you don‚Äôt use it directly</em>.</p>
          <p>In this week‚Äôs article,
            we‚Äôll look at a few ways that imported modules can
            silently change the behavior of existing code,
            and offer suggestions for how to
            prevent this from happening as an API provider
            and mitigate the effects of this as an API consumer.</p>
          <h2>
            <a class="anchor" aria-hidden="true" id="module-pollution" href="#module-pollution"></a>Module Pollution</h2>
          <p>It‚Äôs a story as old as <code>&lt;time.h&gt;</code>:
            two things are called <code>Foo</code>,
            and the compiler has to decide what to do.</p>
          <p>Pretty much every language with a mechanism for code reuse
            has to deal with <dfn>naming collisions</dfn> one way or another.
            In the case of Swift,
            you can use <dfn>fully-qualified names</dfn> to distinguish
            between the <code>Foo</code> type declared in module <code>A</code> (<code>A.Foo</code>)
            from the <code>Foo</code> type in module <code>B</code> (<code>B.Foo</code>).
            However, Swift has some unique characteristics
            that cause other ambiguities to go unnoticed by the compiler,
            which may result in a change to existing behavior
            when modules are imported.</p>
          <aside class="admonition info">
            <p>For the purposes of this article,
              we use the term <dfn>pollution</dfn>
              to describe such side-effects caused by importing Swift modules
              that aren‚Äôt surfaced by the compiler.
              We‚Äôre not 100% on this terminology,
              so please <a href="https://twitter.com/nshipster" rel="noopener noreferrer">get in touch</a>
              if you can think of any other suggestions.</p>
          </aside>
          <h3>
            <a class="anchor" aria-hidden="true" id="operator-overloading" href="#operator-overloading"></a>Operator Overloading</h3>
          <p>In Swift,
            the <code>+</code> operator denotes <dfn>concatenation</dfn>
            when its operands are arrays.
            One array plus another results in
            an array with the elements of the former array followed by those of the latter.</p>
          <pre class="highlight" data-lang="Swift"><code><span class="k">let</span> <span class="nv">one<wbr></wbr>Two<wbr></wbr>Three</span><span class="p">:</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">four<wbr></wbr>Five<wbr></wbr>Six</span><span class="p">:</span> <span class="p">[</span><span class="kt">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">one<wbr></wbr>Two<wbr></wbr>Three</span> <span class="o">+</span> <span class="n">four<wbr></wbr>Five<wbr></wbr>Six</span> <span class="c1">// [1, 2, 3, 4, 5, 6]</span>
</code></pre>
          <p>If we look at the operator‚Äôs
            <a href="https://github.com/apple/swift/blob/master/stdlib/public/core/Array.swift#L1318-L1324" rel="noopener noreferrer">declaration in the standard library</a>,
            we see that it‚Äôs provided in an unqualified extension on <code>Array</code>:</p>
          <pre class="highlight" data-lang="Swift"><code><span class="kd">extension</span> <span class="kt">Array</span> <span class="p">{</span>
  <span class="kd">@inlinable</span> <span class="kd">public</span> <span class="kd">static</span> <span class="kd">func</span> <span class="o">+</span> <span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="kt">Array</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="kt">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Array</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre>
          <p>The Swift compiler is responsible for
            resolving API calls to their corresponding implementations.
            If an invocation matches more than one declaration,
            the compiler selects the most specific one available.</p>
          <p>To illustrate this point,
            consider the following conditional extension on <code>Array</code>,
            which defines the <code>+</code> operator to perform <dfn>member-wise addition</dfn>
            for arrays whose elements conform to <code>Numeric</code>:</p>
          <pre class="highlight" data-lang="Swift"><code><span class="kd">extension</span> <span class="kt">Array</span> <span class="k">where</span> <span class="kt">Element</span><span class="p">:</span> <span class="kt">Numeric</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">func</span> <span class="o">+</span> <span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="kt">Array</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="kt">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Array</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">Array</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span><span class="nv">$0</span> <span class="o">+</span> <span class="nv">$1</span><span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">one<wbr></wbr>Two<wbr></wbr>Three</span> <span class="o">+</span> <span class="n">four<wbr></wbr>Five<wbr></wbr>Six</span> <span class="c1">// [5, 7, 9] üòï</span>
</code></pre>
          <p>Because the requirement of <code>Element: Numeric</code>
            is more specific than the unqualified declaration in the standard library,
            the Swift compiler resolves <code>+</code> to this function instead.</p>
          <p>Now,
            these new semantics may be perfectly acceptable ‚Äî indeed preferable.
            But only if you‚Äôre aware of them.
            The problem is that
            if you so much as <em>import</em> a module containing such a declaration
            you can change the behavior of your entire app without even knowing it.</p>
          <p>This problem isn‚Äôt limited to matters of semantics;
            it can also come about as a result of ergonomic affordances.</p>
          <h3>
            <a class="anchor" aria-hidden="true" id="function-shadowing" href="#function-shadowing"></a>Function Shadowing</h3>
          <p>In Swift,
            function declarations can specify default arguments for trailing parameters,
            making them optional (though not necessarily <code>Optional</code>) for callers.
            For example,
            the top-level function
            <a href="https://developer.apple.com/documentation/swift/1539127-dump" rel="noopener noreferrer"><code>dump(_:name:indent:max<wbr></wbr>Depth:max<wbr></wbr>Items:)</code></a>
        has an intimidating number of parameters:</p>
      <pre class="highlight" data-lang="Swift"><code><span class="kd">@discardable<wbr></wbr>Result</span> <span class="kd">func</span> <span class="n">dump</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">T</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">indent</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">max<wbr></wbr>Depth</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="nv">max<wbr></wbr>Items</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">.</span><span class="n">max</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span>
</code></pre>
      <p>But thanks to default arguments,
        you need only specify the first one to call it:</p>
      <pre class="highlight" data-lang="Swift"><code><span class="nf">dump</span><span class="p">(</span><span class="s">"üè≠üí®"</span><span class="p">)</span> <span class="c1">// "üè≠üí®"</span>
</code></pre>
      <p>Alas,
        this source of convenience can become a point of confusion
        when method signatures overlap.</p>
      <p>Imagine a hypothetical module that ‚Äî
        not being familiar with the built-in <code>dump</code> function ‚Äî
        defines a <code>dump(_:)</code> that prints the UTF-8 code units of a string.</p>
      <pre class="highlight" data-lang="Swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">dump</span><span class="p">(</span><span class="n">_</span> <span class="nv">string</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">utf8</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span><span class="nv">$0</span><span class="p">})</span>
<span class="p">}</span>
</code></pre>
      <p>The <code>dump</code> function declared in the Swift standard library
        takes an unqualified generic <code>T</code> argument in its first parameter
        (which is effectively <code>Any</code>).
        Because <code>String</code> is a more specific type,
        the Swift compiler will choose the imported <code>dump(_:)</code> method
        when it‚Äôs available.</p>
      <pre class="highlight" data-lang="Swift"><code><span class="nf">dump</span><span class="p">(</span><span class="s">"üè≠üí®"</span><span class="p">)</span> <span class="c1">// [240, 159, 143, 173, 240, 159, 146, 168]</span>
</code></pre>
      <p>Unlike the previous example,
        it‚Äôs not entirely clear that there‚Äôs any ambiguity
        in the competing declarations.
        After all,
        what reason would a developer have to think that their <code>dump(_:)</code> method
        could in any way be confused for <code>dump(_:name:indent:max<wbr></wbr>Depth:max<wbr></wbr>Items:)</code>?</p>
  <p>Which leads us to our final example,
    which is perhaps the most confusing of all‚Ä¶</p>
  <h3>
    <a class="anchor" aria-hidden="true" id="string-interpolation-pollution" href="#string-interpolation-pollution"></a>String Interpolation Pollution</h3>
  <p>In Swift,
    you can combine two strings by interpolation in a string literal
    as an alternative to concatenation.</p>
  <pre class="highlight" data-lang="Swift"><code><span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="s">"Swift"</span>
<span class="k">let</span> <span class="nv">greeting</span> <span class="o">=</span> <span class="s">"Hello, </span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">!"</span> <span class="c1">// "Hello, Swift!"</span>
</code></pre>
  <p>This has been true from the first release of Swift.
    However, with the new
    <a href="/expressiblebystringinterpolation"><code>Expressible<wbr></wbr>By<wbr></wbr>String<wbr></wbr>Interpolation</code></a>
protocol in Swift 5,
this behavior can no longer be taken for granted.</p>
<p>Consider the following extension on the default interpolation type for <code>String</code>:</p>
<pre class="highlight" data-lang="Swift"><code><span class="kd">extension</span> <span class="kt">Default<wbr></wbr>String<wbr></wbr>Interpolation</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="k">mutating</span> <span class="kd">func</span> <span class="n">append<wbr></wbr>Interpolation</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">T</span><span class="p">)</span> <span class="k">where</span> <span class="kt">T</span><span class="p">:</span> <span class="kt">String<wbr></wbr>Protocol</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">append<wbr></wbr>Interpolation</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="nf">uppercased</span><span class="p">()</span> <span class="k">as</span> <span class="kt">Text<wbr></wbr>Output<wbr></wbr>Streamable</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><code>String<wbr></wbr>Protocol</code> inherits,
<a href="https://swiftdoc.org/v4.2/protocol/stringprotocol/" rel="noopener noreferrer">among other things</a>
the <code>Text<wbr></wbr>Output<wbr></wbr>Streamable</code> and <code>Custom<wbr></wbr>String<wbr></wbr>Convertible</code> protocols,
making it more specific than the
<a href="https://github.com/apple/swift/blob/master/stdlib/public/core/StringInterpolation.swift#L63" rel="noopener noreferrer"><code>append<wbr></wbr>Interpolation</code> method declared by <code>Default<wbr></wbr>String<wbr></wbr>Interpolation</code></a>
that would otherwise be invoked when interpolating <code>String</code> values.</p>
<pre class="highlight" data-lang="Swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Default<wbr></wbr>String<wbr></wbr>Interpolation</span><span class="p">:</span> <span class="kt">String<wbr></wbr>Interpolation<wbr></wbr>Protocol</span> <span class="p">{</span>
    <span class="kd">@inlinable</span> <span class="kd">public</span> <span class="k">mutating</span> <span class="kd">func</span> <span class="n">append<wbr></wbr>Interpolation</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">T</span><span class="p">)</span>
        <span class="k">where</span> <span class="kt">T</span><span class="p">:</span> <span class="kt">Text<wbr></wbr>Output<wbr></wbr>Streamable</span><span class="p">,</span> <span class="kt">T</span><span class="p">:</span> <span class="kt">Custom<wbr></wbr>String<wbr></wbr>Convertible</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre>
<p>Once again,
  the Swift compiler‚Äôs notion of specificity
  causes behavior to go from expected to unexpected.</p>
<p>If the previous declaration is made accessible by any module in your app,
  it would change the behavior of all interpolated string values.</p>
<pre class="highlight" data-lang="Swift"><code><span class="k">let</span> <span class="nv">greeting</span> <span class="o">=</span> <span class="s">"Hello, </span><span class="se">\(</span><span class="n">name</span><span class="se">)</span><span class="s">!"</span> <span class="c1">// "Hello, SWIFT!"</span>
</code></pre>
<aside class="admonition info">
  <p>Admittedly, this last example‚Äôs a bit contrived;
    an implementor has to go out of their way
    to make the implementation not recursive.
    But consider this a stand-in for a less-obvious example
    that‚Äôs more likely to actually happen in real-life.</p>
</aside>
<hr>
<p>Given the rapid and upward trajectory of the language,
  it‚Äôs not unreasonable to expect that these problems will be solved
  at some point in the future.</p>
<p>But what are we to do in the meantime?
  Here are some suggestions for managing this behavior
  both as an API consumer and as an API provider.</p>
<hr>
<h2>
  <a class="anchor" aria-hidden="true" id="strategies-for-api-consumers" href="#strategies-for-api-consumers"></a>Strategies for API Consumers</h2>
<p>As an API consumer,
  you are ‚Äî in many ways ‚Äî
  beholden to the constraints imposed by imported dependencies.
  It really <em>shouldn‚Äôt</em> be your problem to solve,
  but at least there are some remedies available to you.</p>
<h3>
  <a class="anchor" aria-hidden="true" id="add-hints-to-the-compiler" href="#add-hints-to-the-compiler"></a>Add Hints to the Compiler</h3>
<p>Often,
  the most effective way to get the compiler to do what you want
  is to explicitly cast an argument down to a type
  that matches the method you want to call.</p>
<p>Take our example of the <code>dump(_:)</code> method from before:
  by downcasting to <code>Custom<wbr></wbr>String<wbr></wbr>Convertible</code> from <code>String</code>,
we can get the compiler to resolve the call
to use the standard library function instead.</p>
<pre class="highlight" data-lang="Swift"><code><span class="nf">dump</span><span class="p">(</span><span class="s">"üè≠üí®"</span><span class="p">)</span> <span class="c1">// [240, 159, 143, 173, 240, 159, 146, 168]</span>
<span class="nf">dump</span><span class="p">(</span><span class="s">"üè≠üí®"</span> <span class="k">as</span> <span class="kt">Custom<wbr></wbr>String<wbr></wbr>Convertible</span><span class="p">)</span> <span class="c1">// "üè≠üí®"</span>
</code></pre>
<h3>
  <a class="anchor" aria-hidden="true" id="scoped-import-declarations" href="#scoped-import-declarations"></a><del>Scoped Import Declarations</del>
</h3>
<aside class="admonition warning">
  <p>As discussed in <a href="/swift-import-declarations">a previous article</a>
    you can use Swift import declarations to resolve naming collisions.</p>
  <p>Unfortunately,
    scoping an import to certain APIs in a module
    doesn‚Äôt currently prevent extensions from applying to existing types.
    That is to say,
    you can‚Äôt import an <code>adding(_:)</code> method
    without also importing an overloaded <code>+</code> operator declared in that module.</p>
</aside>
<h3>
  <a class="anchor" aria-hidden="true" id="fork-dependencies" href="#fork-dependencies"></a>Fork Dependencies</h3>
<p>If all else fails,
  you can always solve the problem
  by taking it into your own hands.</p>
<p>If you don‚Äôt like something that a third-party dependency is doing,
  simply fork the source code,
  get rid of the stuff you don‚Äôt want,
  and use that instead.
  (You could even try to get them to upstream the change.)</p>
<aside class="admonition error">
  <p>Unfortunately,
    this strategy won‚Äôt work for closed-source modules,
    including the ones in Apple‚Äôs SDKs.
    <em><a href="/bug-reporting/">‚ÄúRadar or GTFO‚Äù</a></em>, I suppose.</p>
</aside>
<h2>
  <a class="anchor" aria-hidden="true" id="strategies-for-api-provider" href="#strategies-for-api-provider"></a>Strategies for API Provider</h2>
<p>As someone developing an API,
  it‚Äôs ultimately your responsibility to be deliberate and considerate
  in your design decisions.
  As you think about the greater consequences of your actions,
  here are some things to keep in mind:</p>
<h3>
  <a class="anchor" aria-hidden="true" id="be-more-discerning-with-generic-constraints" href="#be-more-discerning-with-generic-constraints"></a>Be More Discerning with Generic Constraints</h3>
<p>Unqualified <code>&lt;T&gt;</code> generic constraints are the same as <code>Any</code>.
  If it makes sense to do so,
  consider making your constraints more specific
  to reduce the chance of overlap with unrelated declarations.</p>
<h3>
  <a class="anchor" aria-hidden="true" id="isolate-core-functionality-from-convenience" href="#isolate-core-functionality-from-convenience"></a>Isolate Core Functionality from Convenience</h3>
<p>As a general rule,
  code should be organized into modules
  such that module is responsible for a single responsibility.</p>
<p>If it makes sense to do so,
  consider packaging functionality provided by types and methods
  in a module that is separate from
  any extensions you provide to built-in types to improve their usability.
  Until it‚Äôs possible to pick and choose which behavior we want from a module,
  the best option is to give consumers the choice to opt-in to features
  if there‚Äôs a chance that they might cause problems downstream.</p>
<h3>
  <a class="anchor" aria-hidden="true" id="avoid-collisions-altogether" href="#avoid-collisions-altogether"></a>Avoid Collisions Altogether</h3>
<p>Of course,
  it‚Äôd be great if you could knowingly avoid collisions to begin with‚Ä¶
  but that gets into the whole
  <em><a href="https://en.wikipedia.org/wiki/There_are_known_knowns" rel="noopener noreferrer">‚Äúunknown unknowns‚Äù</a></em> thing,
  and we don‚Äôt have time to get into epistemology now.</p>
<p>So for now,
  let‚Äôs just say that if you‚Äôre aware of something <em>maybe</em> being a conflict,
  a good option might be to avoid it altogether.</p>
<p>For example,
  if you‚Äôre worried that someone might get huffy about
  changing the semantics of fundamental arithmetic operators,
  you could choose a different one instead, like <code>.+</code>:</p>
<pre class="highlight" data-lang="Swift"><code><span class="k">infix</span> <span class="k">operator</span> <span class="o">.+</span><span class="p">:</span> <span class="kt">Addition<wbr></wbr>Precedence</span>

<span class="kd">extension</span> <span class="kt">Array</span> <span class="k">where</span> <span class="kt">Element</span><span class="p">:</span> <span class="kt">Numeric</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="o">.+</span> <span class="p">(</span><span class="nv">lhs</span><span class="p">:</span> <span class="kt">Array</span><span class="p">,</span> <span class="nv">rhs</span><span class="p">:</span> <span class="kt">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Array</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">Array</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span><span class="nv">$0</span> <span class="o">+</span> <span class="nv">$1</span><span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">one<wbr></wbr>Two<wbr></wbr>Three</span> <span class="o">+</span> <span class="n">four<wbr></wbr>Five<wbr></wbr>Six</span> <span class="c1">// [1, 2, 3, 4, 5, 6]</span>
<span class="n">one<wbr></wbr>Two<wbr></wbr>Three</span> <span class="o">.+</span> <span class="n">four<wbr></wbr>Five<wbr></wbr>Six</span> <span class="c1">// [5, 7, 9]</span>
</code></pre>
<hr>
<p>As developers,
  we‚Äôre perhaps less accustomed to considering the wider impact of our decisions.
  Code is invisible and weightless,
  so it‚Äôs easy to forget that it even exists
  after we ship it.</p>
<p>But in Swift,
  our decisions have impacts beyond what‚Äôs immediately understood
  so it‚Äôs important to be considerate about how we exercise our responsibilities
  as stewards of our APIs.</p>
</div>
<footer role="complementary">
  <section id="revisions">
    <small>NSMutableHipster</small>
    <p>
      Questions? Corrections? <a href="https://github.com/NSHipster/articles/issues">Issues</a> and <a href="https://github.com/NSHipster/articles/blob/master/2019-02-18-swift-api-pollution.md">pull requests</a> are always welcome.
    </p>
    <p class="status">
      <em>This article uses Swift version 5.0.</em>
      Find status information for all articles on the <a href="/status/">status page</a>.
    </p>
  </section>
  <section id="attribution">
    <div class="contributor" itemprop="author" itemscope itemtype="https://schema.org/Person">
      <small>Written by</small>
      <img class="avatar" alt="Mattt" itemprop="image" src="/assets/mattt-93904827ef54896bb67f3a0d4abf548b9ecc93a51536bbc3326f24630512727d.jpg" draggable="false"/>
      <div class="details">
        <span itemprop="name"><a href="/authors/mattt/">Mattt</a></span>
        <p><a href="https://github.com/mattt" rel="noopener noreferrer">Mattt</a> (<a href="https://twitter.com/mattt" rel="noopener noreferrer">@mattt</a>)
          is a writer and developer in Portland, Oregon.
          He is the founder of NSHipster and <a href="https://flight.school" rel="noopener noreferrer">Flight School</a>,
          and the creator of several open source libraries,
          including <a href="https://github.com/afnetworking/afnetworking" rel="noopener noreferrer">AFNetworking</a>
          and <a href="https://github.com/alamofire/alamofire" rel="noopener noreferrer">Alamofire</a>.</p>
        <a href="https://plus.google.com/106751358503565042647?rel=author" rel="author"></a>
      </div>
    </div>
  </section>
  <section>
    <div id="continue">
      <small>Next Article</small>
      <article>
        <h1 class="title">
          <a rel="next" href="/javascriptcore/" title="JavaScriptCore">Java‚ÄãScript‚ÄãCore</a>
        </h1>
        <p>Whether you love it or hate it,  JavaScript has become the most important language for developers today. Despite any efforts we may take to change or replace it we‚Äôd be hard-pressed to deny its usefulness.</p>
      </article>
    </div>
  </section>
</footer>
</article>
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https://nshipster.com",
          "name": "Articles"
        }
      },
      {
        "@type": "ListItem",
        "position": 2,
        "item": {
          "@id": "https://nshipster.com/swift-api-pollution/",
          "name": "API Pollution in Swift Modules"
        }
      }
    ]
  }
</script>
</main>
<footer role="contentinfo">
  <section class="credits colophon">
    <p>
      <i aria-hidden="true" class="icon-cc" title="Creative Commons"></i>
      <i aria-hidden="true" class="icon-by" title="Attribution"></i>
      <i aria-hidden="true" class="icon-nc" title="Non-Commercial"></i>
      NSHipster.com is released under a <a href="https://creativecommons.org/licenses/by-nc/4.0/" rel="license">Creative Commons BY-NC License</a>.
    </p>
    <p>
      NSHipster is also available in
      <a href="https://nshipster.cn" hreflang="zh-Hans">Chinese (Simplified)</a>,
      <a href="https://nshipster.co.kr" hreflang="ko">Korean</a>,
      <a href="https://nshipster.fr" hreflang="fr">French</a>, and
      <a href="https://nshipster.es" hreflang="es">Spanish</a>
      .
    </p>
    <a href="https://plus.google.com/105091289906267717942" rel="publisher" hidden aria-hidden="true"></a>
  </section>
</footer>
</div>
<script async="async" src="/assets/application-7c59b22d22e826c0d17fc358aa9a2008daa8b396741ab2ef1a854e4780b0c624.js" integrity="sha256-fFmyLSLoJsDRf8NYqpogCNqos5Z0GrLvGoVOR4CwxiQ=" crossorigin="anonymous"></script>
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "NSHipster",
    "legalName": "NSHipster, LLC",
    "url": "https://nshipster.com",
    "logo": "https://nshipster.com/logo.png",
    "foundingDate": "2012",
    "founders": [{
      "@type": "Person",
      "name": "Mattt"
    }],
    "sameAs": [
      "https://twitter.com/nshipster",
      "https://github.com/nshipster",
      "https://plus.google.com/+NSHipster",
      "https://www.facebook.com/NSHipster"
    ]
  }
</script>
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://nshipster.com",
    "name": "NSHipster",
    "author": {
      "@type": "Person",
      "name": "Mattt"
    },
    "description": "NSHipster is a journal of the overlooked bits in Objective-C, Swift, and Cocoa. Updated weekly.
  ",
    "publisher": "Read Evaluate Press, LLC"
  }
</script>
<script type="application/cereal+json">
    {
        "endpoint": "https://analytics.nshipster.com/",
        "property": 1
    }
</script>
<script async defer src="https://analytics.nshipster.com/tracker.js"></script></body>
</html>