<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" xmlns:article="http://ogp.me/ns/article" lang="en-US" itemscope itemtype="http://schema.org/Article"  class="touch-styles">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- This is Squarespace. --><!-- john-sundell -->
<base href="">
<meta charset="utf-8" />
<title>Task-based concurrency in Swift &mdash; Swift by Sundell</title>
<link rel="shortcut icon" type="image/x-icon" href="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bbf679be5e5f068eedca7ba/favicon.ico"/>
<link rel="canonical" href="https://www.swiftbysundell.com/posts/task-based-concurrency-in-swift"/>
<meta property="og:site_name" content="Swift by Sundell"/>
<meta property="og:title" content="Task-based concurrency in Swift"/>
<meta property="og:latitude" content="40.7207559"/>
<meta property="og:longitude" content="-74.00076130000002"/>
<meta property="og:url" content="https://www.swiftbysundell.com/posts/task-based-concurrency-in-swift"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Just like sequential code, concurrent code can come in many different shapes and forms. Depending on what we’re trying to achieve, the abstraction that’ll prove to be the best fit might vary quite a lot from use case to use case.  One such abstraction is Tasks, and this week, let’s take a look at so"/>
<meta property="og:image" content="http://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bc0db2cb208fc1df53c443d/1539365704579/SwiftBySundellPodcastLogo.png?format=1500w"/>
<meta property="og:image:width" content="1000"/>
<meta property="og:image:height" content="1000"/>
<meta itemprop="name" content="Task-based concurrency in Swift"/>
<meta itemprop="url" content="https://www.swiftbysundell.com/posts/task-based-concurrency-in-swift"/>
<meta itemprop="description" content="Just like sequential code, concurrent code can come in many different shapes and forms. Depending on what we’re trying to achieve, the abstraction that’ll prove to be the best fit might vary quite a lot from use case to use case.  One such abstraction is Tasks, and this week, let’s take a look at so"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bc0db2cb208fc1df53c443d/1539365704579/SwiftBySundellPodcastLogo.png?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bc0db2cb208fc1df53c443d/1539365704579/SwiftBySundellPodcastLogo.png?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bc0db2cb208fc1df53c443d/1539365704579/SwiftBySundellPodcastLogo.png?format=1500w"/>
<meta itemprop="author" content="John Sundell"/>
<meta itemprop="datePublished" content="2019-02-03T16:15:17+0100"/>
<meta itemprop="headline" content="Task-based concurrency in Swift"/>
<meta itemprop="publisher" content="Swift by Sundell"/>
<meta name="twitter:title" content="Task-based concurrency in Swift"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bc0db2cb208fc1df53c443d/1539365704579/SwiftBySundellPodcastLogo.png?format=1500w"/>
<meta name="twitter:url" content="https://www.swiftbysundell.com/posts/task-based-concurrency-in-swift"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="Just like sequential code, concurrent code can come in many different shapes and forms. Depending on what we’re trying to achieve, the abstraction that’ll prove to be the best fit might vary quite a lot from use case to use case.  One such abstraction is Tasks, and this week, let’s take a look at so"/>
<meta name="description" content="Just like sequential code, concurrent code can come in many different 
shapes and forms. Depending on what we’re trying to achieve, the 
abstraction that’ll prove to be the best fit might vary quite a lot from 
use case to use case.

One such abstraction is Tasks, and this week, let’s take a look at some 
scenarios in which they can become really useful." />
<script type="text/javascript" src="//use.typekit.net/ik/3eQRpQFKFWQoGqoJL__xLoF5g3FtAI5PIEE-6QBtqBIfeljgfFHN4UJLFRbh52jhWD9oweJXweJaFQMUFc9UweFyFhZKZcja5g7bMPG0-cNGdKuDiAoqZAUCO1FUiABkZWF3jAF8OcFzdPU7dhy0OWFudcs8de30SaBujW48Sagyjh90jhNlOeUzjhBC-eNDifUDih8cie4oSam0ZemCdfoRdhXCiaiaOcTz-etlSam0ZemCdfoDSWmyScmDSeBRZPoRdhXCiaiaO1Fa-AZXj18DiAoqZAUCOcFzdPJHdA80-AN0OWgkdkG4fHIuIMMjgfMfqMeZldYFgb.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lato:400,700,700i,400i|Open+Sans:700,700i,400i,400|Playfair+Display:700,700i,400i,400|Raleway:700,700i,400i,400|Source+Sans+Pro:600,700,400,700i,600i"/>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//static.squarespace.com/universal/scripts-compressed/common-3131a14c4b121a1e188e-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//static.squarespace.com/universal/scripts-compressed/common-3131a14c4b121a1e188e-min.en-US.js" ></script><script crossorigin="anonymous" src="//static.squarespace.com/universal/scripts-compressed/performance-c647dc15634a6db3a1fd-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"facebookAppId":"314192535267336","rollups":{"squarespace-announcement-bar":{"css":"//static.squarespace.com/universal/styles-compressed/announcement-bar-d41d8cd98f00b204e9800998ecf8427e-min.css","js":"//static.squarespace.com/universal/scripts-compressed/announcement-bar-ea5adfb884685aaf1ad8-min.en-US.js"},"squarespace-audio-player":{"css":"//static.squarespace.com/universal/styles-compressed/audio-player-a57b8f3aa31918104f57a068648fbc63-min.css","js":"//static.squarespace.com/universal/scripts-compressed/audio-player-35f2841c5b17da7a6851-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//static.squarespace.com/universal/styles-compressed/blog-collection-list-d41d8cd98f00b204e9800998ecf8427e-min.css","js":"//static.squarespace.com/universal/scripts-compressed/blog-collection-list-f7e14bfdc5cf09298d8e-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//static.squarespace.com/universal/styles-compressed/calendar-block-renderer-9acef2d24c6a994fca1a8a82e99e19c3-min.css","js":"//static.squarespace.com/universal/scripts-compressed/calendar-block-renderer-51a31e49686b29097e30-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//static.squarespace.com/universal/styles-compressed/chartjs-helpers-9935a41d63cf08ca108505d288c1712e-min.css","js":"//static.squarespace.com/universal/scripts-compressed/chartjs-helpers-21c25d36ed4d1de0ece1-min.en-US.js"},"squarespace-comments":{"css":"//static.squarespace.com/universal/styles-compressed/comments-a7b26c9ae88684f76d210b61d0b0d848-min.css","js":"//static.squarespace.com/universal/scripts-compressed/comments-b2e4edbcd7ccac92c988-min.en-US.js"},"squarespace-commerce-cart":{"js":"//static.squarespace.com/universal/scripts-compressed/commerce-cart-2f8ae2b01dd347561186-min.en-US.js"},"squarespace-commerce-checkout-v2_5":{"js":"//static.squarespace.com/universal/scripts-compressed/commerce-checkout-v2_5-d59ef45d19291bb3219e-min.en-US.js"},"squarespace-dialog":{"css":"//static.squarespace.com/universal/styles-compressed/dialog-7ba230f290b5d21d9871eb06db23b5c9-min.css","js":"//static.squarespace.com/universal/scripts-compressed/dialog-b6ded19cfed2337a69ae-min.en-US.js"},"squarespace-events-collection":{"css":"//static.squarespace.com/universal/styles-compressed/events-collection-9acef2d24c6a994fca1a8a82e99e19c3-min.css","js":"//static.squarespace.com/universal/scripts-compressed/events-collection-d093e781b6d8d4a4360c-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//static.squarespace.com/universal/scripts-compressed/form-rendering-utils-c38d03688b0637b33601-min.en-US.js"},"squarespace-forms":{"css":"//static.squarespace.com/universal/styles-compressed/forms-ac7917c174031c937e3df4b3a2005b34-min.css","js":"//static.squarespace.com/universal/scripts-compressed/forms-abfd585f5b489c9f426e-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//static.squarespace.com/universal/styles-compressed/gallery-collection-list-d41d8cd98f00b204e9800998ecf8427e-min.css","js":"//static.squarespace.com/universal/scripts-compressed/gallery-collection-list-7648566bab72920ef13d-min.en-US.js"},"squarespace-image-zoom":{"css":"//static.squarespace.com/universal/styles-compressed/image-zoom-72b0ab7796582588032aa6472e2e2f14-min.css","js":"//static.squarespace.com/universal/scripts-compressed/image-zoom-cb5275e89163cb85e96e-min.en-US.js"},"squarespace-pinterest":{"css":"//static.squarespace.com/universal/styles-compressed/pinterest-d41d8cd98f00b204e9800998ecf8427e-min.css","js":"//static.squarespace.com/universal/scripts-compressed/pinterest-0f96759741e00f75abdf-min.en-US.js"},"squarespace-popup-overlay":{"css":"//static.squarespace.com/universal/styles-compressed/popup-overlay-7b48efeab9b323dfdb524a256cf61595-min.css","js":"//static.squarespace.com/universal/scripts-compressed/popup-overlay-a045cf907be702f7ffc2-min.en-US.js"},"squarespace-product-quick-view":{"css":"//static.squarespace.com/universal/styles-compressed/product-quick-view-bc8694b75a40e4bd969b662b80ebafb5-min.css","js":"//static.squarespace.com/universal/scripts-compressed/product-quick-view-ada8cf11acb7d5fa32ed-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//static.squarespace.com/universal/styles-compressed/products-collection-item-v2-72b0ab7796582588032aa6472e2e2f14-min.css","js":"//static.squarespace.com/universal/scripts-compressed/products-collection-item-v2-117f3ba293cc438755ea-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//static.squarespace.com/universal/styles-compressed/products-collection-list-v2-72b0ab7796582588032aa6472e2e2f14-min.css","js":"//static.squarespace.com/universal/scripts-compressed/products-collection-list-v2-95f31684b7f40f133a89-min.en-US.js"},"squarespace-search-page":{"css":"//static.squarespace.com/universal/styles-compressed/search-page-ea3e98edb84abbc5e758884f69149027-min.css","js":"//static.squarespace.com/universal/scripts-compressed/search-page-523940e432331df0eea5-min.en-US.js"},"squarespace-search-preview":{"js":"//static.squarespace.com/universal/scripts-compressed/search-preview-d4962a2918f7334c76e7-min.en-US.js"},"squarespace-share-buttons":{"js":"//static.squarespace.com/universal/scripts-compressed/share-buttons-dd0471529f595e3ba714-min.en-US.js"},"squarespace-simple-liking":{"css":"//static.squarespace.com/universal/styles-compressed/simple-liking-310d0b18e112f708f91339b11fd55714-min.css","js":"//static.squarespace.com/universal/scripts-compressed/simple-liking-49f914022c9f420a505a-min.en-US.js"},"squarespace-social-buttons":{"css":"//static.squarespace.com/universal/styles-compressed/social-buttons-26106f808f7e9c739a7f862a408ed039-min.css","js":"//static.squarespace.com/universal/scripts-compressed/social-buttons-d8c30d0bf118649c06ef-min.en-US.js"},"squarespace-tourdates":{"css":"//static.squarespace.com/universal/styles-compressed/tourdates-d41d8cd98f00b204e9800998ecf8427e-min.css","js":"//static.squarespace.com/universal/scripts-compressed/tourdates-ceea831d06a66c166137-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//static.squarespace.com/universal/styles-compressed/website-overlays-manager-df9cddfe3eca22764d10fd6fc4f4ad73-min.css","js":"//static.squarespace.com/universal/scripts-compressed/website-overlays-manager-46791a7446f1ae7db6a3-min.en-US.js"}},"pageType":50,"website":{"id":"590b40b75016e10ca7fbff78","identifier":"john-sundell","websiteType":1,"contentModifiedOn":1554193587585,"cloneable":false,"siteStatus":{},"language":"en-US","timeZone":"Europe/Stockholm","machineTimeZoneOffset":7200000,"timeZoneOffset":7200000,"timeZoneAbbr":"CEST","siteTitle":"Swift by Sundell","fullSiteTitle":"Task-based concurrency in Swift \u2014 Swift by Sundell","siteTagLine":"A weekly blog about Swift development","siteDescription":"<p>A weekly blog and podcast about Swift development,&nbsp;by John Sundell.</p>","socialLogoImageId":"5bc0db2cb208fc1df53c443d","shareButtonOptions":{"3":true,"7":true,"2":true,"1":true},"socialLogoImageUrl":"//static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bc0db2cb208fc1df53c443d/1554193587585/","authenticUrl":"https://www.swiftbysundell.com","internalUrl":"https://john-sundell.squarespace.com","baseUrl":"https://www.swiftbysundell.com","primaryDomain":"www.swiftbysundell.com","sslSetting":3,"isHstsEnabled":false,"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"be436bac6c5e7797b8285c9a6fdb7263ecdd83da39257eb27b0fb8a2663222b1","showOwnerLogin":false},"websiteSettings":{"id":"590b40b75016e10ca7fbff7a","websiteId":"590b40b75016e10ca7fbff78","type":"Personal","subjects":[],"country":"SE","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"announcementBarSettings":{"style":1,"text":"<p>\u2B50\uFE0F <strong>This week\u2019s sponsor: </strong>Instabug \u2014 an awesome bug and crash reporting SDK. Check them out to support this site.</p>","clickthroughUrl":{"url":"https://try.instabug.com/ios/sdk?utm_source=swiftbysundell&utm_medium=native_ads","newWindow":true}},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":false,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":false,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"paymentSettings":{},"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":2,"showCustomCheckoutForm":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":false,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"isRestrictiveCookiePolicyAbsolute":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":""},"websiteCloneable":false,"collection":{"title":"All posts","id":"590b4514db29d6088905acb0","fullUrl":"/","type":1},"item":{"title":"Task-based concurrency in Swift","id":"5c56de0f53450aaf3bc91afe","fullUrl":"/posts/task-based-concurrency-in-swift","publicCommentCount":0,"commentState":2,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","gallery-arrow-style":"Circular","gallery-aspect-ratio":"16:9 Widescreen","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Slideshow","gallery-info-overlay":"Always Show","gallery-loop":"false","gallery-navigation":"Thumbnails","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(255,255,255,0.7)","galleryArrowColor":"rgba(102,102,102,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,0.8)","galleryInfoBackground":"rgba(255,255,255,0.7)","galleryThumbnailSize":"100px","gridSize":"350px","gridSpacing":"20px","maxNumberColumns":"3","minColumnWidth":"230","tweak-blog-list-grid-alignment":"Top","tweak-blog-list-grid-narrow-columns":"false","tweak-blog-list-max-width":"Wide","tweak-crop-images":"None","tweak-infinite-scroll":"false","tweak-product-item-image-zoom-factor":"2.5","tweak-product-list-item-hover-behavior":"Fade","tweak-product-list-items-per-row":"3","tweak-show-progress-indicator":"false","tweak-user-account-link-position":"With Nav"},"templateId":"54d3906fe4b04c1c9981b00e","pageFeatures":[1,2,4],"googleMapsStaticApiKey":"AIzaSyBQdch5IcgcQaKNG76sbMQv1MEBEKLeQ-8","impersonatedSession":false,"tzData":{"zones":[[60,"EU","CE%sT",null]],"rules":{"EU":[[1981,"max",null,"Mar","lastSun","1:00u","1:00","S"],[1996,"max",null,"Oct","lastSun","1:00u","0",null]]}}};</script><script type="text/javascript"> SquarespaceFonts.loadViaContext(); Squarespace.load(window);</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.swiftbysundell.com/posts?format=RSS" />
<script type="application/ld+json">{"url":"https://www.swiftbysundell.com","name":"Swift by Sundell","description":"<p>A weekly blog and podcast about Swift development,&nbsp;by John Sundell.</p>","@context":"http://schema.org","@type":"WebSite"}</script><!--[if gte IE 9]> <link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&part=1"/><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&part=2"/><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&part=3"/><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&part=4"/><![endif]-->
<!--[if lt IE 9]><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&noMedia=true&part=1"/><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&noMedia=true&part=2"/><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&noMedia=true&part=3"/><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false&noMedia=true&part=4"/><![endif]-->
<!--[if !IE]> --><link rel="stylesheet" type="text/css" href="//static1.squarespace.com/static/sitecss/590b40b75016e10ca7fbff78/37/54d3906fe4b04c1c9981b00e/590b40b75016e10ca7fbff7f/4931-05142015/1554112124687/site.css?&filterFeatures=false"/><!-- <![endif]-->
<script>
var sxs_sponsor_title = 'Instabug';
var sxs_sponsor_text = 'It’s <span class="sxs-ad-highlight">not only my favorite</span> bug and crash reporter — it’s a complete solution for in-app feedback, beta testing, and for improving the <span class="sxs-ad-highlight">quality of your app</span>. <a href="https://try.instabug.com/ios?utm_source=swiftbysundell&utm_medium=native_ads&utm_campaign=swiftbysundellv2" target="_blank">Get started for free</a> by integrating the SDK in a minute, and get a <a href="https://try.instabug.com/ios?utm_source=swiftbysundell&utm_medium=native_ads&utm_campaign=swiftbysundellv2" target="_blank">20% discount on any plan with offer code <em>’SWIFTBYSUNDELL2019’</em></a>.';
var sxs_sponsor_link = 'https://try.instabug.com/ios?utm_source=swiftbysundell&utm_medium=native_ads&utm_campaign=swiftbysundellv2';
var sxs_sponsor_bar_text = "A complete solution for in-app feedback and improved app quality";
var sxs_sponsor_bar_cta = "Get started for free";
</script>

<link rel="apple-touch-icon" href="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5c60a1849b747a28407f474c/1549836677262/sxs-touch-icon.png"/>

<script>
(function() {
    function addSponsorBar() {
        if (location.href.indexOf("/podcast/") != -1) {
            return;
        }

        if (location.href.indexOf("/posts/") != -1) {
            return;
        }

        var bar = document.createElement("div");
        bar.className = "sxs-sponsor-bar";
        bar.innerHTML = '<b>This week’s sponsor: ' + sxs_sponsor_title + '</b>. ' + sxs_sponsor_bar_text + '. <a href="' + sxs_sponsor_link + '" target="_blank">' + sxs_sponsor_bar_cta + '</a>.';
        document.body.appendChild(bar);
    }

    document.addEventListener('DOMContentLoaded', addSponsorBar, false);
})();
</script><style>
.main-nav-wrapper {
    width: 100% !important;
}
  
.sidetray-blocks {
    display: none !important; 
}
  
.social-ellipsis {
    display: none !important; 
}
  
.theme-select {
	padding-top: 40px;
    text-align: center;
}
</style>

<style>
/*
SOURCE CODE PRO LICENSE

Copyright 2010, 2012 Adobe Systems Incorporated (http://www.adobe.com/), with Reserved Font Name 'Source'. All Rights Reserved. Source is a trademark of Adobe Systems Incorporated in the United States and/or other countries.

This Font Software is licensed under the SIL Open Font License, Version 1.1.

This license is copied below, and is also available with a FAQ at: http://scripts.sil.org/OFL

SIL OPEN FONT LICENSE Version 1.1 - 26 February 2007

PREAMBLE The goals of the Open Font License (OFL) are to stimulate worldwide development of collaborative font projects, to support the font creation efforts of academic and linguistic communities, and to provide a free and open framework in which fonts may be shared and improved in partnership with others.

The OFL allows the licensed fonts to be used, studied, modified and redistributed freely as long as they are not sold by themselves. The fonts, including any derivative works, can be bundled, embedded, redistributed and/or sold with any software provided that any reserved names are not used by derivative works. The fonts and derivatives, however, cannot be released under any other type of license. The requirement for fonts to remain under this license does not apply to any document created using the fonts or their derivatives.

DEFINITIONS "Font Software" refers to the set of files released by the Copyright Holder(s) under this license and clearly marked as such. This may include source files, build scripts and documentation.

"Reserved Font Name" refers to any names specified as such after the copyright statement(s).

"Original Version" refers to the collection of Font Software components as distributed by the Copyright Holder(s).

"Modified Version" refers to any derivative made by adding to, deleting, or substituting -- in part or in whole -- any of the components of the Original Version, by changing formats or by porting the Font Software to a new environment.

"Author" refers to any designer, engineer, programmer, technical writer or other person who contributed to the Font Software.

PERMISSION & CONDITIONS Permission is hereby granted, free of charge, to any person obtaining a copy of the Font Software, to use, study, copy, merge, embed, modify, redistribute, and sell modified and unmodified copies of the Font Software, subject to the following conditions:

Neither the Font Software nor any of its individual components, in Original or Modified Versions, may be sold by itself.

Original or Modified Versions of the Font Software may be bundled, redistributed and/or sold with any software, provided that each copy contains the above copyright notice and this license. These can be included either as stand-alone text files, human-readable headers or in the appropriate machine-readable metadata fields within text or binary files as long as those fields can be easily viewed by the user.

No Modified Version of the Font Software may use the Reserved Font Name(s) unless explicit written permission is granted by the corresponding Copyright Holder. This restriction only applies to the primary font name as presented to the users.

The name(s) of the Copyright Holder(s) or the Author(s) of the Font Software shall not be used to promote, endorse or advertise any Modified Version, except to acknowledge the contribution(s) of the Copyright Holder(s) and the Author(s) or with their explicit written permission.

The Font Software, modified or unmodified, in part or in whole, must be distributed entirely under this license, and must not be distributed under any other license. The requirement for fonts to remain under this license does not apply to any document created using the Font Software.

TERMINATION This license becomes null and void if any of the above conditions are not met.

DISCLAIMER THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.
*/

@font-face {
    font-family: "Code";
    src: url(https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5bbb68a415fcc04e6f04fbd3/1539008676911/SourceCodePro-Regular.otf) format("opentype"), url(https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/5b7e6d5e352f532f090a9bbc/1535012191581/SourceCodePro-Regular.ttf) format("truetype");
}

pre.splash {
    margin-bottom: 1.5em;
    background-color: #1a1a1a;
    padding: 16px 0;
    border-radius: 16px;
}

pre.splash code {
    font-family: "Code", monospace;
    display: block;
    padding: 0 20px;
    color: #a9bcbc;
    line-height: 1.4em;
    font-size: 0.95em;
    overflow-x: auto;
    white-space: pre;
}
  
@supports (-moz-appearance:none) {
	pre.splash code {
    	font-family: monospace;  
    }
}

pre.splash code .keyword {
    color: #e73289;
}

pre.splash code .type {
    color: #8281ca;
}

pre.splash code .call {
    color: #348fe5;
}

pre.splash code .property {
    color: #21ab9d;
}

pre.splash code .number {
    color: #db6f57;
}

pre.splash code .string {
    color: #fa641e;
}

pre.splash code .comment {
    color: #6b8a94;
}

pre.splash code .dotAccess {
    color: #92b300;
}

pre.splash code .preprocessing {
    color: #b68a00;
}
</style>

<style>
/* Light theme */
  
body.light-theme #theme-select-light {
    font-weight: bold;  
}
  
/* Dark theme */
  
body.dark-theme,
body.dark-theme.tweak-header-background-color-on.header-tucked .header-announcement-wrapper,
body.dark-theme.nav-open .main-nav-wrapper,
body.dark-theme.show-search .header-search-form,
body.dark-theme.show-search .header-search-form-input {
	background-color: #222 !important;
  	color: #ddd;
}
  
body.dark-theme h1,
body.dark-theme h2,
body.dark-theme a,
body.dark-theme .site-title-text,
body.dark-theme .blog-item-comments-toggle,
body.dark-theme .comment-count {
	color: #ddd !important;  
}
  
body.dark-theme .nav-toggle-label svg,
body.dark-theme .header-search svg,
body.dark-theme .nav-toggle-close-label svg {
	stroke: #ddd;  
}
  
body.dark-theme .blog-item-pagination-link svg {
	fill: #ddd;  
}
  
body.dark-theme.tweak-underline-body-links .html-block a {
	border-color: #ddd;  
}

body.dark-theme .Share-buttons-item,
body.dark-theme .sqs-template-social-icons .sqs-use--icon {
	fill: #ddd !important;  
}
  
body.dark-theme .sidetray-wrapper {
	border-color: #444;
  	background-color: #222;
}
  
body.dark-theme .main-nav-wrapper {
	border: none;  
}
  
body.dark-theme .mobile-bar {
	background-color: #222;  
}

body.dark-theme #theme-select-dark {
	font-weight: bold;  
}
  
body.dark-theme .pagination-title-wrapper {
    background-color: #000;  
}
  
/* Black theme */
  
body.black-theme,
body.black-theme.tweak-header-background-color-on.header-tucked .header-announcement-wrapper,
body.black-theme.nav-open .main-nav-wrapper,
body.black-theme.show-search .header-search-form,
body.black-theme.show-search .header-search-form-input {
	background-color: #000 !important;
  	color: #ddd;
}
  
body.black-theme h1,
body.black-theme h2,
body.black-theme a,
body.black-theme .site-title-text,
body.black-theme .blog-item-comments-toggle,
body.black-theme .comment-count {
	color: #ddd !important;  
}
  
body.black-theme .nav-toggle-label svg,
body.black-theme .header-search svg,
body.black-theme .nav-toggle-close-label svg {
	stroke: #ddd;  
}
  
body.black-theme .blog-item-pagination-link svg {
	fill: #ddd;  
}
  
body.black-theme.tweak-underline-body-links .html-block a {
	border-color: #ddd;  
}
  
body.black-theme .Share-buttons-item,
body.black-theme .sqs-template-social-icons .sqs-use--icon {
	fill: #ddd !important;  
}
  
body.black-theme .sidetray-wrapper {
	border-color: #444;
  	background-color: #000;
}
  
body.black-theme .main-nav-wrapper {
	border: none;  
}
  
body.black-theme .mobile-bar {
	background-color: #000;  
}

body.black-theme #theme-select-black {
	font-weight: bold;  
}
  
body.black-theme .pagination-title-wrapper {
    background-color: #000;  
}
  
.daily-wwdc-wrapper {
	text-align: center;
  	margin-bottom: 40px;
}
  
.daily-wwdc-wrapper a:hover {
	background-color: #f5f5f5;  
}
  
body.dark-theme .daily-wwdc-wrapper a:hover {
	background-color: #333;  
}
  
body.black-theme .daily-wwdc-wrapper a:hover {
	background-color: #111;  
}
  
.daily-wwdc-wrapper a {
    display: inline-block;
	border: 1px solid #000;
    padding: 10px 15px;
    margin: 0px 15px;
    border-radius: 15px;
    color: #f05138;  
}
  
.mobile-style-available .daily-wwdc-wrapper a {
    margin-bottom: 20px;
}
  
body.dark-theme .daily-wwdc-wrapper a,
body.black-theme .daily-wwdc-wrapper a {
    border-color: #ddd;  
}
</style>

<script>
(function() {
    function applyTheme() {
        var theme = window.localStorage.getItem("theme");
    
        if (theme == null) {
            theme = "light"; 
        }
    
        document.body.classList.add(theme + "-theme");
      
        let selector = document.getElementById("theme-select-" + theme)
        
        if (selector != null) {
            selector.removeAttribute("href");
          	selector.removeAttribute("onclick");
        }
    }
  
    document.addEventListener('DOMContentLoaded', applyTheme, false);
})();
  
function selectTheme(theme) {
  window.localStorage.setItem("theme", theme);
  location.reload();
  return false;
}
</script>

<script>
(function() {
  function addCustomMenu() {
    if (!document.body.id.startsWith("collection")) {
        return; 
    }
    
    var menuHTML = '<nav class="custom-menu"><ul>';
    menuHTML += '<li><a href="/">📆 Weekly articles</a></li>'
    menuHTML += '<li><a href="/basics">✅ Basics</a></li>'
    menuHTML += '<li><a href="/podcast">🎙 Podcast</a></li>'
    menuHTML += '<li><a href="/newsletter">📬 Newsletter</a></li>'
    menuHTML += '<li><a href="/sponsor">⭐️ Sponsorship</a></li>'

    var page = document.getElementById("page");
    page.innerHTML = menuHTML + '</ul></nav>' + page.innerHTML;
  }
  
  document.addEventListener('DOMContentLoaded', addCustomMenu, false);
})();
</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<!-- End of Squarespace Headers -->
  <script>
    (function(){
      var touchTest = 'ontouchstart' in window || navigator.msMaxTouchPoints;
      if (!touchTest) {
        document.documentElement.className = document.documentElement.className.replace(/touch\-styles/g, '');
      }
    })();</script>
  </head>
  <body id="item-5c56de0f53450aaf3bc91afe" class="tweak-header-background-color-on tweak-main-blocks-full-bleed tweak-underline-body-links tweak-ui-icon-weight-light tweak-navigation-link-spacing-small  tweak-site-branding-borders-none tweak-show-site-tagline tweak-site-branding-layout-inline tweak-show-search-in-header tweak-show-social-in-header tweak-user-account-link-position-with-nav tweak-quote-block-alignment-center tweak-blog-list-grid-alignment-top tweak-blog-list-max-width-wide  tweak-crop-images-none   tweak-show-excerpt-on-blog-list   tweak-blog-text-alignment-left tweak-blog-promoted-meta-categories tweak-blog-date-style-above-title tweak-blog-show-divider  tweak-blog-item-banner-image-width-normal  tweak-show-blog-item-author-profile-hide  tweak-template-social-icon-style-regular    event-show-past-events event-thumbnails event-thumbnail-size-11-square event-date-label event-date-label-time event-list-show-cats event-list-date event-list-time event-list-address event-list-icalgcal-links event-list-like-and-share-buttons event-icalgcal-links event-like-and-share-buttons event-excerpts event-list-cta-button event-item-back-link    gallery-design-slideshow aspect-ratio-auto lightbox-style-dark gallery-navigation-thumbnails gallery-info-overlay-always-show gallery-aspect-ratio-169-widescreen gallery-arrow-style-circular gallery-transitions-fade gallery-show-arrows gallery-auto-crop   tweak-product-list-image-aspect-ratio-11-square tweak-product-list-item-hover-behavior-fade tweak-product-list-meta-position-under tweak-product-list-mobile-meta-position-under tweak-product-list-meta-alignment-under-center tweak-product-list-meta-alignment-overlay-center-center tweak-product-list-show-title tweak-product-list-show-price tweak-product-list-filter-display-left-side tweak-product-list-filter-alignment-left tweak-product-item-nav-show-breadcrumb-and-pagination tweak-product-item-nav-pagination-style-previousnext tweak-product-item-nav-breadcrumb-alignment-left tweak-product-item-nav-pagination-alignment-split tweak-product-item-gallery-position-right tweak-product-item-gallery-design-stacked tweak-product-item-gallery-aspect-ratio-11-square tweak-product-item-gallery-thumbnail-alignment-left tweak-product-item-details-alignment-left tweak-product-item-details-show-title tweak-product-item-details-show-price tweak-product-item-details-show-excerpt tweak-product-item-details-excerpt-position-below-add-to-cart-button tweak-product-item-details-show-share-buttons tweak-product-item-details-show-variants tweak-product-item-details-show-quantity tweak-product-item-details-options-style-rounded tweak-product-item-details-show-add-to-cart-button tweak-product-item-details-add-to-cart-button-style-solid tweak-product-item-details-add-to-cart-button-shape-rounded tweak-product-item-details-add-to-cart-button-padding-small tweak-product-item-image-zoom-enabled tweak-product-item-image-zoom-behavior-click tweak-product-item-lightbox-enabled tweak-product-badge-style-circle tweak-product-badge-position-top-right tweak-product-badge-inset-floating newsletter-style-dark hide-opentable-icons opentable-style-dark small-button-style-outline small-button-shape-pill medium-button-style-outline medium-button-shape-pill large-button-style-outline large-button-shape-pill image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-outline button-corner-style-pill tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light tweak-share-buttons-style-icon-only tweak-share-buttons-icons-show  tweak-share-buttons-counts-show  tweak-share-buttons-standard-background-color native-currency-code-usd view-item collection-type-blog collection-590b4514db29d6088905acb0 collection-layout-default mobile-style-available" data-controller="SyncHeader, AddScrollingClass, HeaderScroll, BodyMinHeight">
    <div class="nav-close-overlay">

    </div>
    <div class="nav-close-toggle-wrapper" id="navCloseToggleWrapper">
      <a class="nav-toggle-close-label responsive-position--left" id="navCloseToggle" data-controller="NavToggle">
        <svg class="Icon Icon--close close-icon" viewBox="0 0 18 18">
          <use xlink:href="/assets/ui-icons.svg#close-icon-line"></use>
        </svg>
      </a>
    </div>
    <div id="sideTrayWrapper" class="sidetray-wrapper">
      <div class="main-nav-wrapper responsive-padding--top responsive-padding--bottom" data-controller="NavOverflow">
        <div class="nav-blocks-wrapper">
          
<nav id="mainNavigation" class="main-navigation" role="navigation" data-content-field="navigation">
  

    
      

        
        <div class="nav-link--collection nav-link--active nav-link--homepage" id="id-590b4514db29d6088905acb0">
          <a href="/">
            <span>All posts</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-59b6ab1b8fd4d267470c91c7">
          <a href="/categories">
            <span>Categories</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-59823ecac534a526009cda28">
          <a href="/podcast">
            <span>Podcast</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-5b8596fe0ebbe86e1ff0c352">
          <a href="/newsletter">
            <span>Newsletter</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-59aacc28914e6b7e9f7c6380">
          <a href="/subscribe">
            <span>Subscribe</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-5c34b6d840ec9a9a46a03348">
          <a href="/basics">
            <span>Basics</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-5b15b0c5758d4658e64816ef">
          <a href="/daily-wwdc">
            <span>WWDC 2018</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-59f0c84190badea3e7ab8509">
          <a href="/meta">
            <span>Meta</span>
          </a>
        </div>
        

      

    

  

    
      

        
        <div class="nav-link--collection" id="id-5970cb08c534a5793b9eeae9">
          <a href="/talks">
            <span>Talks</span>
          </a>
        </div>
        

      

    

  

    
      
      <div class="nav-link--external">
        <a href="https://twitter.com/johnsundell" target="_blank">
          <span>Twitter</span>
        </a>
      </div>
      

    

  
  
</nav>


          <div class="sqs-layout sqs-grid-1 columns-1" data-layout-label="Nav Blocks" data-type="block-field" data-updated-on="1493920974490" id="navBlocks"><div class="row sqs-row"><div class="col sqs-col-1 span-1"></div></div></div>
        </div>
      </div><!--
      --><div class="sidetray-blocks responsive-padding--top responsive-padding--bottom" data-controller="SidetrayBlocksOverflow">
        <div class="sidetray-blocks-wrapper">
          <div class="sqs-layout sqs-grid-1 columns-1 empty" data-layout-label="Sidetray Blocks" data-type="block-field" data-updated-on="1493920544994" id="sideTrayBlocks"><div class="row sqs-row"><div class="col sqs-col-1 span-1"></div></div></div>
        </div>
      </div>
    </div>

    <form class="header-search-form" id="headerSearch" action="/search" method="get">
      <input class="header-search-form-input" name="q" placeholder="Search" type="text" spellcheck="false" value="" autocomplete="off">
    </form>

    

    <div id="site" class="site-container clearfix">

      <div class="sqs-announcement-bar-dropzone header-announcement-wrapper responsive-padding--left responsive-padding--right" id="headerAnnouncementWrapper">
        <header id="header" class="site-header loading" role="banner">
          <a class="nav-toggle-label flex-item" id="navToggle" data-controller="NavToggle">
            <svg class="Icon Icon--hamburger nav-toggle-label-icon" viewBox="0 0 26 18">
              <use xlink:href="/assets/ui-icons.svg#hamburger-icon--even"></use>
            </svg>
          </a>

          <div class="logo-wrapper flex-item">
          
            
              <div class="site-title branding" data-content-field="site-title"><a href="/"><span class="site-title-text">Swift by Sundell</span> <span class="site-tagline">A weekly blog about Swift development</span></a></div>
            
          
          </div>

          

          <div class="header-special flex-item">
            <div class="social-search-wrapper">
              <div class="social-ellipsis" id="socialEllipsis" data-controller="SocialToggle">
                <svg class="ellipsis-icon" viewBox="0 0 100 24">
                  <use xlink:href="/assets/ui-icons.svg#ellipsis-icon"></use>
                </svg>
                <svg class="social-close-icon Icon Icon--close" viewBox="0 0 18 18">
                  <use xlink:href="/assets/ui-icons.svg#close-icon-line"></use>
                </svg>
              </div><!--
               
             --><a href="/search" rel="search" class="header-search" data-controller="SearchToggle">
                <svg class="Icon Icon--search search-icon" viewBox="0 0 20 20" shape-rendering="geometricPrecision">
                  <use xlink:href="/assets/ui-icons.svg#search-icon"></use>
                </svg>
                <svg class="Icon Icon--close search-close-icon" viewBox="0 0 18 18">
                  <use xlink:href="/assets/ui-icons.svg#close-icon-line"></use>
                </svg>
               </a>
              </div><!--
              --><!--
              -->
          </div>
        </header>
      </div>

      <main id="page" class="site-page loading responsive-padding--left responsive-padding--right site-page--blog-item" role="main" data-content-field="main-content" data-controller="FadeInContent">

        <div class="blog-wrapper" data-content-field="main-content" data-item-id="5c56de0f53450aaf3bc91afe">
  
  <div class="blog-item-title blog-item-title--top">
    <time class="dt-published date-callout" datetime="2019-02-03" pubdate>
      <div class="date-wrapper">
        <span class="month">Feb </span><span class="day"> 3</span>
      </div>
    </time>
    <h2 class="entry-title entry-title--large p-name" data-content-field="title"><time class="dt-published date-highlight" datetime="2019-02-03" pubdate>Feb  3 </time>Task-based concurrency in Swift</h2>

    <div class="meta-wrapper">
      <div class="blog-meta-item blog-meta-author"><a href="/?author=590b40b317bffc01e6729b6b" class="blog-author-name">John Sundell</a> </div><!--

      -->
    </div>
  </div>
  

  <div class="main-content blog-view-item clearfix">
    <input id="show-comments" type="checkbox" />
    <article id="article-5c56de0f53450aaf3bc91afe" class="entry--item h-entry clearfix hentry author-john-sundell post-type-text">
      
      
      <div class="blog-item-content-wrapper" data-controller="BlogProgressBar">
        
        <div class="pie-wrapper" id="pieWrapper">
          <div class="pie pie--left" id="pieLeft"></div>
          <div class="pie pie--right hide" id="pieRight"></div>
          <div class="mask mask--right hide" id="pieMask"></div>
          <div class="mask mask--left" id="maskLeft"></div>
        </div>
        <div class="blog-item-content e-content"><div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1549661477082" id="item-5c56de0f53450aaf3bc91afe"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_5_0_1_1549196508559_1637"><div class="sqs-block-content"><p>Just like sequential code, concurrent code can come in many different shapes and forms. Depending on what we’re trying to achieve — whether that’s asynchronously fetching a piece of data, loading heavy files from disk, or performing a group of related operations — the abstraction that’ll prove to be the best fit might vary quite a lot from use case to use case.</p>
<p>One such concurrent programming abstraction is <em>Tasks</em>. While tasks may at first seem very similar to both <em><a href="https://www.swiftbysundell.com/posts/under-the-hood-of-futures-and-promises-in-swift">Futures &amp; Promises</a></em> and Foundation’s <code>Operation</code> API, there are some distinct differences in how they behave and what level of control they give to the API user.</p>
<p>This week, let’s take a look at some of those differences, and some scenarios in which tasks can become really useful.</p>
<h2 id="the-task-at-hand">The task at hand</h2>
<p>Let’s say that we’re building a social networking app, and that we offer our users the option to attach both photos and videos when publishing a post. Currently, whenever the user hits <em>“Publish”</em> — we call the following function, which uploads all attached media and also uploads the data for the post itself, like this:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">func</span> publish(<span class="keyword">_</span> post: <span class="type">Post</span>) {
    <span class="keyword">for</span> photo <span class="keyword">in</span> post.<span class="property">photos</span> {
        <span class="call">upload</span>(photo)
    }

    <span class="keyword">for</span> video <span class="keyword">in</span> post.<span class="property">videos</span> {
        <span class="call">upload</span>(video)
    }

    <span class="call">upload</span>(post)
}</code></pre>

<p>While the above code is very simple, there’s a few problems with it. First, there’s no way for us to get notified whenever the publishing of a post was finished. We also don’t do any kind of error handling, which means that if a photo or video failed to upload — we’ll just continue uploading the post data anyway, which isn’t ideal.</p>
<p>There’s quite a number of ways that we could go about solving the above problem. One idea might be to use the built-in <code>Operation</code> and <code>OperationQueue</code> types to sequentially execute all operations — but that’d require us to either make our actual networking code <em>synchronous</em>, or to subclass <code>Operation</code> to create a very custom solution. Both of those alternatives are valid, but can feel a bit ”<em>heavy-handed</em>”, since they’ll require quite major changes to our original code.</p>
<p>Luckily, it turns out that all we have to do to gain the control we need is to step one level deeper into the stack, and use the framework that <code>Operation</code> and <code>OperationQueue</code> are based on — <em><a href="https://www.swiftbysundell.com/basics/grand-central-dispatch">Grand Central Dispatch</a></em>.</p>
<p>Like we took a look at in <em><a href="https://www.swiftbysundell.com/posts/a-deep-dive-into-grand-central-dispatch-in-swift">“A deep dive into Grand Central Dispatch in Swift”</a></em>, GCD allows us to quite easily group together a bunch of operations, and to get notified when all of them have completed. To make that happen, we’ll make a slight tweak to our <code>upload</code> functions from before — so that they now offer us a way to observe their completion using a closure, and make balanced calls to <code>enter</code> and <code>leave</code> on a <code>DispatchGroup</code> in order to get notified when all media uploads were finished:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">func</span> publish(<span class="keyword">_</span> post: <span class="type">Post</span>) {
    <span class="keyword">let</span> group = <span class="type">DispatchGroup</span>()

    <span class="keyword">for</span> photo <span class="keyword">in</span> post.<span class="property">photos</span> {
        group.<span class="call">enter</span>()

        <span class="call">upload</span>(photo) {
            group.<span class="call">leave</span>()
        }
    }

    <span class="keyword">for</span> video <span class="keyword">in</span> post.<span class="property">videos</span> {
        group.<span class="call">enter</span>()

        <span class="call">upload</span>(video) {
            group.<span class="call">leave</span>()
        }
    }

    <span class="comment">//</span> <span class="comment">Calling</span> <span class="comment">‘notify’</span> <span class="comment">allows</span> <span class="comment">us</span> <span class="comment">to</span> <span class="comment">observe</span> <span class="comment">whenever</span> <span class="comment">the</span> <span class="comment">whole</span>
    <span class="comment">//</span> <span class="comment">group</span> <span class="comment">was</span> <span class="comment">finished</span> <span class="comment">using</span> <span class="comment">a</span> <span class="comment">closure.</span>
    group.<span class="call">notify</span>(queue: .<span class="dotAccess">main</span>) {
        <span class="call">upload</span>(post)
    }
}</code></pre>

<p>The above works really well, and leaves us with pretty clean-looking code. But we still haven’t addressed the lack of error handling — as we’ll still blindly upload the post, whether or not the media uploads were successfully completed.</p>
<p>To fix that, let’s add an optional <code>Error</code> variable that we’ll use to keep track of any error that occurred. We’ll make another tweak to our <code>upload</code> functions, to have them pass an optional <code>Error</code> argument to their completion handlers, and use that to capture the first error that was encountered — like this:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">func</span> publish(<span class="keyword">_</span> post: <span class="type">Post</span>) {
    <span class="keyword">let</span> group = <span class="type">DispatchGroup</span>()
    <span class="keyword">var</span> anyError: <span class="type">Error</span>?

    <span class="keyword">for</span> photo <span class="keyword">in</span> post.<span class="property">photos</span> {
        group.<span class="call">enter</span>()

        <span class="call">upload</span>(photo) { error <span class="keyword">in</span>
            anyError = anyError ?? error
            group.<span class="call">leave</span>()
        }
    }

    <span class="keyword">for</span> video <span class="keyword">in</span> post.<span class="property">videos</span> {
        group.<span class="call">enter</span>()

        <span class="call">upload</span>(video) { error <span class="keyword">in</span>
            anyError = anyError ?? error
            group.<span class="call">leave</span>()
        }
    }

    group.<span class="call">notify</span>(queue: .<span class="dotAccess">main</span>) {
        <span class="comment">//</span> <span class="comment">If</span> <span class="comment">an</span> <span class="comment">error</span> <span class="comment">was</span> <span class="comment">encountered</span> <span class="comment">while</span> <span class="comment">uploading</span> <span class="comment">the</span>
        <span class="comment">//</span> <span class="comment">post’s</span> <span class="comment">media,</span> <span class="comment">we’ll</span> <span class="comment">call</span> <span class="comment">an</span> <span class="comment">error</span> <span class="comment">handling</span> <span class="comment">function</span>
        <span class="comment">//</span> <span class="comment">instead</span> <span class="comment">of</span> <span class="comment">proceeding</span> <span class="comment">with</span> <span class="comment">the</span> <span class="comment">post</span> <span class="comment">data</span> <span class="comment">upload.</span>
        <span class="keyword">if</span> <span class="keyword">let</span> error = anyError {
            <span class="keyword">return</span> <span class="call">handle</span>(error)
        }

        <span class="call">upload</span>(post)
    }
}</code></pre>

<p>We’ve now fixed all <em>correctness</em> issues with our original piece of code, but in the process of doing that we’ve also made it much more complicated and harder to read. Our new solution is also quite <em>boilerplate-heavy</em> (with a local error variable and dispatch group calls that need to be kept track of), which might not be a problem here, but as soon as we start moving more of our asynchronous code to use this pattern — things can get much harder to maintain quite quickly.</p>
<h2 id="it-s-abstraction-time-">It’s abstraction time!</h2>
<p>Let’s see if we can make the above kind of operations easier to work with by introducing a thin, task-based layer of abstraction on top of Grand Central Dispatch.</p>
<p>We’ll start by creating a type called <code>Task</code>, which will essentially be just a wrapper around a closure that’ll get access to <code>Controller</code> for controlling the flow of the task:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">struct</span> Task {
    <span class="keyword">typealias</span> Closure = (<span class="type">Controller</span>) -&gt; <span class="type">Void</span>

    <span class="keyword">private</span> <span class="keyword">let</span> closure: <span class="type">Closure</span>

    <span class="keyword">init</span>(closure: <span class="keyword">@escaping</span> <span class="type">Closure</span>) {
        <span class="keyword">self</span>.<span class="property">closure</span> = closure
    }
}</code></pre>

<p>The <code>Controller</code> type, in turn, provides methods for either <em>finishing</em> or <em>failing</em> the task that it’s associated with, and does so by calling a handler to report the <code>Outcome</code> of the task:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">struct</span> Controller {
        <span class="keyword">fileprivate</span> <span class="keyword">let</span> queue: <span class="type">DispatchQueue</span>
        <span class="keyword">fileprivate</span> <span class="keyword">let</span> handler: (<span class="type">Outcome</span>) -&gt; <span class="type">Void</span>

        <span class="keyword">func</span> finish() {
            <span class="call">handler</span>(.<span class="dotAccess">success</span>)
        }

        <span class="keyword">func</span> fail(with error: <span class="type">Error</span>) {
            <span class="call">handler</span>(.<span class="dotAccess">failure</span>(error))
        }
    }
}</code></pre>

<p>Just like the code above shows, <code>Outcome</code> has two cases — <code>.success</code> and <code>.failure</code> — making it very similar to a <a href="https://www.swiftbysundell.com/posts/the-power-of-result-types-in-swift"><code>Result</code> type</a> with a generic type <code>Void</code>. In fact, we could choose either to implement <code>Outcome</code> as its own enum type, or simply use one of the techniques from <em><a href="https://www.swiftbysundell.com/posts/the-power-of-type-aliases-in-swift">“The power of type aliases in Swift”</a></em> and make it a <em>generic shorthand</em> for <code>Result&lt;Void&gt;</code>:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">enum</span> Outcome {
        <span class="keyword">case</span> success
        <span class="keyword">case</span> failure(<span class="type">Error</span>)
    }
}

<span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">typealias</span> Outcome = <span class="type">Result</span>&lt;<span class="type">Void</span>&gt;
}</code></pre>

<p>Finally, we need a way to actually perform the tasks that we’ll define. For that, let’s add a <code>perform</code> method on <code>Task</code>, that’ll either take an explicit <code>DispatchQueue</code> to perform the task on — or simply retrieve any global one — and a handler to be called once the task finished executing. Internally, we’ll then use the given <code>DispatchQueue</code> to execute the task asynchronously, by creating a controller and passing it into the task’s closure — like this:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">func</span> perform(on queue: <span class="type">DispatchQueue</span> = .<span class="dotAccess">global</span>(),
                 then handler: <span class="keyword">@escaping</span> (<span class="type">Outcome</span>) -&gt; <span class="type">Void</span>) {
        queue.<span class="call">async</span> {
            <span class="keyword">let</span> controller = <span class="type">Controller</span>(
                queue: queue,
                handler: handler
            )

            <span class="keyword">self</span>.<span class="call">closure</span>(controller)
        }
    }
}</code></pre>

<p>With the above in place, the initial version of our <code>Task</code> API is finished, and we’re ready to take it for a spin. Let’s start by defining a task that’ll replace our photo uploading function from before — which calls into an underlying <code>Uploader</code> class, and then uses the task’s <code>Controller</code> to notify us of the outcome:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">static</span> <span class="keyword">func</span> uploading(<span class="keyword">_</span> photo: <span class="type">Photo</span>,
                          using uploader: <span class="type">Uploader</span>) -&gt; <span class="type">Task</span> {
        <span class="keyword">return</span> <span class="type">Task</span> { controller <span class="keyword">in</span>
            uploader.<span class="call">upload</span>(photo.<span class="property">data</span>, to: photo.<span class="property">url</span>) { error <span class="keyword">in</span>
                <span class="keyword">if</span> <span class="keyword">let</span> error = error {
                    controller.<span class="call">fail</span>(with: error)
                } <span class="keyword">else</span> {
                    controller.<span class="call">finish</span>()
                }
            }
        }
    }
}</code></pre>

<p>With our first task now available — let’s see what using it looks like at the call site:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">for</span> photo <span class="keyword">in</span> photos {
    <span class="keyword">let</span> task = <span class="type">Task</span>.<span class="call">uploading</span>(photo, using: uploader)

    task.<span class="call">perform</span> { outcome <span class="keyword">in</span>
        <span class="comment">//</span> <span class="comment">Handle</span> <span class="comment">outcome</span>
    }
}</code></pre>

<p>Pretty cool! 😎 However, where the power of tasks really starts to shine is when we start <em>grouping</em> and <em>sequencing</em> them, which’ll let us solve our original problem in a very elegant way. So let’s keep going!</p>
<h2 id="grouping">Grouping</h2>
<p>Earlier, we used a <code>DispatchGroup</code> that was entered and left in order to keep track of when a group of operations were finished, so let’s port that logic into our new task system. To do that, we’ll add a static method on <code>Task</code> that’ll take an array of tasks and group them together. Under the hood, we’ll still use the exact same dispatch group logic as before — but now wrapped in a much nicer API:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">static</span> <span class="keyword">func</span> group(<span class="keyword">_</span> tasks: [<span class="type">Task</span>]) -&gt; <span class="type">Task</span> {
        <span class="keyword">return</span> <span class="type">Task</span> { controller <span class="keyword">in</span>
            <span class="keyword">let</span> group = <span class="type">DispatchGroup</span>()

            <span class="comment">//</span> <span class="comment">To</span> <span class="comment">avoid</span> <span class="comment">race</span> <span class="comment">conditions</span> <span class="comment">with</span> <span class="comment">errors,</span> <span class="comment">we</span> <span class="comment">set</span> <span class="comment">up</span> <span class="comment">a</span> <span class="comment">private</span>
            <span class="comment">//</span> <span class="comment">queue</span> <span class="comment">to</span> <span class="comment">sync</span> <span class="comment">all</span> <span class="comment">assignments</span> <span class="comment">to</span> <span class="comment">our</span> <span class="comment">error</span> <span class="comment">variable</span>
            <span class="keyword">let</span> errorSyncQueue = <span class="type">DispatchQueue</span>(label: <span class="string">"Task.ErrorSync"</span>)
            <span class="keyword">var</span> anyError: <span class="type">Error</span>?

            <span class="keyword">for</span> task <span class="keyword">in</span> tasks {
                group.<span class="call">enter</span>()

                <span class="comment">//</span> <span class="comment">It’s</span> <span class="comment">important</span> <span class="comment">to</span> <span class="comment">make</span> <span class="comment">the</span> <span class="comment">sub-tasks</span> <span class="comment">execute</span>
                <span class="comment">//</span> <span class="comment">on</span> <span class="comment">the</span> <span class="comment">same</span> <span class="comment">DispatchQueue</span> <span class="comment">as</span> <span class="comment">the</span> <span class="comment">group,</span> <span class="comment">since</span>
                <span class="comment">//</span> <span class="comment">we</span> <span class="comment">might</span> <span class="comment">cause</span> <span class="comment">unexpected</span> <span class="comment">threading</span> <span class="comment">issues</span> <span class="comment">otherwise.</span>
                task.<span class="call">perform</span>(on: controller.<span class="property">queue</span>) { outcome <span class="keyword">in</span>
                    <span class="keyword">switch</span> outcome {
                    <span class="keyword">case</span> .<span class="dotAccess">success</span>:
                        <span class="keyword">break</span>
                    <span class="keyword">case</span> .<span class="dotAccess">failure</span>(<span class="keyword">let</span> error):
                        errorSyncQueue.<span class="call">sync</span> {
                            anyError = anyError ?? error
                        }
                    }

                    group.<span class="call">leave</span>()
                }
            }

            group.<span class="call">notify</span>(queue: controller.<span class="property">queue</span>) {
                <span class="keyword">if</span> <span class="keyword">let</span> error = anyError {
                    controller.<span class="call">fail</span>(with: error)
                } <span class="keyword">else</span> {
                    controller.<span class="call">finish</span>()
                }
            }
        }
    }
}</code></pre>

<p>With the above in place, we can heavily simplify our media uploading code from before. All we now have to do is to map each piece of media into a <code>Task</code>, and then pass a combined array of those tasks into our new <code>group</code> API, to group them all into a single task — like this:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">let</span> photoTasks = post.<span class="property">photos</span>.<span class="call">map</span> { photo <span class="keyword">in</span>
    <span class="keyword">return</span> <span class="type">Task</span>.<span class="call">uploading</span>(photo, using: uploader)
}

<span class="keyword">let</span> videoTasks = post.<span class="property">videos</span>.<span class="call">map</span> { video <span class="keyword">in</span>
    <span class="keyword">return</span> <span class="type">Task</span>.<span class="call">uploading</span>(video, using: uploader)
}

<span class="keyword">let</span> mediaGroup = <span class="type">Task</span>.<span class="call">group</span>(photoTasks + videoTasks)</code></pre>

<p>Groups are great for when we don’t rely on the order of completion of our grouped tasks — but that’s not always the case. Going back to our original problem of not uploading the data for a post until we’re sure that all media was successfully uploaded — that’s one such case. What we’d ideally like is to be able to chain, or <em>sequence</em>, our media uploading operations with the one that finishes the post upload.</p>
<p>Let’s take a look at how we can extend <code>Task</code> to support that.</p>
<h2 id="sequencing">Sequencing</h2>
<p>Rather than using <code>DispatchGroup</code> (which doesn’t have any opinion about the order of our operations), let’s implement sequencing by keeping track of the current task’s index and then continuously executing the next task once the previous one was finished. Once we’ve reached the end of our list of tasks, we’ll consider the sequence completed:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">extension</span> <span class="type">Task</span> {
    <span class="keyword">static</span> <span class="keyword">func</span> sequence(<span class="keyword">_</span> tasks: [<span class="type">Task</span>]) -&gt; <span class="type">Task</span> {
        <span class="keyword">var</span> index = <span class="number">0</span>

        <span class="keyword">func</span> performNext(using controller: <span class="type">Controller</span>) {
            <span class="keyword">guard</span> index &lt; tasks.<span class="property">count</span> <span class="keyword">else</span> {
                <span class="comment">//</span> <span class="comment">We’ve</span> <span class="comment">reached</span> <span class="comment">the</span> <span class="comment">end</span> <span class="comment">of</span> <span class="comment">our</span> <span class="comment">array</span> <span class="comment">of</span> <span class="comment">tasks,</span>
                <span class="comment">//</span> <span class="comment">time</span> <span class="comment">to</span> <span class="comment">finish</span> <span class="comment">the</span> <span class="comment">sequence.</span>
                controller.<span class="call">finish</span>()
                <span class="keyword">return</span>
            }

            <span class="keyword">let</span> task = tasks[index]
            index += <span class="number">1</span>

            task.<span class="call">perform</span>(on: controller.<span class="property">queue</span>) { outcome <span class="keyword">in</span>
                <span class="keyword">switch</span> outcome {
                <span class="keyword">case</span> .<span class="dotAccess">success</span>:
                    <span class="call">performNext</span>(using: controller)
                <span class="keyword">case</span> .<span class="dotAccess">failure</span>(<span class="keyword">let</span> error):
                    <span class="comment">//</span> <span class="comment">As</span> <span class="comment">soon</span> <span class="comment">as</span> <span class="comment">an</span> <span class="comment">error</span> <span class="comment">was</span> <span class="comment">occurred,</span> <span class="comment">we’ll</span>
                    <span class="comment">//</span> <span class="comment">fail</span> <span class="comment">the</span> <span class="comment">entire</span> <span class="comment">sequence.</span>
                    controller.<span class="call">fail</span>(with: error)
                }
            }
        }

        <span class="keyword">return</span> <span class="type">Task</span>(closure: performNext)
    }
}</code></pre>

<p><em>The reason we don’t simply use a serial <code>DispatchQueue</code> to implement sequencing, is because we can’t assume that our sequence will always be dispatched on a serial queue — the API user can choose to perform it on any kind of queue.</em></p>
<p>Above we make use of the fact that Swift supports both <em><a href="https://www.swiftbysundell.com/posts/first-class-functions-in-swift">first class functions</a></em>, and inline function definitions — since we’re passing our <code>performNext</code> function as a closure to create a <code>Task</code> for our sequence.</p>
<p>And that’s it — believe it or not, but we’ve actually just built a complete Task-based concurrency system — from scratch! 😀</p>
<h2 id="putting-all-the-pieces-together">Putting all the pieces together</h2>
<p>With all the pieces in place, let’s finally update our original post publishing code, to now make full use of everything our new system has to offer. Instead of having to keep track of errors, or encounter bugs due to the unpredictable nature of network calls, we can now simply form a sequence by combining a group of our media upload operations with a post uploading task — like this:</p>
<pre data-preserve-html-node="true" class="splash"><code data-preserve-html-node="true"><span class="keyword">func</span> publish(<span class="keyword">_</span> post: <span class="type">Post</span>,
             then handler: <span class="keyword">@escaping</span> (<span class="type">Outcome</span>) -&gt; <span class="type">Void</span>) {
    <span class="keyword">let</span> photoTasks = post.<span class="property">photos</span>.<span class="call">map</span> { photo <span class="keyword">in</span>
        <span class="keyword">return</span> <span class="type">Task</span>.<span class="call">uploading</span>(photo, using: uploader)
    }

    <span class="keyword">let</span> videoTasks = post.<span class="property">videos</span>.<span class="call">map</span> { video <span class="keyword">in</span>
        <span class="keyword">return</span> <span class="type">Task</span>.<span class="call">uploading</span>(video, using: uploader)
    }

    <span class="keyword">let</span> sequence = <span class="type">Task</span>.<span class="property">sequence</span>([
        .<span class="dotAccess">group</span>(photoTasks + videoTasks),
        .<span class="dotAccess">uploading</span>(post, using: uploader)
    ])

    sequence.<span class="call">perform</span>(then: handler)
}</code></pre>

<p>The beauty of the above solution, is that everything is executing fully concurrently — using dispatch queues — under the hood, but as an API user, all we have to do is to create a few tasks and tell the system how we want to combine them. And since our abstraction is so thin, if we ever encounter a problem or unexpected behavior, we just need to step one level down in order to debug things.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Tasks can be a great way to abstract heavily concurrent code, that either should execute with as much parallelism as possible, or await the completion of previous tasks before moving ahead. They essentially provide a way to create a simple, thin, layer on top of Grand Central Dispatch — which lets us leverage all of its power in a really nice way.</p>
<p>Like mentioned earlier in this article, there are of course many other ways that concurrency can be implemented or used in Swift. <a href="https://www.swiftbysundell.com/posts/under-the-hood-of-futures-and-promises-in-swift">Futures &amp; promises</a> make it easy to hide much of what kind of concurrency is going on, at the cost of a slightly lower amount of control — while frameworks like <a href="https://github.com/ReactiveX/RxSwift">RxSwift</a> make it possible to build much more complex chains of execution, but using a much heavier abstraction.</p>
<p>My advice is to try many different kinds of concurrent programming in Swift — to see which one (or multiple ones) that fits you, your team, and your project the best. Hopefully this article has given you a bit of insight into <em>one way</em> of implementing tasks in Swift, and how tasks might compare to other solutions commonly used in the community. And if that’s the case — then I consider my mission accomplished 😀.</p>
<p>Feel free to <a href="https://twitter.com/johnsundell">find me on Twitter</a>, where you can ask me questions, or let me know what you thought about this article, and tasks in general.</p>
<p>Thanks for reading! 🚀</p>
</div></div></div></div></div></div>

        <footer class="blog-item-footer">

          <div class="footer-meta">
          
            <div class="blog-meta-item blog-meta-author"><a href="/?author=590b40b317bffc01e6729b6b" class="blog-author-name">John Sundell</a></div>
          

          

          
          </div>

          <div class="blog-item-actions blog-item-actions--footer">
            <div class="blog-item-actions-wrapper">
              <div class="Share sqs-share-buttons" data-item-identifier="5c56de0f53450aaf3bc91afe" data-item-path="posts/task-based-concurrency-in-swift">

  <div class="Share-buttons">

    <!--

      Facebook

    --><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.swiftbysundell.com%2Fposts%2Ftask-based-concurrency-in-swift" class="Share-buttons-item Share-buttons-item--social" target="_blank" data-service="facebook">
        <svg class="Share-buttons-item-icon" viewBox="0 0 64 64">
          <use xlink:href="/universal/svg/social-accounts.svg#facebook-icon"></use>
        </svg><span class="Share-buttons-item-label">Facebook</span><span class="Share-buttons-item-count">0</span>
      </a><!--

      Twitter

    --><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.swiftbysundell.com%2Fposts%2Ftask-based-concurrency-in-swift&text=Just+like+sequential+code%2C+concurrent+code+can+come+in+many+different+shapes+..." class="Share-buttons-item Share-buttons-item--social" target="_blank" data-service="twitter">
        <svg class="Share-buttons-item-icon" viewBox="0 0 64 64">
          <use xlink:href="/universal/svg/social-accounts.svg#twitter-icon"></use>
        </svg><span class="Share-buttons-item-label">Twitter</span>
      </a><!--

      Simple Like

    --><a href="#" class="Share-buttons-item Share-buttons-item--like" data-item-identifier="5c56de0f53450aaf3bc91afe" data-like-count="0" data-service="squarespace-like">
        <svg class="Share-buttons-item-icon" viewBox="0 0 64 64">
          <g class="svg-icon">
            <path d="M39.9,37.8c-7.3,4.8-7.7,6.9-7.9,7.8c-0.2-0.9-0.6-3-7.9-7.8c-16-10.6,1.4-25.4,7.9-11.7C38.5,12.4,55.9,27.3,39.9,37.8z"/>
          </g>
        </svg><span class="Share-buttons-item-label"><span class="Share-buttons-item-label-count">0</span> Likes</span>
      </a>
    

  </div>

</div>
            </div>
          </div>

          
            <div class="blog-item-author-profile blog-item-author-profile--footer responsive-margin--top">
              
  <a href="/?author=590b40b317bffc01e6729b6b" class="author-avatar content-fill" data-controller="SimpleImageLoad" data-tweaks="tweak-show-blog-item-author-profile">
    <img class="author-avatar-image" data-src="https://static1.squarespace.com/static/images/592c4cbdb8a79bae6fffae5b/100w" data-image="https://static1.squarespace.com/static/images/592c4cbdb8a79bae6fffae5b/100w" data-image-focal-point="0.5,0.5" data-load="false">
  </a>

<div class="author-name"><a href="/?author=590b40b317bffc01e6729b6b">John Sundell</a></div>



            </div>
          

        </footer>

        <div class="blog-item-injection"><style>
.sxs-footer {
    display: grid;
    grid-template-columns: 25% 25% 25% 25%;
  	margin-top: 35px;
}

.sxs-footer .sxs-button {
    display: flex;
    align-items: center;
    color: #fff !important;
    background-color: #444;
    text-align: center;
    border-radius: 15px;
    text-decoration: none !important;
    margin-right: 15px;
    padding: 8px;
  	line-height: 1.1;
}

.sxs-footer .sxs-button:hover {
    background-color: #666;
}

.sxs-footer .sxs-button:last-child {
    margin-right: 0;
}

.sxs-footer .sxs-button .sxs-wrapper {
    flex: 1;
}

.sxs-footer .sxs-button .sxs-icon {
    display: block;
    margin-bottom: 5px;
  	margin-top: 3px;
}

.sxs-footer .sxs-button .sxs-text {
    font-size: 12px;
    font-weight: bold;
    text-transform: uppercase;
}
  
@media screen and (max-width: 500px) {
    .sxs-footer {
        grid-template-columns: 50% 50%;
    }
  
  	.sxs-footer .sxs-button:nth-child(2) {
        margin-right: 0;
    }

    .sxs-footer .sxs-button:nth-child(3),
    .sxs-footer .sxs-button:nth-child(4) {
        margin-top: 15px;
    }
}
</style>

<style>
.sxs-ad {
	position: relative;
    padding: 12px 16px;
    border: 1px solid #ee4731;
    border-radius: 10px;
    margin-bottom: 30px !important;
  	margin-top: 30px;
}

.sxs-ad-prefix {
	position: absolute;
    left: 20px;
    top: -15px;
    text-transform: uppercase;
    font-size: 12px;
    font-weight: bold;
    background-color: #fff;
    display: inline-block;
    padding: 0 4px;
    color: #ee4731;
}

.dark-theme .sxs-ad-prefix {
    background-color: #222;
}

.black-theme .sxs-ad-prefix {
    background-color: #000;
}

.sxs-ad-title {
    display: block;
    font-family: "Source Sans Pro";
    font-weight: 600;
    font-size: 25px;
    margin-bottom: 6px;
}

.sxs-ad-highlight {
	color: #ee4731;
}

.sxs-ad a {
	text-decoration: underline;
}
  
.sxs-ad .sxs-ad-footer {
    color: #ee4731 !important;
    position: absolute;
    font-size: 10px;
    right: 0px;
  	top: 100%;
  	margin-top: 8px;
    text-decoration: none !important;
	line-height: 1em;
}
  
.sxs-ad .sxs-ad-footer a {
  	color: #ee4731 !important;
}
</style>

<style> 
.blog-author-name {
    display: none !important; 
}
  
.sqs-block-markdown h2 {
    font-weight: 600 !important;
}
  
.sqs-block-markdown a {
    text-decoration: underline !important;
}
  
.sqs-block-markdown li {
    margin-bottom: 5px !important;
}
  
.language-swift, .language-bash, .language-yml {
    font-size: 15px !important;
}
  
@media screen and (min-width: 640px) {
    .sqs-block-markdown {
      	width: 845px !important;
        max-width: 90% !important;
    }
}
  
.recommendations {
	margin-top: 50px;
    border: 1px #f05138 solid;
    border-radius: 30px;
    padding: 30px 30px 15px 30px;
}
  
.recommendations h3 {
    color: #f05138;  
}
  
.recommendations ul {
    padding-left: 20px;  
}
</style>

<style>
/* http://prismjs.com/download.html?themes=prism-okaidia&languages=clike+bash+swift+yaml&plugins=line-numbers */
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #f8f8f2;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

pre.line-numbers {
	position: relative;
	padding-left: 3.8em;
	counter-reset: linenumber;
}

pre.line-numbers > code {
	position: relative;
}

.line-numbers .line-numbers-rows {
	position: absolute;
	pointer-events: none;
	top: 0;
	font-size: 100%;
	left: -3.8em;
	width: 3em; /* works for line-numbers below 1000 lines */
	letter-spacing: -1px;
	border-right: 1px solid #999;

	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;

}

	.line-numbers-rows > span {
		pointer-events: none;
		display: block;
		counter-increment: linenumber;
	}

		.line-numbers-rows > span:before {
			content: counter(linenumber);
			color: #999;
			display: block;
			padding-right: 0.8em;
			text-align: right;
		}
</style>

<script>
/* http://prismjs.com/download.html?themes=prism-okaidia&languages=clike+bash+swift+yaml&plugins=line-numbers */
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={manual:_self.Prism&&_self.Prism.manual,util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var l=r[e];if(2==arguments.length){a=arguments[1];for(var i in a)a.hasOwnProperty(i)&&(l[i]=a[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],a||l),"Object"!==n.util.type(e[l])||r[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||r[n.util.objId(e[l])]||(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,r)):(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,l=a.elements||document.querySelectorAll(a.selector),i=0;r=l[i++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1].toLowerCase(),i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l);var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(u.element.textContent=u.code),n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var g=new Worker(n.filename);g.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},g.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var l=n.tokenize(e,t);return a.stringify(n.util.encode(l),r)},tokenize:function(e,t){var a=n.Token,r=[e],l=t.rest;if(l){for(var i in l)t[i]=l[i];delete t.rest}e:for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=t[i];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],g=u.inside,c=!!u.lookbehind,h=!!u.greedy,f=0,d=u.alias;if(h&&!u.pattern.global){var p=u.pattern.toString().match(/[imuy]*$/)[0];u.pattern=RegExp(u.pattern.source,p+"g")}u=u.pattern||u;for(var m=0,y=0;m<r.length;y+=r[m].length,++m){var v=r[m];if(r.length>e.length)break e;if(!(v instanceof a)){u.lastIndex=0;var b=u.exec(v),k=1;if(!b&&h&&m!=r.length-1){if(u.lastIndex=y,b=u.exec(e),!b)break;for(var w=b.index+(c?b[1].length:0),_=b.index+b[0].length,P=m,A=y,j=r.length;j>P&&_>A;++P)A+=r[P].length,w>=A&&(++m,y=A);if(r[m]instanceof a||r[P-1].greedy)continue;k=P-m,v=e.slice(y,A),b.index-=y}if(b){c&&(f=b[1].length);var w=b.index+f,b=b[0].slice(f),_=w+b.length,x=v.slice(0,w),O=v.slice(_),S=[m,k];x&&S.push(x);var N=new a(i,g?n.tokenize(b,g):b,d,b,h);S.push(N),O&&S.push(O),Array.prototype.splice.apply(r,S)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,l=0;r=a[l++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.length=0|(a||"").length,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var l={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==l.type&&(l.attributes.spellcheck="true"),e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o=Object.keys(l.attributes).map(function(e){return e+'="'+(l.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+l.tag+' class="'+l.classes.join(" ")+'"'+(o?" "+o:"")+">"+l.content+"</"+l.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,l=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),l&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,!document.addEventListener||n.manual||r.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};
!function(e){var t={variable:[{pattern:/\$?\(\([\w\W]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\w\W]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b-?(?:0x[\dA-Fa-f]+|\d*\.?\d+(?:[Ee]-?\d+)?)\b/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[a-z0-9_#\?\*!@]+|\{[^}]+\})/i]};e.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:"important"},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^<])<<\s*)(?:"|')?(\w+?)(?:"|')?\s*\r?\n(?:[\s\S])*?\r?\n\2/g,lookbehind:!0,greedy:!0,inside:t},{pattern:/(["'])(?:\\\\|\\?[^\\])*?\1/g,greedy:!0,inside:t}],variable:t.variable,"function":{pattern:/(^|\s|;|\||&)(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|npm|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|\s|;|\||&)/,lookbehind:!0},keyword:{pattern:/(^|\s|;|\||&)(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|\s|;|\||&)/,lookbehind:!0},"boolean":{pattern:/(^|\s|;|\||&)(?:true|false)(?=$|\s|;|\||&)/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|<<<?|>>|<=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var a=t.variable[1].inside;a["function"]=e.languages.bash["function"],a.keyword=e.languages.bash.keyword,a.boolean=e.languages.bash.boolean,a.operator=e.languages.bash.operator,a.punctuation=e.languages.bash.punctuation}(Prism);
Prism.languages.swift=Prism.languages.extend("clike",{string:{pattern:/("|')(\\(?:\((?:[^()]|\([^)]+\))+\)|\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0,inside:{interpolation:{pattern:/\\\((?:[^()]|\([^)]+\))+\)/,inside:{delimiter:{pattern:/^\\\(|\)$/,alias:"variable"}}}}},keyword:/\b(as|associativity|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic(?:Type)?|else|enum|extension|fallthrough|final|for|func|get|guard|if|import|in|infix|init|inout|internal|is|lazy|left|let|mutating|new|none|nonmutating|operator|optional|override|postfix|precedence|prefix|private|Protocol|public|repeat|required|rethrows|return|right|safe|self|Self|set|static|struct|subscript|super|switch|throws?|try|Type|typealias|unowned|unsafe|var|weak|where|while|willSet|__(?:COLUMN__|FILE__|FUNCTION__|LINE__))\b/,number:/\b([\d_]+(\.[\de_]+)?|0x[a-f0-9_]+(\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,constant:/\b(nil|[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,atrule:/@\b(IB(?:Outlet|Designable|Action|Inspectable)|class_protocol|exported|noreturn|NS(?:Copying|Managed)|objc|UIApplicationMain|auto_closure)\b/,builtin:/\b([A-Z]\S+|abs|advance|alignof(?:Value)?|assert|contains|count(?:Elements)?|debugPrint(?:ln)?|distance|drop(?:First|Last)|dump|enumerate|equal|filter|find|first|getVaList|indices|isEmpty|join|last|lexicographicalCompare|map|max(?:Element)?|min(?:Element)?|numericCast|overlaps|partition|print(?:ln)?|reduce|reflect|reverse|sizeof(?:Value)?|sort(?:ed)?|split|startsWith|stride(?:of(?:Value)?)?|suffix|swap|toDebugString|toString|transcode|underestimateCount|unsafeBitCast|with(?:ExtendedLifetime|Unsafe(?:MutablePointers?|Pointers?)|VaList))\b/}),Prism.languages.swift.string.inside.interpolation.inside.rest=Prism.util.clone(Prism.languages.swift);
Prism.languages.yaml={scalar:{pattern:/([\-:]\s*(![^\s]+)?[ \t]*[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)[^\r\n]+(?:\3[^\r\n]+)*)/,lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:/(\s*(?:^|[:\-,[{\r\n?])[ \t]*(![^\s]+)?[ \t]*)[^\r\n{[\]},#\s]+?(?=\s*:\s)/,lookbehind:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)(\d{4}-\d\d?-\d\d?([tT]|[ \t]+)\d\d?:\d{2}:\d{2}(\.\d*)?[ \t]*(Z|[-+]\d\d?(:\d{2})?)?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(:\d{2}(\.\d*)?)?)(?=[ \t]*($|,|]|}))/m,lookbehind:!0,alias:"number"},"boolean":{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)(true|false)[ \t]*(?=$|,|]|})/im,lookbehind:!0,alias:"important"},"null":{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)(null|~)[ \t]*(?=$|,|]|})/im,lookbehind:!0,alias:"important"},string:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)("(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*')(?=[ \t]*($|,|]|}))/m,lookbehind:!0,greedy:!0},number:{pattern:/([:\-,[{]\s*(![^\s]+)?[ \t]*)[+\-]?(0x[\da-f]+|0o[0-7]+|(\d+\.?\d*|\.?\d+)(e[\+\-]?\d+)?|\.inf|\.nan)[ \t]*(?=$|,|]|})/im,lookbehind:!0},tag:/![^\s]+/,important:/[&*][\w]+/,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./};
!function(){"undefined"!=typeof self&&self.Prism&&self.document&&Prism.hooks.add("complete",function(e){if(e.code){var t=e.element.parentNode,s=/\s*\bline-numbers\b\s*/;if(t&&/pre/i.test(t.nodeName)&&(s.test(t.className)||s.test(e.element.className))&&!e.element.querySelector(".line-numbers-rows")){s.test(e.element.className)&&(e.element.className=e.element.className.replace(s,"")),s.test(t.className)||(t.className+=" line-numbers");var n,a=e.code.match(/\n(?!$)/g),l=a?a.length+1:1,r=new Array(l+1);r=r.join("<span></span>"),n=document.createElement("span"),n.setAttribute("aria-hidden","true"),n.className="line-numbers-rows",n.innerHTML=r,t.hasAttribute("data-start")&&(t.style.counterReset="linenumber "+(parseInt(t.getAttribute("data-start"),10)-1)),e.element.appendChild(n)}}})}();
</script>

<script>
(function() {
    function addPublishYear() {
        var element = document.querySelector("time.dt-published");
        var attribute = element.getAttribute("datetime");
        var year = attribute.split("-")[0];

        var wrapper = document.querySelector(".date-wrapper");
        wrapper.innerHTML += '<span class="year">' + year + "</span>";
    }

    document.addEventListener('DOMContentLoaded', addPublishYear, false);
})();
</script>

<script>
(function() {
    function addSponsorAd() {
        var ad = document.createElement("div");
        ad.className = "sxs-ad";
        ad.innerHTML = '<span class="sxs-ad-prefix">Sponsor</span><span class="sxs-ad-title">' + sxs_sponsor_title + '</span><span class="sxs-ad-text">' + sxs_sponsor_text + '</span><span class="sxs-ad-footer">Checking out this sponsor helps support this site. <a target="_blank" href="/ads">Read more here</a>.</span>';

        var wrappers = document.querySelectorAll(".sqs-block-markdown");
      
        if (wrappers.length == 0) {
            return; 
        }
      
        var wrapper = wrappers[wrappers.length - 1];
        var headings = wrapper.querySelectorAll("h2");

        if (headings.length > 0) {
            var lastHeading = headings[headings.length - 1];
            lastHeading.parentNode.insertBefore(ad, lastHeading);
        } else {
            var codeBlocks = wrapper.querySelectorAll("pre.language-swift");

            if (codeBlocks.length == 0) {
                return;
            }

            var lastCodeBlock = codeBlocks[codeBlocks.length - 1];
            lastCodeBlock.parentNode.insertBefore(ad, lastCodeBlock.nextSibling);
        }
    }

    function addSponsorIntro() {
        var ad = document.createElement("div");
        ad.className = "sxs-ad";
        ad.innerHTML = '<span class="sxs-ad-prefix">This week\'s sponsor</span><span class="sxs-ad-text">Big thanks to <a target="_blank" href="' + sxs_sponsor_link + '"><b>' + sxs_sponsor_title + '</b></a> for sponsoring Swift by Sundell this week. Make sure to check them out at the end of this article, to help support this site.</span>'

        var wrapper = document.querySelector(".sqs-block-content");
        var headings = wrapper.querySelectorAll("h2");

        if (headings.length > 1) {
            var firstHeading = headings[0];
            firstHeading.parentNode.insertBefore(ad, firstHeading);
        } else {
            var codeBlocks = wrapper.querySelectorAll("pre.language-swift");

            if (codeBlocks.length == 0) {
                return;
            }

            var firstCodeBlock = codeBlocks[0];
            firstCodeBlock.parentNode.insertBefore(ad, firstCodeBlock.nextSibling);
        }
    }

    document.addEventListener('DOMContentLoaded', addSponsorAd, false);
  document.addEventListener('DOMContentLoaded', addSponsorIntro, false);
})();
</script>

<script>
(function() {
    function makeButtonHTML(icon, text, href) {
        return '<a href="' + href + '" class="sxs-button"><div class="sxs-wrapper"><span class="sxs-icon">' + icon + '</span><span class="sxs-text">' + text + '</span></div></a>';
    }

    function replaceFooter() {      
        var page = document.getElementById("page");
        var heading = page.querySelector("h2");

        if (heading == null) {
            return;
        }

        var title = heading.innerText;
        var url = location.href.split("?")[0];
        var twitterLink = 'https://twitter.com/intent/tweet?via=johnsundell&text=%22' + encodeURIComponent(title) + '%22&url=' + encodeURIComponent(url);

        var markdownBlocks = document.getElementsByClassName("sqs-block-markdown");

        if (markdownBlocks.length == 0) {
            return;
        }

        var block = markdownBlocks[markdownBlocks.length - 1];
        var footer = document.createElement("div");
        footer.className = "sxs-footer";
        footer.innerHTML = makeButtonHTML("🙌", "Share this article<br/>on Twitter", twitterLink) + makeButtonHTML("📬", "Subscribe to the monthly newsletter", "/newsletter") + makeButtonHTML("🎙", "Listen to the Swift by Sundell podcast", "/podcast") + makeButtonHTML("🗄", "Browse all articles by category", "/categories");
        block.appendChild(footer);

        var defaultFooter = document.querySelector(".blog-item-footer");
        defaultFooter.remove();
    }

    document.addEventListener('DOMContentLoaded', replaceFooter, false);
})();
</script></div>

        <section class="blog-item-comments">
          <div class="blog-item-comments-toggle-wrapper">
            <label for="show-comments" title="Show/Hide Comments" class="blog-item-comments-toggle">
              </label>
            <div id="blogItemCommentsContent" class="blog-item-comments-content">
              
            </div>
          </div>
        </section>
      </div>
      <aside id="blogItemSidebar" class="blog-item-sidebar">
        
          <div class="blog-item-author-profile blog-item-author-profile--sidebar">
            
  <a href="/?author=590b40b317bffc01e6729b6b" class="author-avatar content-fill" data-controller="SimpleImageLoad" data-tweaks="tweak-show-blog-item-author-profile">
    <img class="author-avatar-image" data-src="https://static1.squarespace.com/static/images/592c4cbdb8a79bae6fffae5b/100w" data-image="https://static1.squarespace.com/static/images/592c4cbdb8a79bae6fffae5b/100w" data-image-focal-point="0.5,0.5" data-load="false">
  </a>

<div class="author-name"><a href="/?author=590b40b317bffc01e6729b6b">John Sundell</a></div>



          </div>
        
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Blog Item Sidebar" data-type="block-field" data-updated-on="1426103623593" id="blogItemSidebarContent"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-56becdc832b69c244539"><div class="sqs-block-content"> 

  
    <div class="image-block-outer-wrapper layout-caption-below    design-layout-inline">
    
      <div class="intrinsic" style="max-width:1100.0px;">
        
          <div style="padding-bottom:77.54545593261719%;" class="image-block-wrapper   has-aspect-ratio" data-description="" >
            <noscript><img src="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/590b40b75016e10ca7fbff80/1426103606443/" alt="" /></noscript><img class="thumb-image" data-src="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/590b40b75016e10ca7fbff80/1426103606443/" data-image="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/590b40b75016e10ca7fbff80/1426103606443/" data-image-dimensions="1100x853" data-image-focal-point="0.5,0.5" alt="" data-load="false" data-image-id="590b40b75016e10ca7fbff80" data-type="image" />
          </div>
        

        

      </div>
    
    </div>
  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-4553b55c289ac0113879"><div class="sqs-block-content"><p>Cras mattis consectetur purus sit amet fermentum. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum.</p></div></div></div></div></div>
      </aside>

    </article>
  </div>



<section class="blog-item-pagination">
  <a href="/posts/reflection-in-swift" class="blog-item-pagination-link blog-item-pagination-link--prev">
    <div class="blog-item-label">
      <svg class="prev-icon" viewBox="0 0 50 100">
        <use xlink:href="/assets/ui-icons.svg#thick-arrow-left-icon"></use>
      </svg>
    </div>
    <span class="pagination-title-wrapper">
      
      <h2 class="blog-item-pagination-title"><time class="dt-published date-pagination" datetime="2019-02-10" pubdate>Feb 10 </time>Reflection in Swift</h2>
    </span>
  </a><!--
  --><a href="/posts/testing-error-code-paths-in-swift" class="blog-item-pagination-link blog-item-pagination-link--next">
    <div class="blog-item-label">
      <svg class="next-icon" viewBox="0 0 50 100">
        <use xlink:href="/assets/ui-icons.svg#thick-arrow-right-icon"></use>
      </svg>
    </div>
    <span class="pagination-title-wrapper">
      
      <h2 class="blog-item-pagination-title"><time class="dt-published date-pagination" datetime="2019-01-27" pubdate>Jan 27 </time>Testing error code paths in Swift</h2>
    </span>
  </a>
</section>



  
</div>

      </main>

      <footer id="footer" class="site-footer responsive-margin--top responsive-padding--left responsive-padding--right responsive-padding--top responsive-padding--bottom" role="contentinfo">
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1537717304755" id="footerBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="row sqs-row"><div class="col sqs-col-3 span-3"><div class="sqs-block spacer-block sqs-block-spacer sized vsize-1" data-block-type="21" id="block-yui_3_17_2_16_1455123498129_5268"><div class="sqs-block-content">&nbsp;</div></div></div><div class="col sqs-col-9 span-9"><div class="row sqs-row"><div class="col sqs-col-6 span-6"><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-bf27c28fa5c3c31235a2"><div class="sqs-block-content">

  

    
      <div class="image-block-outer-wrapper layout-caption-hidden design-layout-inline combination-animation-none individual-animation-none individual-text-animation-none">
      
        <div class="intrinsic" style="max-width:150.0px;">
          
            <div style="padding-bottom:100.0%;" class="image-block-wrapper   has-aspect-ratio" data-description="" >
              <noscript><img src="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/590b49071b631b14ff85e44b/1493911820125/" alt="" /></noscript><img class="thumb-image" data-src="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/590b49071b631b14ff85e44b/1493911820125/" data-image="https://static1.squarespace.com/static/590b40b75016e10ca7fbff78/t/590b49071b631b14ff85e44b/1493911820125/" data-image-dimensions="150x150" data-image-focal-point="0.5,0.5" alt="" data-load="false" data-image-id="590b49071b631b14ff85e44b" data-type="image" />
            </div>
          

          

        </div>
      
      </div>
    

  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_16_1455123498129_4719"><div class="sqs-block-content"><p style="white-space: pre-wrap;">Hi, I'm John! I build apps, games &amp; Swift developer tools. On this blog I post weekly posts about Swift development techniques, frameworks and tips &amp; tricks. You can also find me on <a href="https://twitter.com/johnsundell" target="_blank"><strong>Twitter</strong></a> and <a href="https://github.com/johnsundell" target="_blank"><strong>GitHub</strong></a>.</p></div></div><div class="sqs-block code-block sqs-block-code" data-block-type="23" id="block-yui_3_17_2_4_1516725321843_6394"><div class="sqs-block-content"><div class="theme-select">
    Theme:
    <a href="#" id="theme-select-light" onclick="return selectTheme('light');">Light</a>  |  
    <a href="#" id="theme-select-dark" onclick="return selectTheme('dark');">Dark</a>  |  
    <a href="#" id="theme-select-black" onclick="return selectTheme('black');">Black</a>
</div></div></div></div><div class="col sqs-col-3 span-3"><div class="sqs-block spacer-block sqs-block-spacer sized vsize-1" data-block-type="21" id="block-yui_3_17_2_16_1455123498129_6139"><div class="sqs-block-content">&nbsp;</div></div></div></div></div></div><div class="sqs-block spacer-block sqs-block-spacer" data-aspect-ratio="1.3449023861171367" data-block-type="21" id="block-yui_3_17_2_16_1455123498129_7511"><div class="sqs-block-content">&nbsp;</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_16_1455123498129_8435"><div class="sqs-block-content"><p style="text-align: center; white-space: pre-wrap;">Powered by <a href="http://www.squarespace.com?channel=word_of_mouth&amp;subchannel=customer&amp;source=footer&amp;campaign=4fd1028ee4b02be53c65dfb3" target="_blank">Squarespace</a></p></div></div></div></div></div>
        <div id="footerNavWrapper" class="nav-wrapper footer-nav">
          

        </div>
      </footer>

    </div>

    <div id="mobileBar" class="mobile-bar" data-controller="MobileOffset">
      <a class="nav-toggle-label nav-toggle-label--mobile flex-item" id="navToggleMobile" data-controller="NavToggle">
        <svg class="Icon Icon--hamburger nav-toggle-label-icon" viewBox="0 0 26 18">
          <use class="use--odd" xlink:href="/assets/ui-icons.svg#hamburger-icon--odd"></use>
          <use class="use--even" xlink:href="/assets/ui-icons.svg#hamburger-icon--even"></use>
        </svg>
      </a><!--
      --><div class="social-ellipsis social-ellipsis--mobile flex-item" id="socialEllipsisMobile" data-controller="SocialToggle">
        <svg class="ellipsis-icon" viewBox="0 0 25 6">
          <use xlink:href="/assets/ui-icons.svg#ellipsis-icon"></use>
        </svg>
        <svg class="Icon Icon--close social-close-icon" viewBox="0 0 18 18">
          <use xlink:href="/assets/ui-icons.svg#close-icon-line"></use>
        </svg>
      </div><!--
      --><div class="search-cart--mobile flex-item">
        <a href="/search" rel="search" class="header-search header-search--mobile" data-controller="SearchToggle">
          <svg class="Icon Icon--search search-icon" viewBox="0 0 20 20">
            <use xlink:href="/assets/ui-icons.svg#search-icon"></use>
          </svg>
          <svg class="Icon Icon--close search-close-icon" viewBox="0 0 18 18">
            <use xlink:href="/assets/ui-icons.svg#close-icon-line"></use>
          </svg>
        </a>
        
        
      </div><!--
      -->
    </div>

    <script src="https://static1.squarespace.com/static/ta/54d39057e4b01a0da310c80f/4931/scripts/site-bundle.js" type="text/javascript"></script>
    <script type="text/javascript" data-sqs-type="imageloader-bootstrapper">(function() {if(window.ImageLoader) { window.ImageLoader.bootstrap({}, document); }})();</script><script>Squarespace.afterBodyLoad(Y);</script>

  </body>
</html>
