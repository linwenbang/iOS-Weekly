
<!DOCTYPE html>
<html class="no-js" lang="zh">
  <head>
<meta charset="utf-8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<link rel="alternate" href="https://www.desgard.com" hreflang="pt-BR">
<link href="http://gmpg.org/xfn/11" rel="profile">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="theme-color" content="#005344">
<title>Guardia Â· ç“œåœ°</title>
<meta name="google-site-verification" content="zS1dSn20XtA4FJYEOQLXqI0boxZdMnJ2g3beje-cl20">
<meta name="description" content="I write many code to write less code.ğŸ’»">
<meta name="keywords" content="">
<!-- Social: Facebook / Open Graph -->
<meta property="og:url" content="https://www.desgard.com/cocoapods-1/">
<meta property="og:title" content="CocoaPods å†é™© - æ€»è§ˆ | Gua">
<meta property="og:description" content="I write many code to write less code.ğŸ’»">
<meta property="og:site_name" content="Desgard_Duan">
<meta property="og:locale" content="pt_BR">
<meta property="og:type" content="website">
<meta property="og:author" content="https://www.facebook.com/desgard.duan">
<meta property="og:image" content="https://www.desgard.com">
<!-- Social: Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@nandomoreirame">
<meta name="twitter:domain" content="https://www.desgard.com">
<meta name="twitter:title" content="CocoaPods å†é™© - æ€»è§ˆ | Gua">
<meta name="twitter:description" content="I write many code to write less code.ğŸ’»">
<meta name="twitter:image:src" content="https://www.desgard.com">
<!-- Favicons -->
<link rel="apple-touch-icon" sizes="114x114" href="https://www.desgard.com/ico/apple-touch-icon-114.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.desgard.com/ico/apple-touch-icon-72.png">
<link rel="apple-touch-icon" href="https://www.desgard.com/ico/apple-touch-icon-57.png">
<link rel="shortcut icon" href="https://www.desgard.com/ico/favicon.png">
<!-- rel prev and next -->
<!-- Canonical link tag -->
<link rel="canonical" href="https://www.desgard.com/cocoapods-1/">
<link rel="alternate" type="application/rss+xml" title="Gua" href="https://www.desgard.comfeed.xml">
<link href="/assets/css/main.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
<script src="/assets/js/main.js"></script>
<script src="/assets/js/jquery-3.1.js"></script>
<script src="/assets/js/jquery.rotate.js"></script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Website",
  "publisher": "www.desgard.com",
  "url": "http://www.desgard.com/",
  "description": "ç“œåœ°"
}
</script>
<script type="text/javascript">
  var disqus_shortname = 'desgard',
      baseurl          = '';
</script>
<!--
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-52446115-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c5a8123bc51782a3083a631ed9ff50e4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true
    }
  });
</script>
  </head>
  <body class=" cocoapods-1">
    <header class="header">
  <div class="container">
    <h1><a href="/"><strong>desgard</strong>.com</a></h1>
    <nav class="navbar">
      <ul>
        <!-- <li>
          <a href="/">
            <i class="fa fa-search"></i>
          </a>
        </li> -->
        <li>
          <a href="#!" data-modal="modalSearch" onclick="show_search_view(true)">
            <i class="fa fa-search">
            </i>
          </a>
        </li>
        <li><a href="/comment " target="_blank"><i class="fa fa-comments"></i></a></li>
        <li><a href="/feed.xml" target="_blank"><i class="fa fa-feed"></i></a></li>
      </ul>
    </nav>
  </div>
</header>
    <main class="wrapper container" itemprop="mainContentOfPage" itemscope="itemscope" itemtype="http://schema.org/Blog">
      <article class="post" itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
  <header class="post-header">
    <h1>CocoaPods å†é™© - æ€»è§ˆ</h1>
    <div class="post-meta">
      <time datetime="2015-10-13">
        <i class="fa fa-calendar-o"></i> <time datetime="2019-03-16"> 2019-03-16
      </time>
      <span>
        <i class="fa fa-comments"></i> <a href="#container">Comment me!</a>
      </span>
      <span>
<!--
        <i class="fa fa-folder-open-o"></i> 
-->
      </span>
    </div>
  </header>
  <p>åŸºæœ¬ä¸Šæ‰€æœ‰çš„ iOSer éƒ½æ˜¯ç”¨è¿‡ <em>CocoaPods</em> æ¥ç®¡ç† iOS å·¥ç¨‹ä¸­çš„ä¸‰æ–¹åº“ï¼Œä½†æ˜¯å¾ˆå°‘æœ‰ç³»åˆ—æ–‡ç« æ¥è¯¦ç»†çš„è§£è¯» <em>CocoaPods</em>ã€‚ç¬”è€…å†³å®šè‡ªè¡Œå°è¯•ä¸€ä¸‹ã€‚æœ¬æ–‡æ‰€æœ‰ <em>CocoaPods</em> æºç ä½¿ç”¨çš„æ˜¯ 1.5.3 ç‰ˆæœ¬ã€‚</p>
<h2 id="why-ruby">Why Rubyï¼Ÿ</h2>
<p>ç¬”è€…åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œåœ¨åšä¸€å…³äºé¡¹ç›®ç»„ä»¶ç®¡ç†çš„æ•ˆç‡å·¥å…·ï¼Œç”±äºç»„å†…æŠ€æœ¯é€‰å‹ä¹Ÿç¡®å®šäº†ä½¿ç”¨ Ruby æ¥å¼€å‘ï¼Œæ‰€ä»¥ä¹ŸèŠ±äº†ä¸€äº›æ—¶é—´å…¥é—¨äº†ä¸€ä¸‹è¿™é—¨è¯­è¨€ã€‚çºµè§‚ <em>CocoaPods</em> çš„ä»£ç ï¼Œå…¶ä¸­ç”¨åˆ°äº†å¾ˆå¤š Ruby çš„ç‰¹æ€§ï¼Œå¹¶ä¸” <em>CocoaPods</em> çš„ä½œè€…ä»¬ä¹Ÿæ˜¯æ·±å— RoR å¼€å‘æ¨¡å¼å½±å“çš„ä¸€äº›å·¥ç¨‹å¸ˆã€‚ä¸ºäº†æ•´ä½“æŠŠæ¡ <em>CocoaPods</em> è¿™ä¸ªé¡¹ç›®ï¼ŒRuby è¿™é—¨è„šæœ¬è¯­è¨€ä¹Ÿå»ºè®®å»å…¥é—¨å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<p>åœ¨ <em>CocoaPods</em> ä¸­ï¼Œå¾ˆå¤šä»£ç ç‰‡æ®µç”¨åˆ°äº†ä»¥ä¸‹ Ruby çš„ç‰¹æ€§æˆ–æ˜¯ RoR å¼€å‘æ¨¡å¼ï¼š</p>
<h3 id="1-eval-ç‰¹æ€§">1. <code class="highlighter-rouge">eval</code> ç‰¹æ€§</h3>
<p>è®°å¾—æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ <code class="highlighter-rouge">eval</code> æ¦‚å¿µæ˜¯åœ¨ SICP ä¸­ä»‹ç»çš„å…ƒè¯­è¨€æŠ½è±¡ã€‚ä¾‹å­è®²è¿°äº†ç”¨ Scheme å†™å‡ºä¸€ä¸ª Scheme çš„è§£é‡Šå™¨ï¼Œå…¶ä¸­ä¾èµ–çš„<strong>è‡ªå¾ªç¯ Eval/Apply è§£é‡Šå™¨</strong>ä¸­ï¼Œeval è¿‡ç¨‹å³<strong>å°†ä¸€ä¸ªè¡¨è¾¾å¼è½¬æ¢ä¸ºå–å¾—å…¶å€¼çš„è¿‡ç¨‹</strong>ã€‚</p>
<p>Ruby ä¹Ÿæ˜¯å…·æœ‰ eval çš„åŠ¨æ€æ€§ï¼Œåœ¨ <strong>pry</strong> ä¸­å¯ä»¥ä½¿ç”¨ <code class="highlighter-rouge">eval</code> æ–¹æ³•æ¥æµ‹è¯•å®ƒï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">eval</span> <span class="s2">"100 * (100 + 1) / 2"</span>
<span class="o">=&gt;</span> <span class="mi">5050</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">eval</span> <span class="s2">"puts 'Hello Ruby!'"</span>
<span class="no">Hello</span> <span class="no">Ruby</span><span class="o">!</span>
<span class="o">=&gt;</span> <span class="kp">nil</span></code></pre></figure>
<p>é€šè¿‡ <code class="highlighter-rouge">eval</code> ä½¿å¾— Ruby è·å¾—äº†æ›´å¼ºå¤§çš„åŠ¨æ€èƒ½åŠ›ï¼Œåœ¨è¿è¡Œæ—¶å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ¥æ”¹å˜é€»è¾‘ï¼Œè€Œä¸æ˜¯ä¸ä¼ ç»Ÿçš„æ‰‹åŠ¨è§£æè¾“å…¥å’Œè¾“å…¥è¯­æ³•æ ‘ã€‚</p>
<p>è¿™ä¸ªç‰¹æ€§ä¼šåœ¨ <em>cocoapods-core</em> ä¸­å¤§é‡ä½¿ç”¨ï¼Œç”¨æ¥è§£æ <code class="highlighter-rouge">Podfile</code>ã€<code class="highlighter-rouge">Podfile.lock</code> å’Œ <code class="highlighter-rouge">.spec</code> æ–‡ä»¶ã€‚</p>
<h3 id="2-bundler-æ€æƒ³çš„é“ºå«">2. Bundler æ€æƒ³çš„é“ºå«</h3>
<p>å½“ç¬”è€…åœ¨å…¥é—¨ Ruby å¼€å§‹å­¦ä¹ å†™é¡¹ç›®çš„å¼€å§‹ï¼Œéœ€è¦æŸ¥è¯¢å„ç§æ‰€éœ€è¦çš„ä¾èµ–åº“ã€‚è€Œ <a href="https://rubygems.org/">rubygems.org</a> ç®€ç›´å°±æ˜¯ä¸€ä¸ªå®åœ°ï¼Œå®ƒä¾‹å¦‚æˆ‘ä»¬ iOS å¼€å‘ä¸­ <a href="https://cocoapods.org/">cocoapods.org</a> çš„è§’è‰²ï¼Œç”¨äºæ‰˜ç®¡ä¸€ä¸ªä¸ª Gem ç»„ä»¶ï¼Œä»è€Œé¿å…äº†é‡å¤é€ è½®å­ã€‚ä½†æ˜¯åªæ˜¯æ‰˜ç®¡ Gem ç»„ä»¶æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œå› ä¸ºæœ¬åœ°å’Œè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ç»„ä»¶ç”±äºæ—¶é—´åŸå› æ€»ä¼šå‡ºç°ç‰ˆæœ¬å·®å¼‚çš„é—®é¢˜ã€‚</p>
<p><strong>Bundler</strong> è¯ç”Ÿçš„åŸå› ä¹‹ä¸€å°±æ˜¯éœ€è¦è§£å†³ä¾èµ–çš„ç‰ˆæœ¬é—®é¢˜ã€‚<em>Bundler</em> ä½¿ç”¨äº†å¾ˆå¤šæŠ€å·§æ€§å’Œå¯å‘å¼ç®—æ³•æ¥è§£è¿™ä¸ªä¾èµ–å›¾ã€‚ä» <em>CocoaPods</em> ä¸­çš„ <em><a href="https://github.com/CocoaPods/Molinillo">Molinillo</a></em> ç®—æ³•ä¸­å¯ä»¥çœ‹å‡º <em>Bundler</em> ä¾èµ–å›¾ç®—æ³•çš„å½±å­ï¼Œä½†æ˜¯ç›®å‰è¿˜ä¸æ˜¯ç‰¹åˆ«çš„æ•æ·ï¼Œä¸ªäººè§‰å¾—ç®—æ³•åº”è¯¥è¿˜æœ‰ä¼˜åŒ–ç©ºé—´ã€‚å¦å¤–ï¼Œå½“ <em>Bundler</em> æ¯æ¬¡è¿è¡Œåä¼šé€šè¿‡ä¸€ä¸ª <code class="highlighter-rouge">Gemfile.lock</code> æ¥å­˜å‚¨å¯è¡Œè§£ï¼ŒåŒæ ·çš„ <em>CocoaPods</em> ä¸­çš„ <code class="highlighter-rouge">Podfile.lock</code> ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œé€šè¿‡ <em>YAML</em> æ ¼å¼è®°å½•ã€‚è¿™é‡Œæ¨èä¸€ç¯‡æ–‡ç« ï¼š <a href="https://juejin.im/post/5c1fb3696fb9a049af6d4132">ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨ RVM / Bundler</a>ã€‚</p>
<h3 id="3-å¼ºå¤§çš„-plugin-å¼€å‘èƒ½åŠ›">3. å¼ºå¤§çš„ plugin å¼€å‘èƒ½åŠ›</h3>
<h4 id="å¯¹-class-å’Œ-module-çš„æ‰©å±•">å¯¹ Class å’Œ Module çš„æ‰©å±•</h4>
<p>è¿™é‡Œæˆ‘æ‰€ç†è§£çš„ plugin å¼€å‘ä¹Ÿå°±æ˜¯ç±»ä¼¼äºæˆ‘ä»¬åœ¨ iOS ä¸­çš„ <strong>Category</strong> ï¼ˆSwift çš„ <strong>Extension</strong>ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¾èµ–åº“æ¥å¯¹ä¸»ä»“ <em>CocoaPods</em> çš„ Class å’Œ Module è¿›è¡ŒåŠ¨æ€æ“ä½œã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>è¿™ä¸ªæ˜¯åœ¨ <em>CocoaPods</em> ä¸»ä»“ä¸­ <code class="highlighter-rouge">downloader.rb</code> ä¸­çš„ä»£ç ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€äº›ç±»æ–¹æ³•ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># file: CocoaPods - cocoapods/downloader.rb</span>
<span class="k">module</span> <span class="nn">Pod</span>
  <span class="k">module</span> <span class="nn">Downloader</span>
    <span class="nb">require</span> <span class="s1">'cocoapods/downloader/cache'</span>
    <span class="nb">require</span> <span class="s1">'cocoapods/downloader/request'</span>
    <span class="nb">require</span> <span class="s1">'cocoapods/downloader/response'</span>
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">download</span><span class="p">(</span>
      <span class="n">request</span><span class="p">,</span>
      <span class="n">target</span><span class="p">,</span>
      <span class="ss">can_cache: </span><span class="kp">true</span><span class="p">,</span>
      <span class="ss">cache_path: </span><span class="no">Config</span><span class="p">.</span><span class="nf">instance</span><span class="p">.</span><span class="nf">cache_root</span> <span class="o">+</span> <span class="s1">'Pods'</span>
    <span class="p">)</span>
      <span class="c1"># ...</span>
      <span class="k">end</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>
<p>ä½†æ˜¯åœ¨ <em><a href="https://github.com/CocoaPods/cocoapods-downloader">cocoapods-downloader</a></em> æ¨¡å—ä¸­ï¼Œ<code class="highlighter-rouge">Downloader</code> è¿™ä¸ª module çš„æ–¹æ³•å¹¶ä¸èƒ½æ»¡è¶³å…¨éƒ¨éœ€æ±‚ï¼Œäºæ˜¯åœ¨ <code class="highlighter-rouge">api.rb</code> ä¸­ä¼šçœ‹åˆ°è¿™æ ·çš„ä»£ç æ‰©å±•ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># file: CocoaPods - cocoapods-downloader/api.rb</span>
<span class="k">module</span> <span class="nn">Pod</span>
  <span class="k">module</span> <span class="nn">Downloader</span>
    <span class="k">module</span> <span class="nn">API</span>
      <span class="k">def</span> <span class="nf">execute_command</span><span class="p">(</span><span class="n">executable</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">raise_on_failure</span> <span class="o">=</span> <span class="kp">false</span><span class="p">)</span>
        <span class="c1"># ...</span>
      <span class="k">end</span>
      <span class="k">def</span> <span class="nf">check_exit_code!</span><span class="p">(</span><span class="n">executable</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="c1"># ...</span>
      <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>  </code></pre></figure>
<p>è¿™ä¹Ÿå°±å¥½æ¯”åœ¨ iOS å¼€å‘ä¸­å¯¹æŸä¸€ä¸ª Class çš„ <em>Category</em> æ‰©å±•ï¼Œå¯ä»¥ä¸ºå…¶å¢åŠ æ–¹æ³•ã€å¢åŠ å±æ€§ï¼Œç”šè‡³æ˜¯é‡å†™æ–¹æ³•ã€‚åœ¨ GitHub æœ‰è¿‘ç™¾ä¸ªå…³äº <em>CocoaPods</em> çš„æ‰©å±•å’Œä¼˜åŒ–ï¼Œè¿™ç§ä»£ç éšå¤„å¯è§ã€‚</p>
<p>å€¼å¾—ä¸€æçš„ï¼Œåœ¨ Ruby ä¸­ä½¿ç”¨ç±»ä¼¼äº ObjC çš„ <em>Method Swizzling</em> ä¹Ÿéšå¤„å¯è§ã€‚Ruby ä¸­å¯ç®€å•çš„é€šè¿‡ <code class="highlighter-rouge">alias_method</code> æ¥å¯¹æˆå‘˜æ–¹æ³•ã€ç±»æ–¹æ³•åšåˆ°æ–¹æ³•æ›¿æ¢ã€‚</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">Test</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>   <span class="k">def</span> <span class="nf">hello</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>     <span class="nb">p</span> <span class="s2">"hello"</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>   <span class="k">end</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span> <span class="k">end</span>
<span class="o">=&gt;</span> <span class="ss">:hello</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">Test</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>   <span class="kp">alias_method</span> <span class="ss">:hello_old</span><span class="p">,</span> <span class="ss">:hello</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>   <span class="k">def</span> <span class="nf">hello</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>     <span class="nb">p</span> <span class="s2">"hello world"</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span>   <span class="k">end</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">*</span> <span class="k">end</span>
<span class="o">=&gt;</span> <span class="ss">:hello</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="nb">test</span> <span class="o">=</span> <span class="no">Test</span><span class="p">.</span><span class="nf">new</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;Test:0x007fca3eb1d158&gt;</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="nb">test</span><span class="p">.</span><span class="nf">hello</span>
<span class="s2">"hello world"</span>
<span class="o">=&gt;</span> <span class="s2">"hello world"</span></code></pre></figure>
<h4 id="bundler-å¯¹äº-gem-å¼€å‘çš„æœ¬åœ°æ˜ å°„"><em>Bundler</em> å¯¹äº Gem å¼€å‘çš„æœ¬åœ°æ˜ å°„</h4>
<p>åœ¨ <em>CocoaPods</em> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„ <code class="highlighter-rouge">gemfile</code> çš„å†™æ³•æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">SKIP_UNRELEASED_VERSIONS</span> <span class="o">=</span> <span class="kp">false</span>
<span class="c1"># å£°æ˜ CocoaPods å¯¹äº git ä»“åº“çš„ä¾èµ–å…³ç³»ã€‚</span>
<span class="c1"># å…¼å®¹æœ¬åœ° git ä»“åº“æ¨¡å¼å¼€å‘</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">cp_gem</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">repo_name</span><span class="p">,</span> <span class="n">branch</span> <span class="o">=</span> <span class="s1">'master'</span><span class="p">,</span> <span class="ss">path: </span><span class="kp">false</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">gem</span> <span class="nb">name</span> <span class="k">if</span> <span class="no">SKIP_UNRELEASED_VERSIONS</span>
  <span class="c1"># å¦‚æœ path å‚æ•°ä¸º trueï¼Œé‚£ä¹ˆå°†åœ¨ "../[repo_name]" è¿™ä¸ªè·¯å¾„ä¸‹æœç´¢ä»“åº“</span>
  <span class="n">opts</span> <span class="o">=</span> <span class="k">if</span> <span class="n">path</span>
           <span class="p">{</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s2">"../</span><span class="si">#{</span><span class="n">repo_name</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
         <span class="k">else</span>
           <span class="c1"># å¦åˆ™æ‹¼æ¥ git ä»“åº“åœ°å€è·å–</span>
           <span class="n">url</span> <span class="o">=</span> <span class="s2">"https://github.com/CocoaPods/</span><span class="si">#{</span><span class="n">repo_name</span><span class="si">}</span><span class="s2">.git"</span>
           <span class="p">{</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="n">url</span><span class="p">,</span> <span class="ss">:branch</span> <span class="o">=&gt;</span> <span class="n">branch</span> <span class="p">}</span>
         <span class="k">end</span>
  <span class="c1"># è¿”å›æ ‡å‡†çš„ Gemfile Gem å¯¼å…¥æ ¼å¼</span>
  <span class="n">gem</span> <span class="nb">name</span><span class="p">,</span> <span class="n">opts</span>
<span class="k">end</span>
<span class="n">source</span> <span class="s1">'https://rubygems.org'</span>
<span class="n">gemspec</span>
<span class="n">gem</span> <span class="s1">'json'</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">'https://github.com/segiddins/json.git'</span><span class="p">,</span> <span class="ss">:branch</span> <span class="o">=&gt;</span> <span class="s1">'seg-1.7.7-ruby-2.2'</span>
<span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="c1"># å¼€å‘çš„ Gem ç»„ä»¶</span>
  <span class="n">cp_gem</span> <span class="s1">'claide'</span><span class="p">,</span>                <span class="s1">'CLAide'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-core'</span><span class="p">,</span>        <span class="s1">'Core'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-deintegrate'</span><span class="p">,</span> <span class="s1">'cocoapods-deintegrate'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-downloader'</span><span class="p">,</span>  <span class="s1">'cocoapods-downloader'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-plugins'</span><span class="p">,</span>     <span class="s1">'cocoapods-plugins'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-search'</span><span class="p">,</span>      <span class="s1">'cocoapods-search'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-stats'</span><span class="p">,</span>       <span class="s1">'cocoapods-stats'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-trunk'</span><span class="p">,</span>       <span class="s1">'cocoapods-trunk'</span>
  <span class="n">cp_gem</span> <span class="s1">'cocoapods-try'</span><span class="p">,</span>         <span class="s1">'cocoapods-try'</span>
  <span class="n">cp_gem</span> <span class="s1">'molinillo'</span><span class="p">,</span>             <span class="s1">'Molinillo'</span>
  <span class="n">cp_gem</span> <span class="s1">'nanaimo'</span><span class="p">,</span>               <span class="s1">'Nanaimo'</span>
  <span class="n">cp_gem</span> <span class="s1">'xcodeproj'</span><span class="p">,</span>             <span class="s1">'Xcodeproj'</span>
  <span class="n">gem</span> <span class="s1">'cocoapods-dependencies'</span><span class="p">,</span> <span class="s1">'~&gt; 1.0.beta.1'</span>
  <span class="n">gem</span> <span class="s1">'bacon'</span>
  <span class="n">gem</span> <span class="s1">'mocha'</span>
  <span class="n">gem</span> <span class="s1">'mocha-on-bacon'</span>
  <span class="n">gem</span> <span class="s1">'prettybacon'</span>
  <span class="n">gem</span> <span class="s1">'webmock'</span>
  <span class="c1"># é›†æˆæµ‹è¯•</span>
  <span class="n">gem</span> <span class="s1">'diffy'</span>
  <span class="n">gem</span> <span class="s1">'clintegracon'</span>
  <span class="c1"># ä»£ç è´¨é‡æ ¡éªŒ</span>
  <span class="n">gem</span> <span class="s1">'inch_by_inch'</span>
  <span class="n">gem</span> <span class="s1">'rubocop'</span>
  <span class="n">gem</span> <span class="s1">'danger'</span>
<span class="k">end</span>
<span class="n">group</span> <span class="ss">:debugging</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s1">'cocoapods_debug'</span>
  <span class="n">gem</span> <span class="s1">'rb-fsevent'</span>
  <span class="n">gem</span> <span class="s1">'kicker'</span>
  <span class="n">gem</span> <span class="s1">'awesome_print'</span>
  <span class="n">gem</span> <span class="s1">'ruby-prof'</span><span class="p">,</span> <span class="ss">:platforms</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:ruby</span><span class="p">]</span>
<span class="k">end</span></code></pre></figure>
<p>åœ¨ <code class="highlighter-rouge">Gemfile</code> ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆå¤šé€šè¿‡ <code class="highlighter-rouge">cp_gem</code> è£…è½½çš„ Gem åº“ï¼Œå¹¶ä¸”å¦‚æœå‘ç°æœ‰ä¸ <em>CocoaPods</em> é¡¹ç›®ç›®å½•åŒçº§çš„ç›®å½•ï¼Œåˆ™ä¼šä½¿ç”¨å¯¹åº”çš„é¡¹ç›®ç›´æ¥é€šè¿‡ Gem åŠ è½½ã€‚é€šè¿‡ç®€å•çš„ç›®å½•åˆ†å‰²å’Œ <code class="highlighter-rouge">Gemfile</code> ç®¡ç†ï¼Œå°±å®ç°äº†æœ€åŸºæœ¬åˆæœ€ç›´è§‚çš„<strong>çƒ­æ’æ‹”</strong>ï¼Œå¯¹ç»„ä»¶å¼€å‘ååˆ†å‹å¥½ã€‚æ‰€ä»¥ä½ åªè¦å°†å¤šä¸ªä»“åº“å¦‚ä¸‹å›¾æ–¹å¼æ’åˆ—ï¼Œå³å¯å®ç°è·¨ä»“åº“ç»„ä»¶å¼€å‘ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># gua @ Guabook in ~/Desktop/cocoapod-dev [66:66:66]</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span>
<span class="n">lrwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">gua</span>  <span class="n">staff</span>    <span class="mi">31</span> <span class="no">Jul</span> <span class="mi">30</span> <span class="mi">21</span><span class="p">:</span><span class="mi">34</span> <span class="no">CocoaPods</span>
<span class="n">lrwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">gua</span>  <span class="n">staff</span>    <span class="mi">26</span> <span class="no">Jul</span> <span class="mi">31</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span> <span class="no">Core</span> 
<span class="n">lrwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">gua</span>  <span class="n">staff</span>    <span class="mi">31</span> <span class="no">Jul</span> <span class="mi">31</span> <span class="mi">10</span><span class="p">:</span><span class="mi">14</span> <span class="no">Molinillo</span> 
<span class="n">lrwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">gua</span>  <span class="n">staff</span>    <span class="mi">31</span> <span class="no">Aug</span> <span class="mi">15</span> <span class="mi">11</span><span class="p">:</span><span class="mi">32</span> <span class="no">Xcodeproj</span> 
<span class="n">lrwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>  <span class="mi">1</span> <span class="n">gua</span>  <span class="n">staff</span>    <span class="mi">42</span> <span class="no">Jul</span> <span class="mi">31</span> <span class="mi">10</span><span class="p">:</span><span class="mi">14</span> <span class="n">cocoapods</span><span class="o">-</span><span class="n">downloader</span> </code></pre></figure>
<p>å½“ç„¶é€‰å‹ä¸º Ruby ä¸€å®šä¸ä»…ä»…æœ‰ä»¥ä¸‹è¿™äº›å¥½å¤„ï¼Œæœ‰å¾ˆå¤šä¸œè¥¿æ˜¯æˆ‘è¿™ä¸ªéä¸“ä¸š Rubyer é€‰æ‰‹å¯ä»¥çœ‹å‡ºæ¥çš„ã€‚å¦‚æœæœ‰å…¶ä»–çš„ä¼˜åŠ¿å¯ä»¥å¸®æˆ‘è¡¥å……ã€‚</p>
<h2 id="ç»„ä»¶æ„æˆå’Œå¯¹åº”èŒè´£">ç»„ä»¶æ„æˆå’Œå¯¹åº”èŒè´£</h2>
<p>é€šè¿‡ä¸Šé¢å¯¹äº <code class="highlighter-rouge">Gemfile</code> çš„ç®€å•åˆ†æï¼Œå¯ä»¥çœ‹å‡º <em>CocoaPods</em> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªä»“åº“é‚£ä¹ˆç®€å•ï¼Œå®ƒä½œä¸ºä¸€ä¸ªä¸‰æ–¹åº“ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå¯¹è‡ªèº«ç»„ä»¶çš„ç®¡ç†å’Œç»„ä»¶åŒ–ä¹Ÿæ˜¯ååˆ†è®²ç©¶çš„ã€‚æˆ‘ä»¬ç»§ç»­æ¥çœ‹è¿™ä»½ <code class="highlighter-rouge">Gemfile</code>ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># å¼€å‘çš„ Gem ç»„ä»¶</span>
<span class="c1"># CLAide æ˜¯ä¸€ä¸ªå‘½ä»¤çš„è§£æå™¨</span>
<span class="c1">#é€šè¿‡ç®€å•çš„ API æä¾›å‘½ä»¤çš„æ„é€ ã€å‚æ•°è§£æã€ç”Ÿæˆ help ç­‰åŠŸèƒ½</span>
<span class="n">cp_gem</span> <span class="s1">'claide'</span><span class="p">,</span>                <span class="s1">'CLAide'</span>
<span class="c1"># Core ç”¨äº CocoaPods ä¸­æ¨¡æ¿æ–‡ä»¶çš„è§£æ</span>
<span class="c1"># åŒ…æ‹¬ Podfileã€podspec æ–‡ä»¶ï¼Œè¿˜åŒ…æ‹¬æ‰€æœ‰çš„ .lock æ–‡ä»¶ä¸­ç‰¹æ®Šçš„ YAML æ–‡ä»¶</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-core'</span><span class="p">,</span>        <span class="s1">'Core'</span>
<span class="c1"># cocoapods-deintegrate ç”¨æ¥ä»å·¥ç¨‹ä¸­åˆ é™¤æ‰€æœ‰çš„ CocoaPods ç›¸å…³é…ç½®</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-deintegrate'</span><span class="p">,</span> <span class="s1">'cocoapods-deintegrate'</span>
<span class="c1"># cocoapods-downloader CocoaPods ä¸­çš„ä¸‹è½½æ¨¡å—æ‰©å±•</span>
<span class="c1"># æ”¯æŒä» git, svn, hg, http, scp, bzr å¤šç§åè®®ï¼Œä¹Ÿæœ‰éƒ¨åˆ†ä¸‹è½½æ—¶å€™çš„ä¼˜åŒ–ç­–ç•¥</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-downloader'</span><span class="p">,</span>  <span class="s1">'cocoapods-downloader'</span>
<span class="c1"># cocoapods-plugins æ’ä»¶ç®¡ç†åŠŸèƒ½</span>
<span class="c1"># å…¶ä¸­æœ‰ `pod plugin` å…¨å¥—å‘½ä»¤ï¼Œæ”¯æŒå¯¹äº CocoaPods æ’ä»¶çš„åˆ—è¡¨ä¸€è§ˆ(list)ã€æœç´¢(search)ã€åˆ›å»º(create)åŠŸèƒ½</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-plugins'</span><span class="p">,</span>     <span class="s1">'cocoapods-plugins'</span>
<span class="c1"># Pods æœç´¢å·¥å…·</span>
<span class="c1"># ç”¨æ¥æœç´¢ Pods ä¸‰æ–¹åº“</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-search'</span><span class="p">,</span>      <span class="s1">'cocoapods-search'</span>
<span class="c1"># Pods ç»„ä»¶æ•°æ®ç»Ÿè®¡æ’ä»¶</span>
<span class="c1"># å±•ç¤ºä¸‹è½½é‡ç­‰ç›¸å…³ç»Ÿè®¡æ–¹é¢çš„ä¿¡æ¯</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-stats'</span><span class="p">,</span>       <span class="s1">'cocoapods-stats'</span>
<span class="c1"># ä¸ cocoapods.org æ‰“é€šçš„å‘½ä»¤è¡Œå·¥å…·</span>
<span class="c1"># ç”¨äºæŸ¥çœ‹ä¸ªäººç”¨æˆ·ä¿¡æ¯ã€ä¸Šä¼  spec ç­‰æ“ä½œ</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-trunk'</span><span class="p">,</span>       <span class="s1">'cocoapods-trunk'</span>
<span class="c1"># Pods ç»„ä»¶ Demo å·¥ç¨‹å¿«é€Ÿé¢„è§ˆ</span>
<span class="n">cp_gem</span> <span class="s1">'cocoapods-try'</span><span class="p">,</span>         <span class="s1">'cocoapods-try'</span>
<span class="c1"># Pods ç»„ä»¶ç‰ˆæœ¬ä¾èµ–ä»²è£ç®—æ³•</span>
<span class="n">cp_gem</span> <span class="s1">'molinillo'</span><span class="p">,</span>             <span class="s1">'Molinillo'</span>
<span class="c1"># ascii ç¼–ç çš„ plist æ–‡ä»¶ Ruby åŸç”Ÿè§£æåº“</span>
<span class="n">cp_gem</span> <span class="s1">'nanaimo'</span><span class="p">,</span>               <span class="s1">'Nanaimo'</span>
<span class="c1"># é€šè¿‡åŸç”Ÿ Ruby åˆ›å»ºXcodeé¡¹ç›®</span>
<span class="n">cp_gem</span> <span class="s1">'xcodeproj'</span><span class="p">,</span>             <span class="s1">'Xcodeproj'</span></code></pre></figure>
<p>é€šè¿‡æŸ¥çœ‹ <code class="highlighter-rouge">Gemfile</code> å¯ä»¥çœ‹å‡º CocoaPods å¯¹äºç»„ä»¶çš„æ‹†åˆ†ç²’åº¦æ˜¯æ¯”è¾ƒç»†å¾®çš„ï¼Œé€šè¿‡å¯¹å„ç§ç»„ä»¶çš„ç»„åˆè¾¾åˆ°ç°åœ¨çš„å®Œæ•´ç‰ˆæœ¬ã€‚è¿™äº›ç»„ä»¶ä¸­ï¼Œç¬”è€…ä¹Ÿä»…ä»…é›¶æ•£çš„çœ‹è¿‡ä¸€ç‚¹ï¼Œç”±äºç»„ä»¶ç¾¤è¿‡äºåºå¤§ã€‚ä½†æ˜¯éƒ½èƒ½è¾¾åˆ°æ‹†å¼€å»ä½¿ç”¨çš„ç¨‹åº¦ã€‚</p>
<p><img src="../assets/images/blog/15331754438882/15528105632230.jpg" alt="" /></p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå½“å¯¹<strong>æ„å»º Xcode å·¥ç¨‹</strong>æœ‰æ ¡æœ¬åŒ–å¤„ç†éœ€æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ <em>Xcodeproj</em> æ¥æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜ä¸€ä¸ªå·¥ç¨‹ã€‚ä¾‹å¦‚ä½¿ç”¨ <code class="highlighter-rouge">xcodeproj</code> æ¥æŸ¥çœ‹ <code class="highlighter-rouge">Sepicat</code> é¡¹ç›®çš„ä¸€äº›ä¿¡æ¯ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="nb">require</span> <span class="s1">'xcodeproj'</span>
<span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">XCODEPROJ_PATH</span> <span class="o">=</span> <span class="no">Pathname</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/Users/gua/Desktop/git/Sepicat-dev/Sepicat/Sepicat/Sepicat.xcodeproj"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;Pathname:/Users/gua/Desktop/git/Sepicat-dev/Sepicat/Sepicat/Sepicat.xcodeproj&gt;</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">project</span> <span class="o">=</span> <span class="no">Xcodeproj</span><span class="o">::</span><span class="no">Project</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="no">XCODEPROJ_PATH</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;Xcodeproj::Project:0x3fe51f622d2c&gt;</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">project</span><span class="p">.</span><span class="nf">targets</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="c1">#&lt;Xcodeproj::Project::Object::PBXNativeTarget:0x3fe51f498e5c&gt;, #&lt;Xcodeproj::Project::Object::PBXNativeTarget:0x3fe51fc96410&gt;]</span>
<span class="p">[</span><span class="no">I</span><span class="err">'</span><span class="n">m</span> <span class="mi">5</span><span class="p">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">project</span><span class="p">.</span><span class="nf">to_hash</span>
<span class="o">=&gt;</span> <span class="p">{</span><span class="s2">"objects"</span><span class="o">=&gt;</span>
  <span class="p">{</span><span class="s2">"D59E24B31FB8861200B00B8C"</span><span class="o">=&gt;</span>
    <span class="p">{</span><span class="s2">"isa"</span><span class="o">=&gt;</span><span class="s2">"PBXProject"</span><span class="p">,</span>
     <span class="s2">"attributes"</span><span class="o">=&gt;</span>
      <span class="p">{</span><span class="s2">"LastSwiftUpdateCheck"</span><span class="o">=&gt;</span><span class="s2">"0910"</span><span class="p">,</span>
       <span class="s2">"LastUpgradeCheck"</span><span class="o">=&gt;</span><span class="s2">"0910"</span><span class="p">,</span>
       <span class="s2">"ORGANIZATIONNAME"</span><span class="o">=&gt;</span><span class="s2">"Desgard_Duan"</span><span class="p">,</span>
       <span class="s2">"TargetAttributes"</span><span class="o">=&gt;</span>
        <span class="p">{</span><span class="s2">"D59E24BA1FB8861200B00B8C"</span><span class="o">=&gt;</span>
          <span class="p">{</span><span class="s2">"CreatedOnToolsVersion"</span><span class="o">=&gt;</span><span class="s2">"9.1"</span><span class="p">,</span>
           <span class="s2">"LastSwiftMigration"</span><span class="o">=&gt;</span><span class="s2">"0920"</span><span class="p">,</span>
           <span class="s2">"ProvisioningStyle"</span><span class="o">=&gt;</span><span class="s2">"Automatic"</span><span class="p">},</span>
         <span class="s2">"D59E24CE1FB8861200B00B8C"</span><span class="o">=&gt;</span>
          <span class="p">{</span><span class="s2">"CreatedOnToolsVersion"</span><span class="o">=&gt;</span><span class="s2">"9.1"</span><span class="p">,</span>
           <span class="s2">"ProvisioningStyle"</span><span class="o">=&gt;</span><span class="s2">"Automatic"</span><span class="p">,</span>
           <span class="s2">"TestTargetID"</span><span class="o">=&gt;</span><span class="s2">"D59E24BA1FB8861200B00B8C"</span><span class="p">}}},</span>
           <span class="o">...</span></code></pre></figure>
<p>è¿™é‡Œæˆ‘è°ƒç”¨äº† <code class="highlighter-rouge">Project</code> è¿™ä¸ª Class çš„ <code class="highlighter-rouge">to_hash</code> æ–¹æ³•ï¼Œå®ƒå¯ä»¥è®² <code class="highlighter-rouge">xcodeproj</code> æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ä»¥ Hash æ–¹å¼è¿”å›å¹¶è¾“å‡ºã€‚å½“ç„¶ï¼Œ<em>Xcodeproj</em> åŠŸèƒ½ä¸æ­¢äºæ­¤ï¼Œåœ¨åç»­çš„ç³»åˆ—æ–‡ç« ä¸­ä¼šæœ‰æ›´å¤šçš„ä½¿ç”¨æ–¹æ³•ã€‚è¿™é‡Œä»…ä»…æ˜¯æ¥å±•ç¤ºï¼Œæ‰€æœ‰çš„ Gem ç»„ä»¶æ˜¯å¯ä»¥å•ç‹¬æŠ½ç¦»å‡ºæ¥ä½¿ç”¨çš„ã€‚</p>
<h2 id="ä»ä¸€æ¬¡-install-å‘½ä»¤æ¥åˆæ¢-cocoapods-æºç ">ä»ä¸€æ¬¡ Install å‘½ä»¤æ¥åˆæ¢ CocoaPods æºç </h2>
<h3 id="å‘½ä»¤å…¥å£">å‘½ä»¤å…¥å£</h3>
<p><code class="highlighter-rouge">pod install</code> å…¶å®æ˜¯ iOS å¼€å‘è€…åœ¨å­¦ä¹  CocoaPods æ—¶å­¦ä¹ çš„ç¬¬ä¸€ä¸ªå‘½ä»¤ï¼Œè™½ç„¶ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šå…³äº <code class="highlighter-rouge">pod install</code> çš„åŸç†è§£æï¼Œä½†æ˜¯ä½œä¸ºç³»åˆ—ç¬¬ä¸€ç¯‡ï¼Œè¿™ä¸ªåˆ†æä»æ—§é‡è¦ã€‚æˆ‘ä»¬æ‰“å¼€ç»ˆç«¯åˆ°é¡¹ç›®ä¸­çš„ <code class="highlighter-rouge">Podfile</code> æ‰€åœ¨ç›®å½•ä¸‹ï¼Œè¾“å…¥ <code class="highlighter-rouge">pod install</code>ï¼š</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>pod <span class="nb">install</span></code></pre></figure>
<p>æ¯æ¬¡å½“è¾“å…¥ä¸€ä¸ª <code class="highlighter-rouge">pod xxx</code> å‘½ä»¤çš„æ—¶å€™ï¼Œé¦–å…ˆç³»ç»Ÿä¼šè°ƒç”¨è¿™ä¸ª <code class="highlighter-rouge">pod</code> å‘½ä»¤ã€‚æ‰€æœ‰çš„å‘½ä»¤éƒ½æ˜¯åœ¨ <code class="highlighter-rouge">/bin</code> ç›®å½•ä¸‹å­˜æ”¾çš„è„šæœ¬ï¼Œå½“ç„¶ Ruby ç¯å¢ƒçš„ä¹Ÿä¸ä¾‹å¤–ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code class="highlighter-rouge">command which pod</code> æ¥æŸ¥çœ‹å‘½ä»¤æ‰€åœ¨ä½ç½®ï¼š</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">command </span>which pod
/Users/gua/.rvm/gems/ruby-2.4.1/bin/pod</code></pre></figure>
<p>å‡ºç° <code class="highlighter-rouge">/Users/gua/.rvm/gems/ruby-2.4.1/bin/pod</code> è€Œä¸æ˜¯ <code class="highlighter-rouge">/usr/local/bin/pod</code> çš„åŸå› æ˜¯å› ä¸ºæˆ‘ç”µè„‘ä¸­çš„ Ruby ç‰ˆæœ¬æ˜¯ä½¿ç”¨ <em>RVM</em> è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„ï¼Œæ‰€ä»¥ä¼šè£…åœ¨è¿™ä¹ˆä¸€ä¸ªå†—é•¿çš„ç›®å½•ä¸‹ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå…¥å£è„šæœ¬æ‰§è¡Œäº†ä»€ä¹ˆï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># pod</span>
<span class="c1">#!/usr/bin/env ruby_executable_hooks</span>
<span class="c1">#</span>
<span class="c1"># This file was generated by RubyGems.</span>
<span class="c1">#</span>
<span class="c1">#'cocoapods' åšä¸º Gem ç»„ä»¶è¢«å®‰è£…</span>
<span class="c1"># è¿™ä¸ªè„šæœ¬åšä¸ºå…¥å£æ–‡ä»¶æ¥å”¤é†’ cocoapods </span>
<span class="c1">#</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="n">version</span> <span class="o">=</span> <span class="s2">"&gt;= 0.a"</span>
<span class="k">if</span> <span class="no">ARGV</span><span class="p">.</span><span class="nf">first</span>
  <span class="n">str</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">.</span><span class="nf">first</span>
  <span class="c1"># "BINARY" æ˜¯ ASCII-8BIT åˆ«å</span>
  <span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">dup</span><span class="p">.</span><span class="nf">force_encoding</span><span class="p">(</span><span class="s2">"BINARY"</span><span class="p">)</span> <span class="k">if</span> <span class="n">str</span><span class="p">.</span><span class="nf">respond_to?</span> <span class="ss">:force_encoding</span>
  <span class="c1"># \A ä»£è¡¨è¾“å…¥çš„å¼€å§‹ä½ç½®ï¼Œ\z ä»£è¡¨è¾“å…¥çš„ç»“æŸ</span>
  <span class="k">if</span> <span class="n">str</span> <span class="o">=~</span> <span class="sr">/\A_(.*)_\z/</span> <span class="n">and</span> <span class="no">Gem</span><span class="o">::</span><span class="no">Version</span><span class="p">.</span><span class="nf">correct?</span><span class="p">(</span><span class="vg">$1</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">version</span> <span class="o">=</span> <span class="vg">$1</span>
    <span class="c1"># shift æ‹¿å‡ºç¬¬ä¸€ä¸ªå…ƒç´ å¹¶ç§»é™¤</span>
    <span class="no">ARGV</span><span class="p">.</span><span class="nf">shift</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="k">if</span> <span class="no">Gem</span><span class="p">.</span><span class="nf">respond_to?</span><span class="p">(</span><span class="ss">:activate_bin_path</span><span class="p">)</span>
  <span class="nb">load</span> <span class="no">Gem</span><span class="p">.</span><span class="nf">activate_bin_path</span><span class="p">(</span><span class="s1">'cocoapods'</span><span class="p">,</span> <span class="s1">'pod'</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>
<span class="k">else</span>
  <span class="n">gem</span> <span class="s2">"cocoapods"</span><span class="p">,</span> <span class="n">version</span>
  <span class="nb">load</span> <span class="no">Gem</span><span class="p">.</span><span class="nf">bin_path</span><span class="p">(</span><span class="s2">"cocoapods"</span><span class="p">,</span> <span class="s2">"pod"</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>
<p>å…¥å£ä¸­å°†å‘½ä»¤çš„æ‰§è¡ŒæŒ‡å‘äº† Gem ç»„ä»¶çš„ Path ä¸­ï¼Œè¿™æ ·å°±æ‰¾åˆ°äº† <em>CocoaPods</em> çš„å…¥å£è„šæœ¬ï¼Œå³åœ¨ <code class="highlighter-rouge">cocoapods/bin</code> ç›®å½•ä¸‹çš„ <code class="highlighter-rouge">pod</code>ã€‚</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#!/usr/bin/env ruby</span>
<span class="c1"># ... å¿½ç•¥ä¸€äº›å¯¹äºç¼–ç å¤„ç†çš„ä»£ç </span>
<span class="nb">require</span> <span class="s1">'cocoapods'</span>
<span class="c1"># è¿™é‡Œæˆ‘æ‰‹åŠ¨è¾“å‡ºä¸€ä¸‹è°ƒç”¨æ ˆï¼Œæ¥å…³æ³¨ä¸€ä¸‹</span>
<span class="nb">puts</span> <span class="nb">caller</span>
<span class="k">if</span> <span class="n">profile_filename</span> <span class="o">=</span> <span class="no">ENV</span><span class="p">[</span><span class="s1">'PROFILE'</span><span class="p">]</span>
  <span class="nb">require</span> <span class="s1">'ruby-prof'</span>
  <span class="n">reporter</span> <span class="o">=</span>
    <span class="k">case</span> <span class="p">(</span><span class="n">profile_extname</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">extname</span><span class="p">(</span><span class="n">profile_filename</span><span class="p">))</span>
    <span class="k">when</span> <span class="s1">'.txt'</span>
      <span class="no">RubyProf</span><span class="o">::</span><span class="no">FlatPrinterWithLineNumbers</span>
    <span class="k">when</span> <span class="s1">'.html'</span>
      <span class="no">RubyProf</span><span class="o">::</span><span class="no">GraphHtmlPrinter</span>
    <span class="k">when</span> <span class="s1">'.callgrind'</span>
      <span class="no">RubyProf</span><span class="o">::</span><span class="no">CallTreePrinter</span>
    <span class="k">else</span>
      <span class="k">raise</span> <span class="s2">"Unknown profiler format indicated by extension: </span><span class="si">#{</span><span class="n">profile_extname</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">profile_filename</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">io</span><span class="o">|</span>
    <span class="c1"># å®ä¾‹åŒ–ä¸€ä¸ª Pods::Command å¯¹è±¡ï¼Œå¹¶è¿›å…¥ä¸»æµç¨‹</span>
    <span class="n">reporter</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">RubyProf</span><span class="p">.</span><span class="nf">profile</span> <span class="p">{</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Command</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="no">ARGV</span><span class="p">)</span> <span class="p">}).</span><span class="nf">print</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">else</span>
  <span class="c1"># å®ä¾‹åŒ–ä¸€ä¸ª Pods::Command å¯¹è±¡ï¼Œå¹¶è¿›å…¥ä¸»æµç¨‹</span>
  <span class="no">Pod</span><span class="o">::</span><span class="no">Command</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="no">ARGV</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>
<p>è°ƒç”¨æ ˆè¾“å‡ºäº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">/Users/gua/.rvm/gems/ruby-2.4.1/bin/pod:23:in <span class="sb">`</span>load<span class="s1">'
/Users/gua/.rvm/gems/ruby-2.4.1/bin/pod:23:in `&lt;main&gt;'</span>
/Users/gua/.rvm/gems/ruby-2.4.1/bin/ruby_executable_hooks:24:in <span class="sb">`</span><span class="nb">eval</span><span class="s1">'
/Users/gua/.rvm/gems/ruby-2.4.1/bin/ruby_executable_hooks:24:in `&lt;main&gt;'</span></code></pre></figure>
<p><code class="highlighter-rouge">ruby_executable_hooks</code> é€šè¿‡ <code class="highlighter-rouge">bin</code> ç›®å½•ä¸‹çš„ <code class="highlighter-rouge">pod</code> å…¥å£å”¤é†’ï¼Œå†é€šè¿‡ <code class="highlighter-rouge">eval</code> çš„æ‰‹æ®µè°ƒèµ·æˆ‘ä»¬éœ€è¦çš„ CocoaPods å·¥ç¨‹ã€‚è¿™æ˜¯ <code class="highlighter-rouge">Bundler</code> çš„è‡ªèº«è¡Œä¸ºã€‚</p>
<p>åœ¨å…¥å£çš„æœ€åéƒ¨åˆ†ï¼Œå‘ç°é€šè¿‡è°ƒç”¨ <code class="highlighter-rouge">Pod::Command.run(ARGV)</code>ï¼Œå®ä¾‹åŒ–äº†ä¸€ä¸ª <code class="highlighter-rouge">CLAide::Command</code> å¯¹è±¡ï¼Œäºæ˜¯ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤åŠå±‚æ•°ä»æ­¤è¿›å…¥<strong>CLAide è§£æé˜¶æ®µ</strong>ã€‚è¿™é‡Œä¸å¯¹ <strong>CLAide</strong> è¿™ä¸ªå‘½ä»¤è§£æå·¥å…·åšè¿‡å¤šçš„åˆ†æï¼Œè¿™ä¸ªæ˜¯åé¢ç³»åˆ—æ–‡ç« çš„å†…å®¹ï¼Œæˆ‘ä»¬ä»…ä»…çŸ¥é“ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>æ ¹æ®ç»§æ‰¿æ¥è‡ªåŠ¨ç”Ÿæˆå‘½ä»¤å±‚çº§çš„å‘½ä»¤è§£æå·¥å…·ï¼Œæ¯æ¬¡å‘½ä»¤çš„æ‰§è¡Œï¼Œå…¶å®æ˜¯å¯¹åº”åˆ°å…·ä½“ Class çš„ <code class="highlighter-rouge">run</code> æ–¹æ³•</strong>ã€‚</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">module</span> <span class="nn">Pod</span>
<span class="c1"># hello</span>
  <span class="k">class</span> <span class="nc">Command</span>
    <span class="k">class</span> <span class="nc">Install</span> <span class="o">&lt;</span> <span class="no">Command</span>
      <span class="c1"># .. çœç•¥å¾ˆå¤šå‚æ•°å®šä¹‰</span>
      <span class="k">def</span> <span class="nf">run</span>
        <span class="c1"># åˆ¤æ–­æ˜¯å¦å­˜åœ¨ Podfile æ–‡ä»¶</span>
        <span class="c1"># ä¸å­˜åœ¨ç›´æ¥å›æŠ›å‡º "No `Podfile' found in the project directory." çš„è­¦å‘Šï¼Œç»ˆæ­¢ç¨‹åº</span>
        <span class="n">verify_podfile_exists!</span>
        <span class="c1"># ä» Config ä¸­è·å–ä¸€ä¸ª Instraller å®ä¾‹</span>
        <span class="n">installer</span> <span class="o">=</span> <span class="n">installer_for_config</span>
        <span class="c1"># é»˜è®¤æ˜¯ä¸æ‰§è¡Œ update</span>
        <span class="n">installer</span><span class="p">.</span><span class="nf">repo_update</span> <span class="o">=</span> <span class="n">repo_update?</span><span class="p">(</span><span class="ss">:default</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span>
        <span class="n">installer</span><span class="p">.</span><span class="nf">update</span> <span class="o">=</span> <span class="kp">false</span>
        <span class="n">installer</span><span class="p">.</span><span class="nf">deployment</span> <span class="o">=</span> <span class="vi">@deployment</span>
        <span class="c1"># install çš„çœŸæ­£è¿‡ç¨‹</span>
        <span class="n">installer</span><span class="p">.</span><span class="nf">install!</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>
<p>é¦–å…ˆæ ¹æ®ä¸Šé¢çš„æè¿°ï¼Œ<code class="highlighter-rouge">Install</code> æ˜¯ç»§æ‰¿äº <code class="highlighter-rouge">Command</code> å‘½ä»¤çš„ï¼Œæ‰€ä»¥å¯¹åº”çš„å‘½ä»¤ä¸º <code class="highlighter-rouge">pod install</code>ã€‚<code class="highlighter-rouge">pod install</code> è¿‡ç¨‹æ˜¯ä¾èµ–äº <code class="highlighter-rouge">Podfile</code> æ–‡ä»¶çš„ï¼Œæ‰€ä»¥åœ¨å…¥å£å¤„ä¼šåšæ£€æµ‹ï¼Œè¿™ä¸ªé”™è¯¯ä¿¡æ¯ä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸è§åˆ°çš„é”™è¯¯ä¿¡æ¯ä¹‹ä¸€ã€‚åœ¨ <code class="highlighter-rouge">installer</code> å®ä¾‹ç»„è£…å®Œæˆä¹‹åï¼Œè°ƒç”¨å…¶ <code class="highlighter-rouge">installer.install!</code> æ–¹æ³•ï¼Œè¿™æ—¶å€™æ‰è¿›å…¥äº†æˆ‘ä»¬ <code class="highlighter-rouge">pod install</code> å‘½ä»¤çš„ä¸»ä½“éƒ¨åˆ†ã€‚</p>
<h3 id="æ‰§è¡ŒåŠŸèƒ½ä¸»ä½“">æ‰§è¡ŒåŠŸèƒ½ä¸»ä½“</h3>
<p>æ¥ç€ <code class="highlighter-rouge">installer.install!</code>ï¼Œå‘ç°å…¶å®è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé«˜åº¦å°è£…çš„å…¥å£æ–¹æ³•ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">install!</span>
  <span class="c1"># æ£€æµ‹æ˜¯å¦åœ¨ Pods å†…éƒ¨ï¼Œå¦‚æœä¸æ˜¯åˆ™åšä¸€äº› install å‰å‡†å¤‡å·¥ä½œ</span>
  <span class="n">prepare</span>
  <span class="c1"># ä¾èµ–å›¾çš„è§£æ</span>
  <span class="n">resolve_dependencies</span>
  <span class="c1"># ä¾èµ–ä¸‹è½½</span>
  <span class="n">download_dependencies</span>
  <span class="c1"># æ£€éªŒæ‰€æœ‰çš„ targets</span>
  <span class="n">validate_targets</span>
  <span class="c1"># ç”Ÿæˆå¤–å±‚é¡¹ç›®</span>
  <span class="n">generate_pods_project</span>
  <span class="k">if</span> <span class="n">installation_options</span><span class="p">.</span><span class="nf">integrate_targets?</span>
    <span class="c1"># é›†æˆç”¨æˆ·é…ç½®ï¼Œè¯»å–ä¾èµ–é¡¹ï¼Œä½¿ç”¨ xcconfig æ¥é…ç½®</span>
    <span class="n">integrate_user_project</span>
  <span class="k">else</span>
    <span class="no">UI</span><span class="p">.</span><span class="nf">section</span> <span class="s1">'Skipping User Project Integration'</span>
  <span class="k">end</span>
  <span class="c1"># æ‰§è¡Œä»»ä½• install åçš„æ“ä½œï¼Œä¾‹å¦‚ä¸€äº› plugin å¯ä»¥æ’åœ¨è¿™é‡Œ</span>
  <span class="n">perform_post_install_actions</span>
<span class="k">end</span></code></pre></figure>
<h4 id="install-ç¯å¢ƒå‡†å¤‡æµç¨‹---prepare">Install ç¯å¢ƒå‡†å¤‡æµç¨‹ - <code class="highlighter-rouge">prepare</code></h4>
<p>å…ˆæ¥çœ‹ <code class="highlighter-rouge">prepare</code> æ–¹æ³•çš„å®ç°ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">prepare</span>
  <span class="c1"># å¦‚æœæ£€æµ‹å‡ºå½“å‰ç›®å½•æ˜¯ Podsï¼Œç›´æ¥ raise ç»ˆæ­¢</span>
  <span class="k">if</span> <span class="no">Dir</span><span class="p">.</span><span class="nf">pwd</span><span class="p">.</span><span class="nf">start_with?</span><span class="p">(</span><span class="n">sandbox</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">to_path</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s1">'Command should be run from a directory outside Pods directory.'</span>
    <span class="n">message</span> <span class="o">&lt;&lt;</span> <span class="s2">"</span><span class="se">\n\n\t</span><span class="s2">Current directory is </span><span class="si">#{</span><span class="no">UI</span><span class="p">.</span><span class="nf">path</span><span class="p">(</span><span class="no">Pathname</span><span class="p">.</span><span class="nf">pwd</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
    <span class="k">raise</span> <span class="no">Informative</span><span class="p">,</span> <span class="n">message</span>
  <span class="k">end</span>
  <span class="no">UI</span><span class="p">.</span><span class="nf">message</span> <span class="s1">'Preparing'</span> <span class="k">do</span>
    <span class="c1"># å¦‚æœ lock æ–‡ä»¶çš„ CocoaPods ç‰ˆæœ¬å’Œå½“å‰ç‰ˆæœ¬ä¸åŒï¼Œéœ€è¦ä½¿ç”¨æ–°ç‰ˆæœ¬ä¾èµ–çš„ xcodeproj å¯¹å·¥ç¨‹æ–‡ä»¶è¿›è¡Œæ›´æ–°</span>
    <span class="n">deintegrate_if_different_major_version</span>
    <span class="c1"># å¯¹ sandbox(Pods) ç›®å½•å»ºç«‹å­ç›®å½•ç»“æ„</span>
    <span class="n">sandbox</span><span class="p">.</span><span class="nf">prepare</span>
    <span class="c1"># æ£€æµ‹ PluginManager æ˜¯å¦æœ‰ pre-install çš„ plugin</span>
    <span class="n">ensure_plugins_are_installed!</span>
    <span class="c1"># æ‰§è¡Œæ’ä»¶ä¸­ pre-install çš„æ‰€æœ‰ hooks æ–¹æ³•</span>
    <span class="n">run_plugins_pre_install_hooks</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>
<p>åœ¨ <code class="highlighter-rouge">prepare</code> é˜¶æ®µä¼šå°† <code class="highlighter-rouge">pod install</code> çš„å‡†å¤‡å·¥ä½œå®Œæˆï¼ŒåŒ…æ‹¬<strong>ç‰ˆæœ¬ä¸€è‡´æ€§</strong>ã€<strong>ç›®å½•æ¥å£</strong>ä»¥åŠ <em>pre-install</em> çš„è£…è½½æ’ä»¶è„šæœ¬å…¨éƒ¨å–å‡ºã€‚ä¹‹åæˆ‘ä»¬æ¥åˆ° <em>CocoaPods</em> ä¸­æœ€å¤æ‚çš„ä¾èµ–è§£æç¯èŠ‚ã€‚</p>
<h4 id="ä¾èµ–è§£ææµç¨‹---resolve_dependencies">ä¾èµ–è§£ææµç¨‹ - <code class="highlighter-rouge">resolve_dependencies</code></h4>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">resolve_dependencies</span>
  <span class="c1"># è·å– Sources</span>
  <span class="n">plugin_sources</span> <span class="o">=</span> <span class="n">run_source_provider_hooks</span>
  <span class="c1"># åˆ›å»ºä¸€ä¸ª Analyzer</span>
  <span class="c1"># Analyzer æ˜¯é€šè¿‡åˆ†æ Podfile, Podfile.lock, æ²™ç›’ä¸­çš„ manifest ä»è€Œç”Ÿæˆäº†ä¸€å¼ ä¾èµ–å…³ç³»è¡¨</span>
  <span class="n">analyzer</span> <span class="o">=</span> <span class="n">create_analyzer</span><span class="p">(</span><span class="n">plugin_sources</span><span class="p">)</span>
  <span class="c1"># å¦‚æœå¸¦æœ‰ repo_update æ ‡è®°</span>
  <span class="no">UI</span><span class="p">.</span><span class="nf">section</span> <span class="s1">'Updating local specs repositories'</span> <span class="k">do</span>
    <span class="c1"># æ‰§è¡Œ Analyzer çš„æ›´æ–° Repo æ“ä½œ</span>
    <span class="n">analyzer</span><span class="p">.</span><span class="nf">update_repositories</span>
  <span class="k">end</span> <span class="k">if</span> <span class="n">repo_update?</span>
  <span class="no">UI</span><span class="p">.</span><span class="nf">section</span> <span class="s1">'Analyzing dependencies'</span> <span class="k">do</span>
    <span class="c1"># ä» analyzer å–å‡ºæœ€æ–°çš„åˆ†æç»“æœ</span>
    <span class="n">analyze</span><span class="p">(</span><span class="n">analyzer</span><span class="p">)</span>
    <span class="c1"># ä¸ªäººè°ƒè¯•ä½¿ç”¨ï¼Œç”¨äºè¾“å‡ºæ‰€æœ‰çš„ dependencies ç¼“å­˜åˆ—è¡¨</span>
    <span class="vi">@analysis_result</span><span class="p">.</span><span class="nf">podfile_dependency_cache</span><span class="p">.</span><span class="nf">podfile_dependencies</span><span class="p">.</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span> <span class="nb">p</span> <span class="n">item</span> <span class="p">}</span>
    <span class="c1"># p @analysis_result.podfile_state</span>
    <span class="c1"># p @analysis_result.sandbox_state</span>
    <span class="vi">@analysis_result</span><span class="p">.</span><span class="nf">specs_by_target</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
      <span class="vi">@analysis_result</span><span class="p">.</span><span class="nf">specs_by_target</span><span class="p">[</span><span class="n">item</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">sub_item</span><span class="o">|</span>
        <span class="nb">p</span> <span class="n">sub_item</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="c1"># æ‹¼å†™é”™è¯¯é™çº§è¯†åˆ«ï¼Œç™½åå•è¿‡æ»¤</span>
    <span class="n">validate_build_configurations</span>
    <span class="c1"># æ¸…é™¤å¹¶é‡æ–°ç”Ÿæˆç›®å½•ï¼Œæ›´æ–° Pods ç›®å½•ç»“æ„</span>
    <span class="n">clean_sandbox</span>
  <span class="k">end</span>
  <span class="n">analyzer</span>
<span class="k">end</span></code></pre></figure>
<p>ä¾èµ–è§£æè¿‡ç¨‹æˆ‘ä»¬æš‚æ—¶åªè¦çŸ¥é“é€šè¿‡ <code class="highlighter-rouge">Podfile</code>ã€<code class="highlighter-rouge">Podfile.lock</code>ã€<code class="highlighter-rouge">manifest</code> æ–‡ä»¶æ¥ç”Ÿæˆä¸€ä¸ª <em>Analyzer</em> å¯¹è±¡ã€‚<em>Analyzer</em> å†…éƒ¨ä¼šä½¿ç”¨ <em>Molinillo</em> ï¼ˆå…·ä½“çš„æ˜¯ <code class="highlighter-rouge">Molinillo::DependencyGraph</code> å›¾ç®—æ³•ï¼‰ä»è€Œå¾—åˆ°è§£æç»“æœã€‚æˆ‘ä»¬å¯ä»¥åˆ†åˆ«è¾“å‡º <code class="highlighter-rouge">@analysis_result</code> çš„ <code class="highlighter-rouge">podfile_dependency_cache.podfile_dependencies</code> æ¥æŸ¥çœ‹ <em>Podfile</em> æ–‡ä»¶çš„ä¾èµ–åˆ†æç»“æœï¼Œä¹Ÿå¯ä»¥ä» <code class="highlighter-rouge">specs_by_target</code> æ¥æŸ¥çœ‹å„ä¸ª <em>target</em> ç›¸å…³çš„ specsã€‚æ€»ä¹‹ï¼Œé€šè¿‡ <em>Analyzer</em> èƒ½è·å–åˆ°å¾ˆå¤šå…³äºä¾èµ–çš„ä¿¡æ¯ã€‚</p>
<p>å¦å¤–ï¼Œéœ€è¦åŒºåˆ†çš„æ˜¯ï¼Œåœ¨ <code class="highlighter-rouge">pod install</code> çš„è¿‡ç¨‹æœ‰æœ‰ä¸€ä¸ª <em>pre-download</em> çš„é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ <em>verbose</em> ä¸‹çœ‹åˆ°çš„ <strong>Fetching external sources</strong> è¿‡ç¨‹ã€‚è¿™ä¸ª <em>pre-download</em> é˜¶æ®µ<strong>ä¸å±äº Download</strong> è¿‡ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰çš„ <em>ä¾èµ–åˆ†æè¿‡ç¨‹</em>ã€‚è¿™é‡Œä¸»è¦æ˜¯è§£å†³å½“æˆ‘ä»¬é€šè¿‡ git åœ°å€å¼•å…¥çš„ Pod ä»“çš„æƒ…å†µï¼Œç³»ç»Ÿæ— æ³•ä»é»˜è®¤çš„ Source æ‹¿åˆ°å¯¹åº”çš„ Specï¼Œéœ€è¦ç›´æ¥è®¿é—®æˆ‘ä»¬çš„ git åœ°å€ä¸‹è½½ä»“åº“çš„ zip åŒ…ï¼Œå¹¶å–å‡ºå¯¹åº”çš„ <code class="highlighter-rouge">podspec</code> æ–‡ä»¶ï¼Œä»è€Œæ‹¿æ¥åˆ†æã€‚</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Sepicat çš„ Podfile è§£æç»“æœ</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">SnapKit</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">4.0</span><span class="o">.</span><span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">CocoaLumberjack</span><span class="o">/</span><span class="no">Swift</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">3.3</span><span class="o">.</span><span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="n">pop</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">1.0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Alamofire</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">4.5</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">ObjectMapper</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">3.1</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">AlamofireObjectMapper</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">5.0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">SDWebImage</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">4.0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">NVActivityIndicatorView</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">4.1</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">LTMorphingLabel</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">0.5</span><span class="o">.</span><span class="mi">3</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">ReachabilitySwift</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">KVOController</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">EFQRCode</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">4.3</span><span class="o">.</span><span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">PySwiftyRegex</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">2.0</span><span class="o">.</span><span class="mi">1</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">SwiftyUserDefaults</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s2">"https://github.com/Sepicat/SwiftyUserDefaults.git"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">AcknowList</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">1.5</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">MJRefresh</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">3.0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">SwiftMessages</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">4.1</span><span class="o">.</span><span class="mi">2</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">SkeletonView</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">1</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">ViewAnimator</span> <span class="n">requirements</span><span class="o">=~&gt;</span> <span class="mf">2.1</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Highlightr</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s2">"https://github.com/Sepicat/Highlightr.git"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">WCLShineButton</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s2">"https://github.com/Sepicat/WCLShineButton.git"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">ActiveLabel</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s2">"https://github.com/optonaut/ActiveLabel.swift.git"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">XLPagerTabStrip</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s2">"https://github.com/Sepicat/XLPagerTabStrip.git"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Fabric</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Crashlytics</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Firebase</span><span class="o">/</span><span class="no">Core</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="kp">nil</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Curiouscat</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s2">"https://github.com/Sepicat/Curiouscat.git"</span><span class="p">,</span> <span class="ss">:commit</span><span class="o">=&gt;</span><span class="s2">"9f3bb2c2440a7d11a5dd74255d0fee8e4a4cdb67"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Dependency</span> <span class="nb">name</span><span class="o">=</span><span class="no">Straycat</span> <span class="n">requirements</span><span class="o">=&gt;=</span> <span class="mi">0</span> <span class="n">source</span><span class="o">=</span><span class="kp">nil</span> <span class="n">external_source</span><span class="o">=</span><span class="p">{</span><span class="ss">:path</span><span class="o">=&gt;</span><span class="s2">"./../../Straycat"</span><span class="p">}</span><span class="o">&gt;</span>
<span class="c1"># Sepicat å·¥ç¨‹ä¸­å„ä¸ª target å¯¹åº” spec æƒ…å†µ</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Podfile</span><span class="o">::</span><span class="no">TargetDefinition</span> <span class="n">label</span><span class="o">=</span><span class="no">Pods</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Podfile</span><span class="o">::</span><span class="no">TargetDefinition</span> <span class="n">label</span><span class="o">=</span><span class="no">Pods</span><span class="o">-</span><span class="no">Sepicat</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"AcknowList"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"ActiveLabel"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Alamofire"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"AlamofireObjectMapper"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"CocoaLumberjack/Default"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"CocoaLumberjack/Swift"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Crashlytics"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Curiouscat"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"EFQRCode"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Fabric"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Firebase/Core"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Firebase/CoreOnly"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"FirebaseAnalytics"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"FirebaseCore"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"FirebaseInstanceID"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleAppMeasurement"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/AppDelegateSwizzler"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/Environment"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/Logger"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/MethodSwizzler"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/NSData+zlib"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/Network"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"GoogleUtilities/Reachability"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Highlightr"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"KVOController"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Kanna"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"LTMorphingLabel"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"MJRefresh"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"NVActivityIndicatorView"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"NVActivityIndicatorView/Presenter"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"ObjectMapper"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"PySwiftyRegex"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"ReachabilitySwift"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SDWebImage"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SDWebImage/Core"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SkeletonView"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SnapKit"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"Straycat"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SwiftMessages"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SwiftMessages/App"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SwiftSoup"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"SwiftyUserDefaults"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"ViewAnimator"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"WCLShineButton"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"XLPagerTabStrip"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"nanopb"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"nanopb/decode"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"nanopb/encode"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span> <span class="nb">name</span><span class="o">=</span><span class="s2">"pop"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="no">Pod</span><span class="o">::</span><span class="no">Podfile</span><span class="o">::</span><span class="no">TargetDefinition</span> <span class="n">label</span><span class="o">=</span><span class="no">Pods</span><span class="o">-</span><span class="no">SepicatTests</span><span class="o">&gt;</span></code></pre></figure>
<h4 id="æŒ‰éœ€ä¸‹è½½ä¾èµ–è¿‡ç¨‹---download_dependencies">æŒ‰éœ€ä¸‹è½½ä¾èµ–è¿‡ç¨‹ - <code class="highlighter-rouge">download_dependencies</code></h4>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">download_dependencies</span>
  <span class="no">UI</span><span class="p">.</span><span class="nf">section</span> <span class="s1">'Downloading dependencies'</span> <span class="k">do</span>
    <span class="c1"># åˆå§‹åŒ– sandbox æ–‡ä»¶è®¿é—®å™¨</span>
    <span class="n">create_file_accessors</span>
    <span class="c1"># æ„é€  Pod Source Installer</span>
    <span class="n">install_pod_sources</span>
    <span class="c1"># æ‰§è¡Œ pre install çš„ hooks</span>
    <span class="n">run_podfile_pre_install_hooks</span>
    <span class="c1"># æ ¹æ®é…ç½®æ¸…ç† pod sources ä¿¡æ¯ï¼Œä¸»è¦æ˜¯æ¸…ç†æ— ç”¨ platform ç›¸å…³å†…å®¹</span>
    <span class="n">clean_pod_sources</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>
<p>åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯ <code class="highlighter-rouge">install_pod_sources</code> è¿‡ç¨‹ã€‚<code class="highlighter-rouge">install_pod_sources</code> è¿‡ç¨‹ä¼šè°ƒç”¨å¯¹åº” Pod çš„ <code class="highlighter-rouge">install!</code> æ–¹æ³•ã€‚åœ¨ <code class="highlighter-rouge">create_file_accessors</code> ä¸­ä¼šåˆ›å»º sandbox ç›®å½•çš„æ–‡ä»¶è®¿é—®å™¨ï¼Œé€šè¿‡æ„é€  <code class="highlighter-rouge">FileAccessor</code> å®ä¾‹æ¥è§£ææ²™ç›’ä¸­çš„å„ç§æ–‡ä»¶ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸»è¦æ¥çœ‹çœ‹ <code class="highlighter-rouge">install_pod_sources</code> è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">install_pod_sources</span>
  <span class="vi">@installed_specs</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="c1"># install çš„ Pod åªéœ€è¦è¿™ä¸¤ç§çŠ¶æ€ï¼Œadded å’Œ changed çŠ¶æ€çš„å¹¶é›†</span>
  <span class="n">pods_to_install</span> <span class="o">=</span> <span class="n">sandbox_state</span><span class="p">.</span><span class="nf">added</span> <span class="o">|</span> <span class="n">sandbox_state</span><span class="p">.</span><span class="nf">changed</span>
  <span class="n">title_options</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:verbose_prefix</span> <span class="o">=&gt;</span> <span class="s1">'-&gt; '</span><span class="p">.</span><span class="nf">green</span> <span class="p">}</span>
  <span class="nb">puts</span> <span class="s2">"root_specs"</span>
  <span class="n">root_specs</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
    <span class="nb">puts</span> <span class="n">item</span>
  <span class="k">end</span>
  <span class="c1"># å°† Podfile è§£æåæ’åºå¤„ç†</span>
  <span class="n">root_specs</span><span class="p">.</span><span class="nf">sort_by</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:name</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">spec</span><span class="o">|</span>
    <span class="c1"># å¦‚æœæ˜¯ added çŠ¶æ€æˆ– changed çŠ¶æ€çš„ Pod</span>
    <span class="k">if</span> <span class="n">pods_to_install</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
      <span class="c1"># å¦‚æœæ˜¯ changed çŠ¶æ€å¹¶ä¸” manifest å·²ç»æœ‰è®°å½•</span>
      <span class="k">if</span> <span class="n">sandbox_state</span><span class="p">.</span><span class="nf">changed</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">sandbox</span><span class="p">.</span><span class="nf">manifest</span>
        <span class="c1"># ç‰ˆæœ¬æ›´æ–°</span>
        <span class="n">current_version</span> <span class="o">=</span> <span class="n">spec</span><span class="p">.</span><span class="nf">version</span>
        <span class="c1"># è¢«æ›´æ–°ç‰ˆæœ¬è®°å½•</span>
        <span class="n">previous_version</span> <span class="o">=</span> <span class="n">sandbox</span><span class="p">.</span><span class="nf">manifest</span><span class="p">.</span><span class="nf">version</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
        <span class="c1"># å˜åŠ¨è®°å½•</span>
        <span class="n">has_changed_version</span> <span class="o">=</span> <span class="n">current_version</span> <span class="o">!=</span> <span class="n">previous_version</span>
        <span class="c1"># æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ…å« spec.name çš„ Podï¼Œè·å–å¯¹åº”çš„ Repoï¼Œå…¶å®å°±æ˜¯ find æ–¹æ³•</span>
        <span class="n">current_repo</span> <span class="o">=</span> <span class="n">analysis_result</span><span class="p">.</span><span class="nf">specs_by_source</span><span class="p">.</span><span class="nf">detect</span> <span class="p">{</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="o">|</span> <span class="k">break</span> <span class="n">key</span> <span class="k">if</span> <span class="n">values</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:name</span><span class="p">).</span><span class="nf">include?</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span> <span class="p">}</span>
        <span class="c1"># puts "current_repo : #{current_repo}"</span>
        <span class="c1"># puts "current_repo : #{current_repo.url}"</span>
        <span class="c1"># puts "current_repo : #{current_repo.name}"</span>
        <span class="c1"># è·å–å½“å‰ä»“åº“</span>
        <span class="n">current_repo</span> <span class="o">&amp;&amp;=</span> <span class="n">current_repo</span><span class="p">.</span><span class="nf">url</span> <span class="o">||</span> <span class="n">current_repo</span><span class="p">.</span><span class="nf">name</span>
        <span class="c1"># è·å–ä¹‹å‰è¯¥ä»“åº“çš„ä¿¡æ¯</span>
        <span class="n">previous_spec_repo</span> <span class="o">=</span> <span class="n">sandbox</span><span class="p">.</span><span class="nf">manifest</span><span class="p">.</span><span class="nf">spec_repo</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
        <span class="c1"># æ˜¯å¦ä»“åº“æœ‰å˜åŠ¨</span>
        <span class="n">has_changed_repo</span> <span class="o">=</span> <span class="o">!</span><span class="n">previous_spec_repo</span><span class="p">.</span><span class="nf">nil?</span> <span class="o">&amp;&amp;</span> <span class="n">current_repo</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">current_repo</span> <span class="o">!=</span> <span class="n">previous_spec_repo</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"Installing </span><span class="si">#{</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">spec</span><span class="p">.</span><span class="nf">version</span><span class="si">}</span><span class="s2">"</span>
        <span class="n">title</span> <span class="o">&lt;&lt;</span> <span class="s2">" (was </span><span class="si">#{</span><span class="n">previous_version</span><span class="si">}</span><span class="s2"> and source changed to `</span><span class="si">#{</span><span class="n">current_repo</span><span class="si">}</span><span class="s2">` from `</span><span class="si">#{</span><span class="n">previous_spec_repo</span><span class="si">}</span><span class="s2">`)"</span> <span class="k">if</span> <span class="n">has_changed_version</span> <span class="o">&amp;&amp;</span> <span class="n">has_changed_repo</span>
        <span class="n">title</span> <span class="o">&lt;&lt;</span> <span class="s2">" (was </span><span class="si">#{</span><span class="n">previous_version</span><span class="si">}</span><span class="s2">)"</span> <span class="k">if</span> <span class="n">has_changed_version</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">has_changed_repo</span>
        <span class="n">title</span> <span class="o">&lt;&lt;</span> <span class="s2">" (source changed to `</span><span class="si">#{</span><span class="n">current_repo</span><span class="si">}</span><span class="s2">` from `</span><span class="si">#{</span><span class="n">previous_spec_repo</span><span class="si">}</span><span class="s2">`)"</span> <span class="k">if</span> <span class="o">!</span><span class="n">has_changed_version</span> <span class="o">&amp;&amp;</span> <span class="n">has_changed_repo</span>
      <span class="k">else</span>
        <span class="c1"># é changed çŠ¶æ€ï¼Œå±•ç¤º Installing è¿™ä¸ªæ˜¯ç»å¸¸è§çš„</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"Installing </span><span class="si">#{</span><span class="n">spec</span><span class="si">}</span><span class="s2">"</span>
      <span class="k">end</span>
      <span class="no">UI</span><span class="p">.</span><span class="nf">titled_section</span><span class="p">(</span><span class="n">title</span><span class="p">.</span><span class="nf">green</span><span class="p">,</span> <span class="n">title_options</span><span class="p">)</span> <span class="k">do</span>
        <span class="c1"># é€šè¿‡ name æ‹¿åˆ°å¯¹åº”çš„ installerï¼Œè®°å½•åˆ° @pod_installers ä¸­</span>
        <span class="n">install_source_of_pod</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">else</span>
      <span class="c1"># å¦‚æœæ²¡æœ‰ changed æƒ…å†µï¼Œç›´æ¥å±•ç¤º Using ï¼Œä¹Ÿæ˜¯ç»å¸¸è§åˆ°çš„ log</span>
      <span class="no">UI</span><span class="p">.</span><span class="nf">titled_section</span><span class="p">(</span><span class="s2">"Using </span><span class="si">#{</span><span class="n">spec</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">title_options</span><span class="p">)</span> <span class="k">do</span>
        <span class="c1"># é€šè¿‡æ–‡ä»¶è·å–åˆ° installer å®ä¾‹ï¼Œè®°å½•åˆ° @pod_installers ä¸­</span>
        <span class="n">create_pod_installer</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="c1"># é€šè¿‡ç¼“å­˜è¿”å› PodSourceInstaller å®ä¾‹</span>
<span class="k">def</span> <span class="nf">create_pod_installer</span><span class="p">(</span><span class="n">pod_name</span><span class="p">)</span>
  <span class="n">specs_by_platform</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">pod_targets</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">pod_target</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">pod_target</span><span class="p">.</span><span class="nf">root_spec</span><span class="p">.</span><span class="nf">name</span> <span class="o">==</span> <span class="n">pod_name</span>
      <span class="n">specs_by_platform</span><span class="p">[</span><span class="n">pod_target</span><span class="p">.</span><span class="nf">platform</span><span class="p">]</span> <span class="o">||=</span> <span class="p">[]</span>
      <span class="n">specs_by_platform</span><span class="p">[</span><span class="n">pod_target</span><span class="p">.</span><span class="nf">platform</span><span class="p">].</span><span class="nf">concat</span><span class="p">(</span><span class="n">pod_target</span><span class="p">.</span><span class="nf">specs</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="k">raise</span> <span class="no">Informative</span><span class="p">,</span> <span class="s2">"Could not install '</span><span class="si">#{</span><span class="n">pod_name</span><span class="si">}</span><span class="s2">' pod. There is no target that supports it."</span> <span class="k">if</span> <span class="n">specs_by_platform</span><span class="p">.</span><span class="nf">empty?</span>
  <span class="vi">@pod_installers</span> <span class="o">||=</span> <span class="p">[]</span>
  <span class="c1"># é€šè¿‡ sandbox, specs çš„ platform ä¿¡æ¯ç”Ÿæˆ Installer å®ä¾‹</span>
  <span class="n">pod_installer</span> <span class="o">=</span> <span class="no">PodSourceInstaller</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">sandbox</span><span class="p">,</span> <span class="n">specs_by_platform</span><span class="p">,</span> <span class="ss">:can_cache</span> <span class="o">=&gt;</span> <span class="n">installation_options</span><span class="p">.</span><span class="nf">clean?</span><span class="p">)</span>
  <span class="vi">@pod_installers</span> <span class="o">&lt;&lt;</span> <span class="n">pod_installer</span>
  <span class="nb">puts</span> <span class="s2">"pod_installer -&gt;  </span><span class="si">#{</span><span class="n">pod_installer</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"specs_by_platform -&gt; </span><span class="si">#{</span><span class="n">specs_by_platform</span><span class="si">}</span><span class="s2">"</span>
  <span class="n">pod_installer</span>
<span class="k">end</span>
<span class="c1"># å®‰è£… Podsã€‚å¦‚æœ resolver å£°æ˜ä¸€ä¸ª Pod å·²ç»å®‰è£…æˆ–è€…å·²ç»å­˜åœ¨ï¼Œ</span>
<span class="c1"># å°†ä¼šå°†å…¶åˆ é™¤å¹¶é‡æ–°å®‰è£…ã€‚å¦‚æœä¸å­˜åœ¨åˆ™ç›´æ¥å®‰è£…ã€‚</span>
<span class="c1">#</span>
<span class="c1"># @return [void]</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">install_source_of_pod</span><span class="p">(</span><span class="n">pod_name</span><span class="p">)</span>
  <span class="n">pod_installer</span> <span class="o">=</span> <span class="n">create_pod_installer</span><span class="p">(</span><span class="n">pod_name</span><span class="p">)</span>
  <span class="n">pod_installer</span><span class="p">.</span><span class="nf">install!</span>
  <span class="vi">@installed_specs</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="n">pod_installer</span><span class="p">.</span><span class="nf">specs_by_platform</span><span class="p">.</span><span class="nf">values</span><span class="p">.</span><span class="nf">flatten</span><span class="p">.</span><span class="nf">uniq</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>
<p><code class="highlighter-rouge">install_pod_sources</code> æ€»ç»“ä¸‹æ¥ï¼Œå°±æ˜¯æ ¹æ®ä¾èµ–åˆ†æçš„ç»“æœï¼Œé€šè¿‡ name æ‹¿åˆ°æ‰€æœ‰ä¾èµ–çš„ <code class="highlighter-rouge">installer</code> å®ä¾‹ã€‚åœ¨æ–¹æ³•çš„å¼€å§‹ï¼Œ<code class="highlighter-rouge">root_specs</code> æ–¹æ³•æ˜¯é€šè¿‡ <code class="highlighter-rouge">analysis_result</code> æ‹¿å‡ºæ‰€æœ‰æ ¹ specã€‚</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">root_specs</span>
  <span class="c1"># ä¼šå–å‡ºæ‰€æœ‰çš„ root spec</span>
  <span class="n">analysis_result</span><span class="p">.</span><span class="nf">specifications</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:root</span><span class="p">).</span><span class="nf">uniq</span>
<span class="k">end</span></code></pre></figure>
<p>ä¸‹é¢å†æ¥çœ‹çœ‹ <code class="highlighter-rouge">install!</code> åˆ°åº•åšäº†ä»€ä¹ˆå·¥ä½œã€‚<strong>è°ƒç”¨ <code class="highlighter-rouge">install!</code> æ˜¯æ‰€æœ‰ç”Ÿæˆ <code class="highlighter-rouge">Installer</code> å®ä¾‹çš„ç›®çš„</strong>ã€‚åœ¨ <code class="highlighter-rouge">pod_source_installer.rb</code> ä¸­æœ‰ <code class="highlighter-rouge">install!</code> æ–¹æ³•çš„å®ç°ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">install!</span>
  <span class="c1"># å¦‚æœæœªç»å† pre-download é˜¶æ®µæˆ–æ˜¯ local çš„ Podï¼Œé€šè¿‡å¯¹åº”çš„ Source ä¸‹è½½</span>
  <span class="n">download_source</span> <span class="k">unless</span> <span class="n">predownloaded?</span> <span class="o">||</span> <span class="n">local?</span>
  <span class="c1"># æ‰§è¡Œ Spec ä¸­çš„ Preparer Command</span>
  <span class="no">PodSourcePreparer</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">root_spec</span><span class="p">,</span> <span class="n">root</span><span class="p">).</span><span class="nf">prepare!</span> <span class="k">if</span> <span class="n">local?</span>
<span class="k">end</span></code></pre></figure>
<p>å…¶å® <code class="highlighter-rouge">install!</code> ä¸­ä¸»è¦å°±æ˜¯å°† Pod é€šè¿‡å¯¹åº”çš„ Source ä¸‹è½½ä¸‹æ¥ï¼Œå…¶ä¸­ä¼šè°ƒç”¨ <code class="highlighter-rouge">cocoapods-downloader</code> ç»„ä»¶æ¥å¤„ç†æ‰€æœ‰çš„ä¸‹è½½é€»è¾‘ã€‚</p>
<h4 id="éªŒè¯-target-æµç¨‹---validate_targets">éªŒè¯ Target æµç¨‹ - <code class="highlighter-rouge">validate_targets</code></h4>
<p><code class="highlighter-rouge">validate_targets</code> è¿‡ç¨‹ç”¨æ¥éªŒè¯ä¹‹å‰æµç¨‹ä¸­çš„äº§ç‰© pod æ‰€ç”Ÿæˆçš„ Targets çš„åˆæ³•æ€§æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•åªæ˜¯ç®€å•çš„éªŒè¯äº†ä¸€ä¸‹ã€‚<code class="highlighter-rouge">validate_targets</code> æ–¹æ³•çš„ä¸»è¦ä½œç”¨å°±æ˜¯æ„é€  <code class="highlighter-rouge">TargetValidator</code>ï¼Œå¹¶æ‰§è¡Œ <code class="highlighter-rouge">validate!</code> æ–¹æ³•ï¼š</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">validate_targets</span>
  <span class="c1"># puts "validate_targets -&gt; #{aggregate_targets}"</span>
  <span class="c1"># puts "pod_targets -&gt; #{pod_targets}"</span>
  <span class="c1"># aggregate å·¥ç¨‹ä¸­çš„ Target</span>
  <span class="c1"># Pods æ‰€æœ‰ Target</span>
  <span class="n">validator</span> <span class="o">=</span> <span class="no">Xcode</span><span class="o">::</span><span class="no">TargetValidator</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">aggregate_targets</span><span class="p">,</span> <span class="n">pod_targets</span><span class="p">)</span>
  <span class="n">validator</span><span class="p">.</span><span class="nf">validate!</span>
<span class="k">end</span>
<span class="c1"># target_validator.rb </span>
<span class="k">def</span> <span class="nf">validate!</span>
  <span class="c1"># é‡åæ£€æµ‹</span>
  <span class="n">verify_no_duplicate_framework_and_library_names</span>
  <span class="c1"># framework åŒ…è£¹çš„é™æ€åº“æ£€æµ‹</span>
  <span class="n">verify_no_static_framework_transitive_dependencies</span>
  <span class="c1"># éªŒè¯ Pod ä¸­æ˜¯å¦æŒ‡æ˜å¤šä¸ª Swift ç‰ˆæœ¬</span>
  <span class="n">verify_no_pods_used_with_multiple_swift_versions</span>
  <span class="c1"># éªŒè¯ Swift çš„ Pod æ˜¯å¦æœ‰ module ä¾èµ–</span>
  <span class="n">verify_swift_pods_have_module_dependencies</span>
<span class="k">end</span></code></pre></figure>
<p>éªŒè¯ç¯èŠ‚åœ¨æ•´ä¸ª Install è¿‡ç¨‹ä¸­ä»…å å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚å› ä¸ºåªæ˜¯éªŒè¯éƒ¨åˆ†ï¼Œæ˜¯å®Œå…¨è§£è€¦çš„ã€‚ï¼ˆæˆ‘å°è¯•è¿‡å°†æ•´ä¸ª <code class="highlighter-rouge">validate_targets</code> æ³¨é‡Šæ‰ï¼Œ<em>install</em> è¿‡ç¨‹ï¼‰</p>
<ol>
  <li>
    <p><code class="highlighter-rouge">verify_no_duplicate_framework_and_library_names</code> ç”¨æ¥éªŒè¯æ˜¯å¦æœ‰é‡åçš„ <code class="highlighter-rouge">framework</code>ï¼Œå¦‚æœæœ‰å†²çªä¼šç›´æ¥æŠ›å‡º <em>frameworks with conflicting names</em> å¼‚å¸¸ã€‚</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">verify_no_static_framework_transitive_dependencies</code> ç”¨æ¥éªŒè¯åŠ¨æ€åº“ä¸­æ˜¯å¦æœ‰é™æ€åº“æˆ–è€… framework é™æ€åº“ï¼Œå¦‚æœæœ‰ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ç»™å®šä¸€ä¸ªåœºæ™¯ï¼Œå¦‚æœ A ç»„ä»¶ä¾èµ– B ç»„ä»¶ï¼ŒB ç»„ä»¶ä¸­é€šè¿‡ <code class="highlighter-rouge">vendored_libraries</code> åŠ è½½çš„é™æ€åº“(<code class="highlighter-rouge">.a</code> æˆ–è€… <code class="highlighter-rouge">.framework</code>)ï¼Œå¦‚æœæ­¤æ—¶ä½¿ç”¨äº† <code class="highlighter-rouge">use_framework!</code>ï¼Œæ‰“åŒ…çš„æ—¶å€™ï¼Œ<code class="highlighter-rouge">framework</code> ä¼šå°† <code class="highlighter-rouge">vendored_libraries</code> ä¸­çš„å†…å®¹åŒ…æ‹¬è¿›æ¥ï¼Œè¿™è¦å°±åœ¨ç¬¦å·å†³è®®çš„æ—¶å€™äº§ç”Ÿå†²çªã€‚ä½†å…¶å®åŠ¨æ€åº“ä¸­ä¾èµ–é™æ€åº“è¿™æ˜¯ä¸€ç§å¾ˆå¸¸è§çš„æƒ…å†µï¼Œæ‰€ä»¥åœ¨æœç´¢å¼•æ“ä¸­æ£€ç´¢å¼‚å¸¸ Log <code class="highlighter-rouge">transitive dependencies that include static binaries:</code> å¯ä»¥æŸ¥åˆ°å¾ˆå¤šå¯¹åº”è§£å†³æ–¹æ¡ˆï¼Œä½†ä¸»è¦æ–¹æ³•æ˜¯ï¼š</p>
    <ol>
      <li>ä¿®æ”¹ pod åº“ä¸­ <code class="highlighter-rouge">podspec</code>ï¼Œå¢åŠ  <code class="highlighter-rouge">pod_target_xcconfig</code>ï¼Œå®šä¹‰å¥½ <code class="highlighter-rouge">FRAMEWORK_SEARCH_PATHS</code> å’Œ <code class="highlighter-rouge">OTHER_LDFLAGS</code> ä¸¤ä¸ªç¯å¢ƒå˜é‡ï¼›</li>
      <li>hook <code class="highlighter-rouge">verify_no_static_framework_transitive_dependencies</code> çš„æ–¹æ³•ï¼Œå°†å…¶å¹²æ‰ï¼<a href="https://github.com/CocoaPods/CocoaPods/issues/3289">å¯¹åº” issue</a></li>
    </ol>
  </li>
</ol>
<blockquote>
  <p><code class="highlighter-rouge">vendored_libraries</code> ç”¨æ¥åœ¨ <code class="highlighter-rouge">spec</code> æ–‡ä»¶ä¸­æŒ‡å®šä¾èµ–çš„é™æ€åº“ï¼Œä¾‹å¦‚<em>å¾®åš SDK</em> ä¸­çš„ <code class="highlighter-rouge">s.vendored_libraries = 'libWeiboSDK/libWeiboSDK.a'</code>ã€‚</p>
</blockquote>
<ol>
  <li>
    <p><code class="highlighter-rouge">verify_swift_pods_have_module_dependencies</code> ç”¨æ¥æ£€æµ‹ Swift çš„ framework ä¸­æ˜¯å¦æœ‰ <em>Module Dependencies</em>ï¼Œå¦‚æœæœ‰çš„è¯éœ€è¦æ£€æŸ¥è¿™äº›ä¾èµ–æ˜¯å¦éœ€è¦è¿›è¡Œ <code class="highlighter-rouge">build</code>ï¼Œåˆ¤æ–­çš„æ¡ä»¶æ˜¯ï¼š1. æ˜¯å¦æœ‰ä»£ç æ–‡ä»¶ï¼›2. æ˜¯å¦å®šä¹‰äº† <code class="highlighter-rouge">module</code>ã€‚ç›®å‰è¿˜æ²¡æœ‰æ˜ç¡®çš„åœºæ™¯ï¼Œç¬”è€…å¯¹ <em>Module Dependencies</em> çš„å®šä¹‰ä¹Ÿæ¯”è¾ƒæ¨¡ç³Šï¼Œåç»­è·Ÿè¿›ï¼›</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">verify_no_pods_used_with_multiple_swift_versions</code> ç”¨æ¥æ£€æµ‹æ˜¯å¦æ‰€æœ‰çš„ <em>Pod Target</em> ä¸­ç‰ˆæœ¬ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
  </li>
</ol>
<h4 id="å·¥ç¨‹æ–‡ä»¶ç”Ÿæˆ---generate_pods_project">å·¥ç¨‹æ–‡ä»¶ç”Ÿæˆ - <code class="highlighter-rouge">generate_pods_project</code></h4>
<p>å·¥ç¨‹æ–‡ä»¶çš„ç”Ÿæˆæ˜¯ <code class="highlighter-rouge">pod install</code> çš„æœ€åä¸€æ­¥ï¼Œä»–ä¼šå°†ä¹‹å‰ç‰ˆæœ¬ä»²è£åçš„æ‰€æœ‰ç»„ä»¶é€šè¿‡ Project æ–‡ä»¶çš„å½¢å¼ç»„ç»‡èµ·æ¥ï¼Œå¹¶ä¸”ä¼šå¯¹ Project ä¸­åšä¸€äº›ç”¨æˆ·æŒ‡å®šçš„é…ç½®ã€‚</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">generate_pods_project</span><span class="p">(</span><span class="n">generator</span> <span class="o">=</span> <span class="n">create_generator</span><span class="p">)</span>
  <span class="no">UI</span><span class="p">.</span><span class="nf">section</span> <span class="s1">'Generating Pods project'</span> <span class="k">do</span>
    <span class="c1"># æ‰§è¡Œ generator çš„ generate æ–¹æ³•</span>
    <span class="c1"># é‡Œé¢åŒ…å«äº”æ­¥éª¤ï¼š</span>
    <span class="c1">#     1. prepare - å‡†å¤‡ Pod Project çš„åŸºç¡€é…ç½®ï¼Œä¹Ÿä¼šç»„è£… sandbox ä¸­æ‰€æœ‰ Pod çš„ pathï¼Œç»„è£… build setting çš„åŸºç¡€é…ç½®</span>
    <span class="c1">#     2. install_file_references - ç»„è£…æ–‡ä»¶åº”ç”¨ï¼Œå…¶ä¸­åŒ…æ‹¬æºæ–‡ä»¶å¼•ç”¨ã€framework çš„ bundleã€é™æ€åº“æ–‡ä»¶ã€èµ„æºæ–‡ä»¶ã€é“¾æ¥å¤´æ–‡ä»¶</span>
    <span class="c1">#     3. install_libraries - å¯¹äºæ‰€æœ‰çš„ Targets å’Œ Pod Targets ç»„è£…å¤´æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span>
    <span class="c1">#     4. integrate_targets - æ•´åˆ Targetsï¼Œå¯¹ Targets åšä¸€äº›é…ç½®</span>
    <span class="c1">#     5. set_target_dependencies - å¯¹äºæ¯ä¸ª Target å¢åŠ  Pod ä¾èµ–å…³ç³»ï¼Œå¹¶å®Œæˆé“¾æ¥</span>
    <span class="n">generator</span><span class="p">.</span><span class="nf">generate!</span>
    <span class="c1"># å–å‡º project å®ä¾‹</span>
    <span class="vi">@pods_project</span> <span class="o">=</span> <span class="n">generator</span><span class="p">.</span><span class="nf">project</span>
    <span class="c1"># æ‰§è¡Œ Podfile ä¸­çš„ post_install çš„ hook æ–¹æ³•</span>
    <span class="n">run_podfile_post_install_hooks</span>
    <span class="c1"># ä¿å­˜ç”Ÿæˆçš„ Project æ–‡ä»¶</span>
    <span class="c1"># åœ¨ä¿å­˜ä¹‹å‰ä¹Ÿä¼šåšä¸€äº›ä¼˜åŒ–è¿‡ç¨‹ï¼Œä¾‹å¦‚ä¼šæ£€æµ‹ä¸€ä¸‹ Pods æ˜¯å¦ä¸ºç©ºï¼ŒDev Pods æ˜¯å¦ä¸ºç©ºï¼Œä¹Ÿä¼šæ ¡éªŒ Pods å·¥ç¨‹æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶çš„ Deterministic UUID ç­‰</span>
    <span class="n">generator</span><span class="p">.</span><span class="nf">write</span>
    <span class="c1"># å°† Development çš„ scheme å˜æˆ share çŠ¶æ€</span>
    <span class="n">generator</span><span class="p">.</span><span class="nf">share_development_pod_schemes</span>
    <span class="c1"># å†™ lock æ–‡ä»¶</span>
    <span class="n">write_lockfiles</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>
<p>åœ¨ <code class="highlighter-rouge">install</code> è¿‡ç¨‹ä¸­ï¼Œé™¤å»ä¾èµ–ä»²è£éƒ¨åˆ†å’Œä¸‹è½½éƒ¨åˆ†çš„æ—¶é—´æ¶ˆè€—ï¼Œåœ¨å·¥ç¨‹æ–‡ä»¶ç”Ÿæˆä¹Ÿä¼šæœ‰ç›¸å¯¹è¾ƒå¤§çš„æ—¶é—´å¼€é”€ã€‚è¿™é‡Œå¾€å¾€ä¹Ÿæ˜¯é€Ÿåº¦ä¼˜åŒ–æ ¸å¿ƒä½ç½®ã€‚åœ¨æœ€æ–°çš„ <code class="highlighter-rouge">1.6.1</code> ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªç¯èŠ‚è¢«å¤§é‡çš„é‡æ„ä¼˜åŒ–ï¼Œåç»­æˆ‘ä»¬çœ‹ä»¥å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<h2 id="æ–‡ä»¶é‡Šä¹‰">æ–‡ä»¶é‡Šä¹‰</h2>
<ol>
  <li>
    <p><code class="highlighter-rouge">Podfile</code> - ç”±ç”¨æˆ·å®ç°çš„å…³äº <em>Target</em> ä¸ Pod å…³ç³»çš„å£°æ˜è§„èŒƒã€‚<strong>æ³¨æ„ï¼Œè¿™é‡Œæœ‰ <em>Target</em> å’Œ Pod çš„å…³ç³»ï¼Œè¿™äº›æ˜¯ <code class="highlighter-rouge">Podfile.lock</code> ä¸­æ— æ³•æ‹¿åˆ°çš„ã€‚</strong></p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Podfile.lock</code> - åŒ…æ‹¬å®‰è£… Pod çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¯¹åº” Pod çš„ç‰ˆæœ¬å·ã€Git åœ°å€ã€Branch ä¿¡æ¯ã€Commit ä¿¡æ¯ã€Tag ä¿¡æ¯ï¼ˆGitã€Branchã€Commitã€Tag å‡ä¸º Git Label ä¾èµ–ï¼‰ã€Local Path ä¿¡æ¯ï¼ˆDevelopment Pod æ¨¡å¼ï¼‰ã€‚ä¹ŸåŒ…å«äº†æ‰€æœ‰ Pod çš„<strong>æœ€ç»ˆå†³è®®ç‰ˆæœ¬</strong>ã€<strong>äºŒçº§å­ä¾èµ–åˆ—è¡¨</strong>ã€<strong>ä½¿ç”¨çš„ Source</strong>ã€<strong>spec æ–‡ä»¶çš„ Checksum</strong>ã€‚</p>
  </li>
</ol>
<blockquote>
  <ul>
    <li>è¿™é‡Œçš„ <em>Checksum</em> å¯ä»¥ç†è§£æˆæ˜¯ä¸€ä¸ªæ–‡ä»¶çš„ MD5 ç¼–ç ï¼Œä¸åŒæ–‡ä»¶çš„ Checksum ä¸åŒã€‚åœ¨ <em>CocoaPods 1.5.3</em> å’Œ <em>Cocoapods 1.6.1</em> ä¸­ï¼Œ<strong>Sepc æ–‡ä»¶çš„ Checksum</strong>å‘ç”Ÿäº†å˜åŒ–ï¼Œç”±ä¹‹å‰çš„åŸæ–‡ä»¶å˜æˆäº† spec åºåˆ—åŒ–ä¹‹åçš„ json æ–‡ä»¶çš„ MD5ï¼Œè¿™ä¸ªåç»­ç³»åˆ—æ–‡ä¸­ä¼šè®²åˆ°ã€‚</li>
    <li>Source çš„æ„æ€æ˜¯å¯¹åº” spec ä»“åº“çš„ Git åœ°å€ã€‚ä¸€èˆ¬å¤§å‚ä¸­å¾€å¾€ä¼šè‡ªå·±ç»´æŠ¤ä¸€ä¸ªæˆ–å¤šä¸ª spec ä»“åº“ï¼Œä»è€Œæœ‰åˆ©äºç»„ä»¶ç‰ˆæœ¬çš„æ§åˆ¶ã€‚</li>
  </ul>
</blockquote>
<ol>
  <li><code class="highlighter-rouge">Manifest.lock</code> - <code class="highlighter-rouge">Pods</code> ç›®å½•ä¸­åŒ…å«çš„æ–‡ä»¶ï¼Œç”¨äºè·Ÿè¸ªæœ¬åœ°å®‰è£…çš„ Podã€‚å¦‚æœåœ¨ <code class="highlighter-rouge">install</code> è¿‡ç¨‹ä¸­æ£€æŸ¥åˆ°ä¸ä¹‹å‰çš„ç¼“å­˜ç›¸åŒå°±ä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜ç‰ˆæœ¬ï¼Œè€Œå…¶æ ¹æ®å°±æ˜¯ <code class="highlighter-rouge">Manifest.lock</code> æ–‡ä»¶ã€‚åœ¨æ¯æ¬¡ <code class="highlighter-rouge">install</code> å®Œæ¯•åï¼Œ<code class="highlighter-rouge">Manifest.lock</code> ä¼šè¢«é‡å†™æˆæœ€æ–°çš„ <code class="highlighter-rouge">Podfile.lock</code> æ–‡ä»¶ã€‚</li>
</ol>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>å½“æˆ‘ä»¬çŸ¥é“ CocoaPods åœ¨ <code class="highlighter-rouge">install</code> çš„å¤§è‡´è¿‡ç¨‹åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶åšä¸€äº›ä¿®æ”¹å’Œæ§åˆ¶ã€‚ä¾‹å¦‚çŸ¥é“äº† <code class="highlighter-rouge">pre_install</code> å’Œ <code class="highlighter-rouge">post_install</code> çš„å…·ä½“æ—¶æœºï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ <code class="highlighter-rouge">Podfile</code> ä¸­æ‰§è¡Œå¯¹åº”çš„ Ruby è„šæœ¬ï¼Œè¾¾åˆ°æˆ‘ä»¬çš„é¢„æœŸã€‚</p>
<p>åç»­ï¼Œå­¦ä¹  CocoaPods ä¸­æ¯ä¸€ä¸ªç»„ä»¶çš„å®ç°ï¼Œå°†æ‰€æœ‰çš„é—®é¢˜åœ¨ä»£ç ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚</p>
  <footer class="post-footer">
    <section class="author">
      <h4>Desgard_Duan</h4>
      <p>I write many code to write less code.ğŸ’»</p>
    </section>
<aside class="share">
  <h4>Share this.</h4>
  <a href="http://twitter.com/share?text=ã€ŠCocoaPods å†é™© - æ€»è§ˆã€‹ -- Guardia Â· ç“œåœ°&amp;url=https://www.desgard.com/cocoapods-1/"
  onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
    <i class="fa fa-twitter-square"></i>
  </a>
  <a href="http://v.t.sina.com.cn/share/share.php?url=https://www.desgard.com/cocoapods-1/&amp;title=ã€ŠCocoaPods å†é™© - æ€»è§ˆã€‹ â€”â€” Guardia Â· ç“œåœ°" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
    <i class="fa fa-weibo"></i>
  </a>
</aside>
      <aside id="comments" class="disqus">
  <div id="container"></div>
  <link rel="stylesheet" href="/assets/css/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <div id='gitalk-container'></div>
  <script>
    const gitalk = new Gitalk({
      id: "https://www.desgard.com/cocoapods-1/",
      clientID: 'e2612df42f3f2a83e71c',
      clientSecret: 'b53e85b314bb24a6d06773e48bbb62a4de3b8b3a',
      repo: 'desgard.github.com',
      owner: 'Desgard',
      admin: ['Desgard'],
      // facebook-like distraction free mode
      distractionFreeMode: false
    })
    gitalk.render('gitalk-container')
  </script>
</aside>
  </footer>
</article>
    </main>
<footer class="footer">
  <div class="container">
    <ul class="icons">
      <li>
        <a href="https://github.com/desgard" class="icon-github" target="_blank">
          <i class="fa fa-github"></i>
        </a>
      </li>
      <li>
        <a href="https://www.facebook.com/desgard.duan" class="icon-facebook" target="_blank">
          <i class="fa fa-facebook"></i>
        </a>
      </li>
      <li>
        <a href="https://twitter.com/Desgard_Duan" class="icon-twitter" target="_blank">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
      <li>
        <a href="https://stackoverflow.com/users/6119149/desgard-duan" class="icon-github" target="_blank">
          <i class="fa fa-stack-overflow"></i>
        </a>
      </li>
      <li>
        <a href="https://weibo.com/desgard" class="icon-instagram" target="_blank">
          <i class="fa fa-weibo"></i>
        </a>
      </li>
    </ul>
    <p>
      <q>I write many code to write less code.ğŸ’»</q>
      <small>â€“ Gua</small>
    </p>
    <small class="clearfix">
      Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> â€¢ <a href="https://github.com/desgard" target="_blank">Open source <i class="fa fa-heart"></i></a>
    </small>
  </div>
</footer>
<a class="scroll-up fa fa-chevron-up bounce" href="#" data-position="0"></a>
    <div id="modalSearch" class="modal">
  <div class="modal__overlay"></div>
  <div class="modal__content">
    <a href="#" class="modal-close" onclick="show_search_view(false)">&times;</a>
    <div class="search-container">
      <input type="text" id="search-input" placeholder="Search articles">
      <ul id="results-container"></ul>
    </div>
  </div>
</div>
<!-- Configuration -->
<script>
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/search.json'
  })
  function show_search_view(is_show) {
    var search_view = document.getElementById("modalSearch");
    search_view.className = is_show ? "modal modal--open" : "modal";
  }
</script>
  </body>
  <script>
    var link = "" ;
    var os = function() {  
      var ua = navigator.userAgent,  
      isWindowsPhone = /(?:Windows Phone)/.test(ua),  
      isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,   
      isAndroid = /(?:Android)/.test(ua),   
      isFireFox = /(?:Firefox)/.test(ua),   
      isChrome = /(?:Chrome|CriOS)/.test(ua),  
      isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)),  
      isPhone = /(?:iPhone)/.test(ua) && !isTablet,  
      isPc = !isPhone && !isAndroid && !isSymbian;  
      return {  
        isTablet: isTablet,  
        isPhone: isPhone,  
        isAndroid : isAndroid,  
        isPc : isPc  
      };  
    }();  
    if (link.length > 0) {
      if (os.isAndroid || os.isPhone) {
        location.replace(link);
      }
    }
  </script>
</html>